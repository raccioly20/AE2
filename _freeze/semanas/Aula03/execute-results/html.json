{
  "hash": "75f7520bd18dab18f2bfd61d71574cc1",
  "result": {
    "markdown": "---\ntitle: \"Inferência\"\nauthor: \"Ricardo Accioly\"\ndate: \"2022-09-22\"\nformat:\n  html:\n    toc: true\n    html-math-method: katex\n---\n\n\n## Carregando bibliotecas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(kableExtra)\n\n\n# parametros para o ggplot2\nggplot2::theme_set(ggplot2::theme_minimal(base_size = 16))\n\n# parametros para imagens\nknitr::opts_chunk$set(\n  fig.width = 8,\n  fig.asp = 0.618,\n  fig.retina = 3,\n  dpi = 300,\n  out.width = \"80%\"\n)\n```\n:::\n\n\n## População\n\nVamos supor que nossa população (universo) seja composto de 1000 valores aleatórios gerados a partir de uma normal padrão.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\npopulacao <- rnorm(1000,0,1)\nsummary(populacao)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-2.80978 -0.62832  0.00921  0.01613  0.66460  3.24104 \n```\n:::\n:::\n\n\n## Amostras\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(125)\namostra1 <- sample(populacao, size=30)\nset.seed(126)\namostra2 <- sample(populacao, size=30)\nset.seed(127)\namostra3 <- sample(populacao, size=30)\nset.seed(128)\namostra4 <- sample(populacao, size=30)\namostras <- cbind(amostra1, amostra2, amostra3, amostra4)\n# amostras\nmedias <- colMeans(amostras)\ndesvios <- apply(amostras, 2,sd)\nic.i <- medias - 1.96*desvios\nic.s <- medias + 1.96*desvios\nnames(desvios) <- c(\"dp1\", \"dp2\", \"dp3\", \"dp4\")\nknitr::kable(cbind(medias,desvios, ic.i, ic.s), digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> medias </th>\n   <th style=\"text-align:right;\"> desvios </th>\n   <th style=\"text-align:right;\"> ic.i </th>\n   <th style=\"text-align:right;\"> ic.s </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> amostra1 </td>\n   <td style=\"text-align:right;\"> 0.087 </td>\n   <td style=\"text-align:right;\"> 1.066 </td>\n   <td style=\"text-align:right;\"> -2.002 </td>\n   <td style=\"text-align:right;\"> 2.176 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> amostra2 </td>\n   <td style=\"text-align:right;\"> -0.029 </td>\n   <td style=\"text-align:right;\"> 1.158 </td>\n   <td style=\"text-align:right;\"> -2.298 </td>\n   <td style=\"text-align:right;\"> 2.240 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> amostra3 </td>\n   <td style=\"text-align:right;\"> -0.160 </td>\n   <td style=\"text-align:right;\"> 0.883 </td>\n   <td style=\"text-align:right;\"> -1.890 </td>\n   <td style=\"text-align:right;\"> 1.571 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> amostra4 </td>\n   <td style=\"text-align:right;\"> 0.135 </td>\n   <td style=\"text-align:right;\"> 0.708 </td>\n   <td style=\"text-align:right;\"> -1.253 </td>\n   <td style=\"text-align:right;\"> 1.523 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Amostras\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(125)\namostra1 <- sample(populacao, size=100)\nset.seed(126)\namostra2 <- sample(populacao, size=100)\nset.seed(127)\namostra3 <- sample(populacao, size=100)\nset.seed(128)\namostra4 <- sample(populacao, size=100)\namostras <- cbind(amostra1, amostra2, amostra3, amostra4)\nmedias <- colMeans(amostras)\ndesvios <- apply(amostras, 2,sd)\nic.i <- medias - 1.96*desvios\nic.s <- medias + 1.96*desvios\nnames(desvios) <- c(\"dp1\", \"dp2\", \"dp3\", \"dp4\")\nknitr::kable(cbind(medias,desvios, ic.i, ic.s), digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> medias </th>\n   <th style=\"text-align:right;\"> desvios </th>\n   <th style=\"text-align:right;\"> ic.i </th>\n   <th style=\"text-align:right;\"> ic.s </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> amostra1 </td>\n   <td style=\"text-align:right;\"> 0.033 </td>\n   <td style=\"text-align:right;\"> 1.004 </td>\n   <td style=\"text-align:right;\"> -1.935 </td>\n   <td style=\"text-align:right;\"> 2.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> amostra2 </td>\n   <td style=\"text-align:right;\"> 0.091 </td>\n   <td style=\"text-align:right;\"> 0.995 </td>\n   <td style=\"text-align:right;\"> -1.859 </td>\n   <td style=\"text-align:right;\"> 2.041 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> amostra3 </td>\n   <td style=\"text-align:right;\"> 0.084 </td>\n   <td style=\"text-align:right;\"> 0.922 </td>\n   <td style=\"text-align:right;\"> -1.724 </td>\n   <td style=\"text-align:right;\"> 1.891 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> amostra4 </td>\n   <td style=\"text-align:right;\"> -0.069 </td>\n   <td style=\"text-align:right;\"> 0.917 </td>\n   <td style=\"text-align:right;\"> -1.866 </td>\n   <td style=\"text-align:right;\"> 1.728 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## Preparando simulação\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndef.par <- par(no.readonly = TRUE) # salvando configuração\n\nn=cbind(c(3, 10, 30), # tamanho de amostras para os gráficos 1ª distribuição\n        c(3, 10, 30), # tamanho de amostras para os gráficos 2ª distribuição\n        c(3, 10, 30), # tamanho de amostras para os gráficos 3ª distribuição\n        c(3, 10, 30)) # tamanho de amostras para os gráficos 4ª distribuição\nX<-list(\n  x1 = matrix(NA,nrow=200,ncol=3), # Matriz que armazenara as médias da primeira dist\n  x2 = matrix(NA,nrow=200,ncol=3), # Matriz que armazenara as médias da segunda dist\n  x3 = matrix(NA,nrow=200,ncol=3), # Matriz que armazenara as médias da terceira dist\n  x4 = matrix(NA,nrow=200,ncol=3)) # Matriz que armazenara as médias da quarta dist\n\nset.seed(123)\n\nfor ( i in 1:3){  # iterando ao longo do tamanho de amostras de cada linha\n  for ( j in 1: 200){  # Construindo 200 observacoes para cada gráfico  \n    X$x1[j,i] <-  mean( runif( n=n[i,1])) \n    # Calculando a média para cada uma das 200 simulacoes de uma distribuicao uniforme\n    X$x2[j,i] <-  mean(  rexp( n=n[i,2], rate=2)) \n    # Calculando a média para cada uma das 200 simulacoes de uma distribuicao                exponencial\n    X$x3[j,i] <-  mean(rchisq( n=n[i,3], df=1)) \n    # Calculando a média para cada uma das 200 simulacoes de uma distribuicao                 qui-quadrado\n    X$x4[j,i] <-  mean( rbeta( n=n[i,4], shape1 = .2, shape2 = .2)) \n    # Calculando a média para cada uma das 200 simulacoes de uma distribuicao beta\n  }\n}\n```\n:::\n\n\n## Resultado das Simulações\n\nApresentação das 200 simulações das distribuições uniforme, exponencial, Chiquadrado e beta para os tamanhos de amostras n= 3, 10 e 30\n\n## Distribuição Uniforme\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlayout(rbind(c(1,2,3,4)))\nplot(dunif(x = seq(0,1,0.05)),type=\"l\", ylab=\"f(x)\", main=\"fdp-Uniforme(0,1)\", xlab=\"X\")\nhist(X$x1[,1], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[1,1]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x1[,2], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[2,1]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x1[,3], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[3,1]), freq = FALSE, xlab=\"X_bar\")\n```\n\n::: {.cell-output-display}\n![](Aula03_files/figure-html/unnamed-chunk-6-1.png){width=80%}\n:::\n:::\n\n\n## Distribuição exponencial\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlayout(rbind(c(1,2,3,4)))\nplot(dexp(x = seq(0,1,0.05),rate=2),type=\"l\", ylab=\"f(x)\", main=\"fdp-Exponencial(1/2)\", xlab=\"X\")\nhist(X$x2[,1], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[1,2]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x2[,2], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[2,2]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x2[,3], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[3,2]), freq = FALSE, xlab=\"X_bar\")\n```\n\n::: {.cell-output-display}\n![](Aula03_files/figure-html/unnamed-chunk-7-1.png){width=80%}\n:::\n:::\n\n\n## Distribuição Chi-Quadrado\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlayout(rbind(c(1,2,3,4)))\nplot(dchisq(x = seq(0,1,0.05),df=1),type=\"l\", ylab=\"f(x)\", main=\"fdp-QuiQuad(1)\", xlab=\"X\")\nhist(X$x3[,1], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[1,3]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x3[,2], col = \"lightblue3\", border = \"dark gray\",\n     main = paste(\"n = \", n[2,3]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x3[,3], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[3,3]), freq = FALSE, xlab=\"X_bar\")\n```\n\n::: {.cell-output-display}\n![](Aula03_files/figure-html/unnamed-chunk-8-1.png){width=80%}\n:::\n:::\n\n\n## Distribuição Beta\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlayout(rbind(c(1,2,3,4)))\nplot(dbeta(x = seq(0,1,0.05), shape1 = .2, shape2 = .2),type=\"l\", ylab=\"f(x)\", main=\"fdp-Beta(0.2, 0.2)\", xlab=\"X\")\nhist(X$x4[,1], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[1,4]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x4[,2], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[2,4]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x4[,3], col = \"lightblue3\", border = \"dark gray\",\n     main = paste(\"n = \", n[3,4]), freq = FALSE, xlab=\"X_bar\")\n```\n\n::: {.cell-output-display}\n![](Aula03_files/figure-html/unnamed-chunk-9-1.png){width=80%}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(def.par)  # restaurando\n```\n:::\n\n\n## Reamostragem\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Intervalos de Confiança Bootstrap\nlibrary(boot)\nset.seed(123)\ndados1 <- rnorm(n=100, mean = 5, sd = 1)\nsummary(dados1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  2.691   4.506   5.062   5.090   5.692   7.187 \n```\n:::\n\n```{.r .cell-code}\nbootMediana <- function(dados, indices) median(dados[indices])\nb <- boot(dados1, bootMediana, R = 1000)\nb\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nORDINARY NONPARAMETRIC BOOTSTRAP\n\n\nCall:\nboot(data = dados1, statistic = bootMediana, R = 1000)\n\n\nBootstrap Statistics :\n    original      bias    std. error\nt1* 5.061756 -0.01277126   0.1315266\n```\n:::\n\n```{.r .cell-code}\nplot(b)\n```\n\n::: {.cell-output-display}\n![](Aula03_files/figure-html/unnamed-chunk-11-1.png){width=80%}\n:::\n\n```{.r .cell-code}\nboot.ci(b, conf=0.95, type = c(\"norm\", \"basic\", \"perc\", \"bca\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nBOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS\nBased on 1000 bootstrap replicates\n\nCALL : \nboot.ci(boot.out = b, conf = 0.95, type = c(\"norm\", \"basic\", \n    \"perc\", \"bca\"))\n\nIntervals : \nLevel      Normal              Basic         \n95%   ( 4.817,  5.332 )   ( 4.806,  5.344 )  \n\nLevel     Percentile            BCa          \n95%   ( 4.780,  5.318 )   ( 4.777,  5.278 )  \nCalculations and Intervals on Original Scale\n```\n:::\n:::\n",
    "supporting": [
      "Aula03_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}