{
  "hash": "05473c55475e63188edb8c06ac02c975",
  "result": {
    "markdown": "---\ntitle: \"Regressão Linear\"\nauthor: \"Ricardo Accioly\"\ndate: \"2022-10-04\"\noutput:\n  html_document:\n    toc: yes\n    code_download: yes\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(kableExtra)\n\n# parametros para imagens\nknitr::opts_chunk$set(\n  fig.width = 8,\n  fig.asp = 0.73,\n  fig.retina = 3,\n  dpi = 300,\n  out.width = \"90%\"\n)\n```\n:::\n\n\n## Explorando os dados\n\n## Anscombe\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanscombe <- read.table(\"anscombe.txt\",header=TRUE)\nattach(anscombe)\npar(mfrow=c(2,2))\nplot(x1,y1,xlim=c(4,20),ylim=c(3,14),main=\"Dados  1\")\nabline(lsfit(x1,y1))\nplot(x2,y2,xlim=c(4,20),ylim=c(3,14),main=\"Dados 2\")\nabline(lsfit(x2,y2))\nplot(x3,y3,xlim=c(4,20),ylim=c(3,14),main=\"Dados 3\")\nabline(lsfit(x3,y3))\nplot(x4,y4,xlim=c(4,20),ylim=c(3,14),main=\"Dados 4\")\nabline(lsfit(x4,y4))\n```\n\n::: {.cell-output-display}\n![](Aula04_files/figure-html/unnamed-chunk-2-1.png){width=90%}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(y1~x1)\nm2 <- lm(y2~x2)\nm3 <- lm(y3~x3)\nm4 <- lm(y4~x4)\nmodelos <- rbind(coef(m1),coef(m2),coef(m3),coef(m4))\ncolnames(modelos) <- c(\"Intercept\", \"x\") \nmodelos\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Intercept         x\n[1,]  3.000091 0.5000909\n[2,]  3.000909 0.5000000\n[3,]  3.002455 0.4997273\n[4,]  3.001727 0.4999091\n```\n:::\n:::\n\n\n## Dados de propaganda\n\nO conjunto de dados contém estatísticas sobre as vendas de um produto em 200 diferentes mercados, juntamente com orçamentos publicitários em cada um desses mercados, para diferentes canais de mídia: TV, rádio e jornal. As vendas estão em milhares de unidades e o orçamento está em milhares de dólares. Os dados são oriundo do livro Introduction to Statistical Learning.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\npropaganda <- read_excel(\"Propaganda.xlsx\")\nsummary(propaganda)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       TV             Radio          Newspaper          Sales      \n Min.   :  0.70   Min.   : 0.000   Min.   :  0.30   Min.   : 1.60  \n 1st Qu.: 74.38   1st Qu.: 9.975   1st Qu.: 12.75   1st Qu.:10.38  \n Median :149.75   Median :22.900   Median : 25.75   Median :12.90  \n Mean   :147.04   Mean   :23.264   Mean   : 30.55   Mean   :14.02  \n 3rd Qu.:218.82   3rd Qu.:36.525   3rd Qu.: 45.10   3rd Qu.:17.40  \n Max.   :296.40   Max.   :49.600   Max.   :114.00   Max.   :27.00  \n```\n:::\n:::\n\n\n## Renomeando\n\n\n::: {.cell}\n\n```{.r .cell-code}\npropaganda <- propaganda %>% rename(Jornal = Newspaper, Vendas = Sales)\n```\n:::\n\n\n## Sumario\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(propaganda)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       TV             Radio            Jornal           Vendas     \n Min.   :  0.70   Min.   : 0.000   Min.   :  0.30   Min.   : 1.60  \n 1st Qu.: 74.38   1st Qu.: 9.975   1st Qu.: 12.75   1st Qu.:10.38  \n Median :149.75   Median :22.900   Median : 25.75   Median :12.90  \n Mean   :147.04   Mean   :23.264   Mean   : 30.55   Mean   :14.02  \n 3rd Qu.:218.82   3rd Qu.:36.525   3rd Qu.: 45.10   3rd Qu.:17.40  \n Max.   :296.40   Max.   :49.600   Max.   :114.00   Max.   :27.00  \n```\n:::\n\n```{.r .cell-code}\nnrow(propaganda)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 200\n```\n:::\n:::\n\n\n## Linhas inicias\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gt)\ngt(head(propaganda, 10))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ljpruzabfe\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#ljpruzabfe .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ljpruzabfe .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ljpruzabfe .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ljpruzabfe .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ljpruzabfe .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ljpruzabfe .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ljpruzabfe .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ljpruzabfe .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ljpruzabfe .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ljpruzabfe .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ljpruzabfe .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ljpruzabfe .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ljpruzabfe .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ljpruzabfe .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ljpruzabfe .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ljpruzabfe .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ljpruzabfe .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ljpruzabfe .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ljpruzabfe .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ljpruzabfe .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ljpruzabfe .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ljpruzabfe .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ljpruzabfe .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ljpruzabfe .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ljpruzabfe .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ljpruzabfe .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ljpruzabfe .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ljpruzabfe .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ljpruzabfe .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ljpruzabfe .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ljpruzabfe .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ljpruzabfe .gt_left {\n  text-align: left;\n}\n\n#ljpruzabfe .gt_center {\n  text-align: center;\n}\n\n#ljpruzabfe .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ljpruzabfe .gt_font_normal {\n  font-weight: normal;\n}\n\n#ljpruzabfe .gt_font_bold {\n  font-weight: bold;\n}\n\n#ljpruzabfe .gt_font_italic {\n  font-style: italic;\n}\n\n#ljpruzabfe .gt_super {\n  font-size: 65%;\n}\n\n#ljpruzabfe .gt_two_val_uncert {\n  display: inline-block;\n  line-height: 1em;\n  text-align: right;\n  font-size: 60%;\n  vertical-align: -0.25em;\n  margin-left: 0.1em;\n}\n\n#ljpruzabfe .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#ljpruzabfe .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ljpruzabfe .gt_slash_mark {\n  font-size: 0.7em;\n  line-height: 0.7em;\n  vertical-align: 0.15em;\n}\n\n#ljpruzabfe .gt_fraction_numerator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: 0.45em;\n}\n\n#ljpruzabfe .gt_fraction_denominator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: -0.05em;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">TV</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Radio</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Jornal</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Vendas</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_right\">230.1</td>\n<td class=\"gt_row gt_right\">37.8</td>\n<td class=\"gt_row gt_right\">69.2</td>\n<td class=\"gt_row gt_right\">22.1</td></tr>\n    <tr><td class=\"gt_row gt_right\">44.5</td>\n<td class=\"gt_row gt_right\">39.3</td>\n<td class=\"gt_row gt_right\">45.1</td>\n<td class=\"gt_row gt_right\">10.4</td></tr>\n    <tr><td class=\"gt_row gt_right\">17.2</td>\n<td class=\"gt_row gt_right\">45.9</td>\n<td class=\"gt_row gt_right\">69.3</td>\n<td class=\"gt_row gt_right\">9.3</td></tr>\n    <tr><td class=\"gt_row gt_right\">151.5</td>\n<td class=\"gt_row gt_right\">41.3</td>\n<td class=\"gt_row gt_right\">58.5</td>\n<td class=\"gt_row gt_right\">18.5</td></tr>\n    <tr><td class=\"gt_row gt_right\">180.8</td>\n<td class=\"gt_row gt_right\">10.8</td>\n<td class=\"gt_row gt_right\">58.4</td>\n<td class=\"gt_row gt_right\">12.9</td></tr>\n    <tr><td class=\"gt_row gt_right\">8.7</td>\n<td class=\"gt_row gt_right\">48.9</td>\n<td class=\"gt_row gt_right\">75.0</td>\n<td class=\"gt_row gt_right\">7.2</td></tr>\n    <tr><td class=\"gt_row gt_right\">57.5</td>\n<td class=\"gt_row gt_right\">32.8</td>\n<td class=\"gt_row gt_right\">23.5</td>\n<td class=\"gt_row gt_right\">11.8</td></tr>\n    <tr><td class=\"gt_row gt_right\">120.2</td>\n<td class=\"gt_row gt_right\">19.6</td>\n<td class=\"gt_row gt_right\">11.6</td>\n<td class=\"gt_row gt_right\">13.2</td></tr>\n    <tr><td class=\"gt_row gt_right\">8.6</td>\n<td class=\"gt_row gt_right\">2.1</td>\n<td class=\"gt_row gt_right\">1.0</td>\n<td class=\"gt_row gt_right\">4.8</td></tr>\n    <tr><td class=\"gt_row gt_right\">199.8</td>\n<td class=\"gt_row gt_right\">2.6</td>\n<td class=\"gt_row gt_right\">21.2</td>\n<td class=\"gt_row gt_right\">10.6</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n## Estatísticas descritivas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(psych)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'psych'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:ggplot2':\n\n    %+%, alpha\n```\n:::\n\n```{.r .cell-code}\ndescribe(propaganda)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       vars   n   mean    sd median trimmed    mad min   max range  skew\nTV        1 200 147.04 85.85 149.75  147.20 108.82 0.7 296.4 295.7 -0.07\nRadio     2 200  23.26 14.85  22.90   23.00  19.79 0.0  49.6  49.6  0.09\nJornal    3 200  30.55 21.78  25.75   28.41  23.13 0.3 114.0 113.7  0.88\nVendas    4 200  14.02  5.22  12.90   13.78   4.82 1.6  27.0  25.4  0.40\n       kurtosis   se\nTV        -1.24 6.07\nRadio     -1.28 1.05\nJornal     0.57 1.54\nVendas    -0.45 0.37\n```\n:::\n:::\n\n\n## Histogramas\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nhist(propaganda$TV,breaks=\"Sturges\", main=\"TV - Regra de Sturges\")\nhist(propaganda$Radio,breaks=\"Sturges\", main=\"Radio - Regra de Sturges\")\nhist(propaganda$Jornal, breaks=\"Sturges\", main=\"Jornal - Regra de Sturges\")\nhist(propaganda$Vendas, breaks=\"Sturges\", main=\"Vendas - Regra de Sturges\")\n```\n\n::: {.cell-output-display}\n![](Aula04_files/figure-html/unnamed-chunk-5-1.png){width=90%}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n```\n:::\n\n\n## Grafico de Densidade\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(patchwork)\ng1 <- ggplot(propaganda, aes(TV)) + geom_density()\ng2 <- ggplot(propaganda, aes(Radio)) + geom_density()\ng3 <- ggplot(propaganda, aes(Jornal)) + geom_density()\ng4 <- ggplot(propaganda, aes(Vendas)) + geom_density()\n(g1 + g2)/(g3 + g4) \n```\n\n::: {.cell-output-display}\n![](Aula04_files/figure-html/unnamed-chunk-6-1.png){width=90%}\n:::\n:::\n\n\n## Box-Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(caret)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: lattice\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'caret'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    lift\n```\n:::\n\n```{.r .cell-code}\nfeaturePlot(x = propaganda[ , c(\"TV\", \"Radio\", \"Jornal\")], y=factor(rep(\"Midia\",200)), \"box\")\n```\n\n::: {.cell-output-display}\n![](Aula04_files/figure-html/unnamed-chunk-7-1.png){width=90%}\n:::\n:::\n\n\n## Grafico de Dispersão\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfeaturePlot(x = propaganda[ , c(\"TV\", \"Radio\", \"Jornal\")], y = propaganda$Vendas)\n```\n\n::: {.cell-output-display}\n![](Aula04_files/figure-html/unnamed-chunk-8-1.png){width=90%}\n:::\n:::\n\n\n## Matriz de dispersão\n\n\n::: {.cell}\n\n```{.r .cell-code}\npairs.panels(propaganda) \n```\n\n::: {.cell-output-display}\n![](Aula04_files/figure-html/unnamed-chunk-9-1.png){width=90%}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(GGally)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 method overwritten by 'GGally':\n  method from   \n  +.gg   ggplot2\n```\n:::\n\n```{.r .cell-code}\nggpairs(propaganda)\n```\n\n::: {.cell-output-display}\n![](Aula04_files/figure-html/unnamed-chunk-10-1.png){width=90%}\n:::\n:::\n\n\n## Correlações\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmcorr <- cor(propaganda)\nlibrary(corrplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\ncorrplot 0.92 loaded\n```\n:::\n\n```{.r .cell-code}\ncorrplot(mcorr)\n```\n\n::: {.cell-output-display}\n![](Aula04_files/figure-html/unnamed-chunk-11-1.png){width=90%}\n:::\n\n```{.r .cell-code}\ncorrplot(mcorr,method = \"number\")\n```\n\n::: {.cell-output-display}\n![](Aula04_files/figure-html/unnamed-chunk-11-2.png){width=90%}\n:::\n:::\n\n\n## Criando amostra de treino e teste\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(caret)\nset.seed(21)\ny <- propaganda$Vendas\nindice_teste <- createDataPartition(y, times = 1, p = 0.20, list = FALSE)\n\nconj_treino <- propaganda %>% slice(-indice_teste)\nconj_teste <- propaganda %>% slice(indice_teste)\n\nstr(conj_treino)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [159 × 4] (S3: tbl_df/tbl/data.frame)\n $ TV    : num [1:159] 17.2 151.5 8.7 120.2 199.8 ...\n $ Radio : num [1:159] 45.9 41.3 48.9 19.6 2.6 5.8 24 35.1 7.6 32.9 ...\n $ Jornal: num [1:159] 69.3 58.5 75 11.6 21.2 24.2 4 65.9 7.2 46 ...\n $ Vendas: num [1:159] 9.3 18.5 7.2 13.2 10.6 8.6 17.4 9.2 9.7 19 ...\n```\n:::\n\n```{.r .cell-code}\nstr(conj_teste)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [41 × 4] (S3: tbl_df/tbl/data.frame)\n $ TV    : num [1:41] 230.1 44.5 180.8 57.5 8.6 ...\n $ Radio : num [1:41] 37.8 39.3 10.8 32.8 2.1 39.6 23.9 3.5 28.3 17.4 ...\n $ Jornal: num [1:41] 69.2 45.1 58.4 23.5 1 55.8 19.1 19.5 43.2 38.6 ...\n $ Vendas: num [1:41] 22.1 10.4 12.9 11.8 4.8 24.4 14.6 12 21.4 11.9 ...\n```\n:::\n\n```{.r .cell-code}\ngt(head(conj_treino, 10))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"iibupdeghx\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#iibupdeghx .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#iibupdeghx .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#iibupdeghx .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#iibupdeghx .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#iibupdeghx .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#iibupdeghx .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#iibupdeghx .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#iibupdeghx .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#iibupdeghx .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#iibupdeghx .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#iibupdeghx .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#iibupdeghx .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#iibupdeghx .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#iibupdeghx .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#iibupdeghx .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#iibupdeghx .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#iibupdeghx .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iibupdeghx .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#iibupdeghx .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#iibupdeghx .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iibupdeghx .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#iibupdeghx .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#iibupdeghx .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#iibupdeghx .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iibupdeghx .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#iibupdeghx .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#iibupdeghx .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#iibupdeghx .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#iibupdeghx .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iibupdeghx .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#iibupdeghx .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iibupdeghx .gt_left {\n  text-align: left;\n}\n\n#iibupdeghx .gt_center {\n  text-align: center;\n}\n\n#iibupdeghx .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#iibupdeghx .gt_font_normal {\n  font-weight: normal;\n}\n\n#iibupdeghx .gt_font_bold {\n  font-weight: bold;\n}\n\n#iibupdeghx .gt_font_italic {\n  font-style: italic;\n}\n\n#iibupdeghx .gt_super {\n  font-size: 65%;\n}\n\n#iibupdeghx .gt_two_val_uncert {\n  display: inline-block;\n  line-height: 1em;\n  text-align: right;\n  font-size: 60%;\n  vertical-align: -0.25em;\n  margin-left: 0.1em;\n}\n\n#iibupdeghx .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#iibupdeghx .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#iibupdeghx .gt_slash_mark {\n  font-size: 0.7em;\n  line-height: 0.7em;\n  vertical-align: 0.15em;\n}\n\n#iibupdeghx .gt_fraction_numerator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: 0.45em;\n}\n\n#iibupdeghx .gt_fraction_denominator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: -0.05em;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">TV</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Radio</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Jornal</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Vendas</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_right\">17.2</td>\n<td class=\"gt_row gt_right\">45.9</td>\n<td class=\"gt_row gt_right\">69.3</td>\n<td class=\"gt_row gt_right\">9.3</td></tr>\n    <tr><td class=\"gt_row gt_right\">151.5</td>\n<td class=\"gt_row gt_right\">41.3</td>\n<td class=\"gt_row gt_right\">58.5</td>\n<td class=\"gt_row gt_right\">18.5</td></tr>\n    <tr><td class=\"gt_row gt_right\">8.7</td>\n<td class=\"gt_row gt_right\">48.9</td>\n<td class=\"gt_row gt_right\">75.0</td>\n<td class=\"gt_row gt_right\">7.2</td></tr>\n    <tr><td class=\"gt_row gt_right\">120.2</td>\n<td class=\"gt_row gt_right\">19.6</td>\n<td class=\"gt_row gt_right\">11.6</td>\n<td class=\"gt_row gt_right\">13.2</td></tr>\n    <tr><td class=\"gt_row gt_right\">199.8</td>\n<td class=\"gt_row gt_right\">2.6</td>\n<td class=\"gt_row gt_right\">21.2</td>\n<td class=\"gt_row gt_right\">10.6</td></tr>\n    <tr><td class=\"gt_row gt_right\">66.1</td>\n<td class=\"gt_row gt_right\">5.8</td>\n<td class=\"gt_row gt_right\">24.2</td>\n<td class=\"gt_row gt_right\">8.6</td></tr>\n    <tr><td class=\"gt_row gt_right\">214.7</td>\n<td class=\"gt_row gt_right\">24.0</td>\n<td class=\"gt_row gt_right\">4.0</td>\n<td class=\"gt_row gt_right\">17.4</td></tr>\n    <tr><td class=\"gt_row gt_right\">23.8</td>\n<td class=\"gt_row gt_right\">35.1</td>\n<td class=\"gt_row gt_right\">65.9</td>\n<td class=\"gt_row gt_right\">9.2</td></tr>\n    <tr><td class=\"gt_row gt_right\">97.5</td>\n<td class=\"gt_row gt_right\">7.6</td>\n<td class=\"gt_row gt_right\">7.2</td>\n<td class=\"gt_row gt_right\">9.7</td></tr>\n    <tr><td class=\"gt_row gt_right\">204.1</td>\n<td class=\"gt_row gt_right\">32.9</td>\n<td class=\"gt_row gt_right\">46.0</td>\n<td class=\"gt_row gt_right\">19.0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n## Regressão Simples $Vendas \\sim TV$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1 <- lm( Vendas ~ TV, data = conj_treino)\n```\n:::\n\n\n## Informações do ajuste e Resultados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"coefficients\"  \"residuals\"     \"effects\"       \"rank\"         \n [5] \"fitted.values\" \"assign\"        \"qr\"            \"df.residual\"  \n [9] \"xlevels\"       \"call\"          \"terms\"         \"model\"        \n```\n:::\n\n```{.r .cell-code}\nsummary(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Vendas ~ TV, data = conj_treino)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-7.8261 -1.7616 -0.0599  1.8989  7.3220 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  7.21359    0.50614   14.25   <2e-16 ***\nTV           0.04614    0.00301   15.33   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.158 on 157 degrees of freedom\nMultiple R-squared:  0.5995,\tAdjusted R-squared:  0.5969 \nF-statistic:   235 on 1 and 157 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsum_mod1 <- summary(mod1)\nnames(sum_mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"call\"          \"terms\"         \"residuals\"     \"coefficients\" \n [5] \"aliased\"       \"sigma\"         \"df\"            \"r.squared\"    \n [9] \"adj.r.squared\" \"fstatistic\"    \"cov.unscaled\" \n```\n:::\n:::\n\n\n## Outras informações do Ajuste\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum_mod1$sigma\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3.15769\n```\n:::\n\n```{.r .cell-code}\nsum_mod1$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.5994649\n```\n:::\n:::\n\n\n## Gráfico da Regressão\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoeflinear <- mod1$coefficients[1]\ncoefang <- mod1$coefficients[2]\nggplot(conj_treino, aes(x=TV, y=Vendas)) +\n    geom_point() +\n    geom_abline(slope = coefang,intercept = coeflinear, color=\"blue\" ) + \n    geom_hline(yintercept=coeflinear, linetype=\"dashed\", color = \"red\")\n```\n\n::: {.cell-output-display}\n![](Aula04_files/figure-html/unnamed-chunk-14-1.png){width=90%}\n:::\n:::\n\n\n## Gráfico da Regressão\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\nscatterplot(Vendas ~ TV, data = conj_treino, smooth=F)\n```\n\n::: {.cell-output-display}\n![](Aula04_files/figure-html/unnamed-chunk-15-1.png){width=90%}\n:::\n:::\n\n\n## Intervalo de Confiança para $\\beta_0$ e $\\beta_1$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconfint(mod1, level=0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 2.5 %     97.5 %\n(Intercept) 6.21386581 8.21330660\nTV          0.04019365 0.05208397\n```\n:::\n:::\n\n\n## Previsões\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredict(mod1, data.frame(TV=c(50, 150, 250)), interval = \"prediction\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        fit       lwr      upr\n1  9.520527  3.237859 15.80319\n2 14.134407  7.877747 20.39107\n3 18.748288 12.461271 25.03530\n```\n:::\n:::\n\n\n## ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: Vendas\n           Df Sum Sq Mean Sq F value    Pr(>F)    \nTV          1 2342.9 2342.94  234.98 < 2.2e-16 ***\nResiduals 157 1565.5    9.97                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Analisando os Resíduos\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nplot(mod1)\n```\n\n::: {.cell-output-display}\n![](Aula04_files/figure-html/unnamed-chunk-19-1.png){width=90%}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n```\n:::\n\n\n## Verificando Independencia dos Resíduos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lmtest)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: zoo\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'zoo'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n```\n:::\n\n```{.r .cell-code}\ndwtest(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tDurbin-Watson test\n\ndata:  mod1\nDW = 1.8578, p-value = 0.1835\nalternative hypothesis: true autocorrelation is greater than 0\n```\n:::\n:::\n\n\n## Verificando Homocedasticidade dos Resíduos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbptest(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tstudentized Breusch-Pagan test\n\ndata:  mod1\nBP = 37.881, df = 1, p-value = 7.519e-10\n```\n:::\n:::\n\n\n## Verificando Pontos Afastados\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#car\ninfluencePlot(mod1)\n```\n\n::: {.cell-output-display}\n![](Aula04_files/figure-html/unnamed-chunk-22-1.png){width=90%}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n        StudRes        Hat        CookD\n25  -2.55414901 0.02527870 8.171837e-02\n29  -0.01917304 0.02604819 4.947274e-06\n102  2.36589044 0.01128730 3.104163e-02\n104 -1.82461340 0.02550673 4.293306e-02\n139  2.27443079 0.02182638 5.621969e-02\n```\n:::\n:::\n\n\n## Verificando Normalidade dos Resíduos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(moments)\njarque.test(sum_mod1$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tJarque-Bera Normality Test\n\ndata:  sum_mod1$residuals\nJB = 0.28717, p-value = 0.8662\nalternative hypothesis: greater\n```\n:::\n:::\n\n\n## Transformação de Box-Cox\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#car\nboxCox(mod1)\n```\n\n::: {.cell-output-display}\n![](Aula04_files/figure-html/unnamed-chunk-24-1.png){width=90%}\n:::\n:::\n\n\n## Avaliando Modelo com Conjunto de Teste\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Erro de Teste\nsqrt(mean((conj_teste$Vendas - predict(mod1, conj_teste)) ^ 2)) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3.629383\n```\n:::\n\n```{.r .cell-code}\n# Erro de Treino\nsum_mod1$sigma\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3.15769\n```\n:::\n:::\n",
    "supporting": [
      "Aula04_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}