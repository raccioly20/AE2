{
  "hash": "7e09f56afd3bb0850ad72d2b085af15d",
  "result": {
    "markdown": "---\ntitle: \"Regressão Múltipla e Seleção de Modelos\"\nauthor: \"Ricardo Accioly\"\ndate: \"2022-10-06\"\noutput:\n html_document:\n    toc: yes\n    code_download: yes\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\n# parametros para imagens\nknitr::opts_chunk$set(\n  fig.width = 8,\n  fig.asp = 0.73,\n  fig.retina = 3,\n  dpi = 300,\n  out.width = \"90%\"\n)\n```\n:::\n\n\n## Carregando Bibliotecas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(faraway)\nlibrary(leaps) # Metodos de selecao\n```\n:::\n\n\n## Carregando os dados\n\nNeste exercíco vamos ajustar um modelo de regressão linear múltipla ao conjunto de dados fat da biblioteca faraway.\n\n-   Com o conjunto de dados de gordura (fat) na biblioteca (faraway), queremos ajustar um modelo de regressão linear múltipla para prever o percentual de gordura corporal (y = brozek) usando diversas variáveis disponíveis, com exceção de:\n\n1.  siri (outra forma de cálculo do % de gordura corporal)\n2.  densidade (é usada nas fórmulas brozek e siri)\n3.  livre (é computada usando fórmula brozek)\n4.  adipos (é calculada a partir do peso e da altura)\n\n-   Vamos criar um conjunto de treino (90%) e outro de teste (10%)\n\n-   A partir do conjunto de dados você deverá usar três métodos de seleção de variáveis explicativas:\n\n1.  O melhor subconjunto (bestsubset)\n2.  Seleção passo a passo a frente (forward selection)\n3.  Seleção passo a passo para trás (backward selection)\n\n-   Para cada método vamos ajustar o modelo usando o lm() com as variáveis selecionadas. Compare os resultados dos três métodos e escreva suas conclusões\n\n-   Por último vamo avaliar os resíduos do modelo\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(faraway)\ndata(\"fat\")\ngordura <- fat\nstr(gordura)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t252 obs. of  18 variables:\n $ brozek : num  12.6 6.9 24.6 10.9 27.8 20.6 19 12.8 5.1 12 ...\n $ siri   : num  12.3 6.1 25.3 10.4 28.7 20.9 19.2 12.4 4.1 11.7 ...\n $ density: num  1.07 1.09 1.04 1.08 1.03 ...\n $ age    : int  23 22 22 26 24 24 26 25 25 23 ...\n $ weight : num  154 173 154 185 184 ...\n $ height : num  67.8 72.2 66.2 72.2 71.2 ...\n $ adipos : num  23.7 23.4 24.7 24.9 25.6 26.5 26.2 23.6 24.6 25.8 ...\n $ free   : num  135 161 116 165 133 ...\n $ neck   : num  36.2 38.5 34 37.4 34.4 39 36.4 37.8 38.1 42.1 ...\n $ chest  : num  93.1 93.6 95.8 101.8 97.3 ...\n $ abdom  : num  85.2 83 87.9 86.4 100 94.4 90.7 88.5 82.5 88.6 ...\n $ hip    : num  94.5 98.7 99.2 101.2 101.9 ...\n $ thigh  : num  59 58.7 59.6 60.1 63.2 66 58.4 60 62.9 63.1 ...\n $ knee   : num  37.3 37.3 38.9 37.3 42.2 42 38.3 39.4 38.3 41.7 ...\n $ ankle  : num  21.9 23.4 24 22.8 24 25.6 22.9 23.2 23.8 25 ...\n $ biceps : num  32 30.5 28.8 32.4 32.2 35.7 31.9 30.5 35.9 35.6 ...\n $ forearm: num  27.4 28.9 25.2 29.4 27.7 30.6 27.8 29 31.1 30 ...\n $ wrist  : num  17.1 18.2 16.6 18.2 17.7 18.8 17.7 18.8 18.2 19.2 ...\n```\n:::\n:::\n\n\n## Renomeando as variáveis\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngordura <- gordura %>% rename(densidade = density, idade = age, peso=weight, altura = height,\n                          livre = free, pescoco = neck, torax = chest, quadril = hip,\n                           coxa = thigh, joelho = knee, tornozelo = ankle, antebraco = forearm,\n                           pulso = wrist) %>% \n                            select(brozek, idade, peso, altura, pescoco, torax, abdom, quadril,\n                                   coxa, joelho, tornozelo, biceps,antebraco, pulso)                             \nstr(gordura)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t252 obs. of  14 variables:\n $ brozek   : num  12.6 6.9 24.6 10.9 27.8 20.6 19 12.8 5.1 12 ...\n $ idade    : int  23 22 22 26 24 24 26 25 25 23 ...\n $ peso     : num  154 173 154 185 184 ...\n $ altura   : num  67.8 72.2 66.2 72.2 71.2 ...\n $ pescoco  : num  36.2 38.5 34 37.4 34.4 39 36.4 37.8 38.1 42.1 ...\n $ torax    : num  93.1 93.6 95.8 101.8 97.3 ...\n $ abdom    : num  85.2 83 87.9 86.4 100 94.4 90.7 88.5 82.5 88.6 ...\n $ quadril  : num  94.5 98.7 99.2 101.2 101.9 ...\n $ coxa     : num  59 58.7 59.6 60.1 63.2 66 58.4 60 62.9 63.1 ...\n $ joelho   : num  37.3 37.3 38.9 37.3 42.2 42 38.3 39.4 38.3 41.7 ...\n $ tornozelo: num  21.9 23.4 24 22.8 24 25.6 22.9 23.2 23.8 25 ...\n $ biceps   : num  32 30.5 28.8 32.4 32.2 35.7 31.9 30.5 35.9 35.6 ...\n $ antebraco: num  27.4 28.9 25.2 29.4 27.7 30.6 27.8 29 31.1 30 ...\n $ pulso    : num  17.1 18.2 16.6 18.2 17.7 18.8 17.7 18.8 18.2 19.2 ...\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fat\n# - brozek: Percentual de gordura corporal usando a equação de Brozek, 457/Densidade - 414,2\n# - siri:  Percentual de gordura corporal usando a equação de Siri, 495/Densidade - 450\n# - densidade: Densidade (gm/$cm^3$)\n# - idade: idade (anos)\n# - peso: Peso (libras)\n# - altura: Altura (polegadas)\n# - adipos: Índice de adiposidade = Peso/Altura$^2$ (kg/$m^2$)\n# - livre: Peso livre de gordura = (1 - fração de gordura corporal) * Peso, utilizando a fórmula de Brozek (lbs)\n# - pescoco: Circunferência do pescoço (cm)\n# - torax: Circunferência torácica (cm)\n# - abdom: Circunferência do abdômen (cm) no umbigo e nível com a crista ilíaca\n# - quadril: Circunferência do quadril (cm)\n# - coxa: Circunferência da coxa (cm)\n# - joelho: Circunferência do joelho (cm)\n# - tornozelo: Circunferência do tornozelo (cm)\n# - biceps: Circunferência estendida dos bíceps (cm)\n# - antebraco: Circunferência do antebraço (cm)\n# - pulso: Circunferência do pulso (cm) \n```\n:::\n\n\n## Conjunto de teste e treino\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(caret)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: lattice\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'lattice'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:faraway':\n\n    melanoma\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'caret'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    lift\n```\n:::\n\n```{.r .cell-code}\nset.seed(1234)\ny <- gordura$brozek\nindice_teste <- createDataPartition(y, times = 1, p = 0.10, list = FALSE)\n\nconj_treino <- gordura %>% slice(-indice_teste)\nconj_teste <- gordura %>% slice(indice_teste)\n\nsummary(conj_treino)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     brozek          idade            peso           altura     \n Min.   : 0.00   Min.   :22.00   Min.   :118.5   Min.   :29.50  \n 1st Qu.:12.80   1st Qu.:35.75   1st Qu.:159.0   1st Qu.:68.25  \n Median :19.00   Median :43.50   Median :177.0   Median :70.25  \n Mean   :18.86   Mean   :44.78   Mean   :179.1   Mean   :70.16  \n 3rd Qu.:24.60   3rd Qu.:53.25   3rd Qu.:196.8   3rd Qu.:72.25  \n Max.   :45.10   Max.   :81.00   Max.   :363.1   Max.   :77.75  \n    pescoco          torax            abdom           quadril      \n Min.   :31.10   Min.   : 79.30   Min.   : 69.40   Min.   : 85.00  \n 1st Qu.:36.40   1st Qu.: 94.83   1st Qu.: 84.58   1st Qu.: 95.58  \n Median :37.90   Median : 99.75   Median : 90.90   Median : 99.35  \n Mean   :37.99   Mean   :100.80   Mean   : 92.52   Mean   : 99.93  \n 3rd Qu.:39.52   3rd Qu.:105.30   3rd Qu.: 99.72   3rd Qu.:103.28  \n Max.   :51.20   Max.   :136.20   Max.   :148.10   Max.   :147.70  \n      coxa           joelho        tornozelo         biceps     \n Min.   :47.20   Min.   :33.00   Min.   :19.10   Min.   :24.80  \n 1st Qu.:56.00   1st Qu.:36.90   1st Qu.:22.00   1st Qu.:30.30  \n Median :59.10   Median :38.40   Median :22.85   Median :32.30  \n Mean   :59.45   Mean   :38.56   Mean   :23.10   Mean   :32.34  \n 3rd Qu.:62.35   3rd Qu.:40.00   3rd Qu.:24.00   3rd Qu.:34.40  \n Max.   :87.30   Max.   :49.10   Max.   :33.90   Max.   :45.00  \n   antebraco         pulso      \n Min.   :21.00   Min.   :15.80  \n 1st Qu.:27.30   1st Qu.:17.60  \n Median :28.75   Median :18.30  \n Mean   :28.66   Mean   :18.22  \n 3rd Qu.:30.00   3rd Qu.:18.80  \n Max.   :34.90   Max.   :21.40  \n```\n:::\n\n```{.r .cell-code}\nstr(conj_treino)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t224 obs. of  14 variables:\n $ brozek   : num  12.6 6.9 24.6 10.9 27.8 20.6 19 12.8 5.1 12 ...\n $ idade    : int  23 22 22 26 24 24 26 25 25 23 ...\n $ peso     : num  154 173 154 185 184 ...\n $ altura   : num  67.8 72.2 66.2 72.2 71.2 ...\n $ pescoco  : num  36.2 38.5 34 37.4 34.4 39 36.4 37.8 38.1 42.1 ...\n $ torax    : num  93.1 93.6 95.8 101.8 97.3 ...\n $ abdom    : num  85.2 83 87.9 86.4 100 94.4 90.7 88.5 82.5 88.6 ...\n $ quadril  : num  94.5 98.7 99.2 101.2 101.9 ...\n $ coxa     : num  59 58.7 59.6 60.1 63.2 66 58.4 60 62.9 63.1 ...\n $ joelho   : num  37.3 37.3 38.9 37.3 42.2 42 38.3 39.4 38.3 41.7 ...\n $ tornozelo: num  21.9 23.4 24 22.8 24 25.6 22.9 23.2 23.8 25 ...\n $ biceps   : num  32 30.5 28.8 32.4 32.2 35.7 31.9 30.5 35.9 35.6 ...\n $ antebraco: num  27.4 28.9 25.2 29.4 27.7 30.6 27.8 29 31.1 30 ...\n $ pulso    : num  17.1 18.2 16.6 18.2 17.7 18.8 17.7 18.8 18.2 19.2 ...\n```\n:::\n\n```{.r .cell-code}\nsummary(conj_teste)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     brozek          idade            peso           altura     \n Min.   : 7.10   Min.   :24.00   Min.   :133.5   Min.   :65.00  \n 1st Qu.:13.15   1st Qu.:36.50   1st Qu.:158.6   1st Qu.:67.94  \n Median :19.05   Median :42.50   Median :167.8   Median :69.75  \n Mean   :19.60   Mean   :45.71   Mean   :177.3   Mean   :70.05  \n 3rd Qu.:24.10   3rd Qu.:54.75   3rd Qu.:198.8   3rd Qu.:71.81  \n Max.   :38.20   Max.   :72.00   Max.   :247.2   Max.   :76.00  \n    pescoco          torax            abdom           quadril      \n Min.   :33.60   Min.   : 88.20   Min.   : 73.70   Min.   : 88.50  \n 1st Qu.:36.30   1st Qu.: 93.83   1st Qu.: 86.08   1st Qu.: 95.03  \n Median :38.30   Median : 98.00   Median : 92.15   Median : 98.15  \n Mean   :38.01   Mean   :101.00   Mean   : 92.84   Mean   : 99.72  \n 3rd Qu.:38.95   3rd Qu.:106.72   3rd Qu.: 98.95   3rd Qu.:103.72  \n Max.   :42.10   Max.   :118.50   Max.   :115.60   Max.   :116.10  \n      coxa           joelho        tornozelo         biceps     \n Min.   :50.30   Min.   :34.50   Min.   :20.40   Min.   :27.90  \n 1st Qu.:56.23   1st Qu.:37.55   1st Qu.:22.20   1st Qu.:29.98  \n Median :57.35   Median :38.75   Median :22.70   Median :31.05  \n Mean   :59.06   Mean   :38.85   Mean   :23.09   Mean   :31.76  \n 3rd Qu.:62.20   3rd Qu.:39.73   3rd Qu.:23.80   3rd Qu.:32.27  \n Max.   :71.20   Max.   :45.00   Max.   :26.30   Max.   :38.50  \n   antebraco         pulso      \n Min.   :25.20   Min.   :16.90  \n 1st Qu.:27.27   1st Qu.:17.70  \n Median :28.60   Median :18.45  \n Mean   :28.68   Mean   :18.32  \n 3rd Qu.:30.07   3rd Qu.:18.85  \n Max.   :32.80   Max.   :19.90  \n```\n:::\n\n```{.r .cell-code}\nstr(conj_teste)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t28 obs. of  14 variables:\n $ brozek   : num  20.5 19 15.3 13.4 31.1 38.2 11.2 7.1 21.1 23.7 ...\n $ idade    : int  35 28 28 27 41 49 40 49 54 62 ...\n $ peso     : num  163 179 200 168 247 ...\n $ altura   : num  66 68 69.8 71.2 73.5 ...\n $ pescoco  : num  36.4 39.1 41.3 38.1 42.1 38.4 33.6 35.1 35.6 35.5 ...\n $ torax    : num  99.1 103.3 111.4 93 117 ...\n $ abdom    : num  92.8 95.9 98.8 79.1 115.6 ...\n $ quadril  : num  99.2 104.9 104.8 94.5 116.1 ...\n $ coxa     : num  63.1 63.5 63.4 57.3 71.2 61.9 53.3 52.6 55 56.6 ...\n $ joelho   : num  38.7 38 40.6 36.2 43.3 38.3 34.5 37.6 36.1 38.6 ...\n $ tornozelo: num  21.7 22.1 24.6 24.5 26.3 21.9 22.5 22.6 21.7 22.4 ...\n $ biceps   : num  31.1 32.5 33 29 37.3 32 27.9 38.5 29.6 31.5 ...\n $ antebraco: num  26.4 30.3 32.8 30 31.7 29.8 26.2 27.4 27.4 27.3 ...\n $ pulso    : num  16.9 18.4 19.9 18.8 19.7 17 17.3 18.5 17.4 18.6 ...\n```\n:::\n\n```{.r .cell-code}\nhead(conj_treino)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  brozek idade   peso altura pescoco torax abdom quadril coxa joelho tornozelo\n1   12.6    23 154.25  67.75    36.2  93.1  85.2    94.5 59.0   37.3      21.9\n2    6.9    22 173.25  72.25    38.5  93.6  83.0    98.7 58.7   37.3      23.4\n3   24.6    22 154.00  66.25    34.0  95.8  87.9    99.2 59.6   38.9      24.0\n4   10.9    26 184.75  72.25    37.4 101.8  86.4   101.2 60.1   37.3      22.8\n5   27.8    24 184.25  71.25    34.4  97.3 100.0   101.9 63.2   42.2      24.0\n6   20.6    24 210.25  74.75    39.0 104.5  94.4   107.8 66.0   42.0      25.6\n  biceps antebraco pulso\n1   32.0      27.4  17.1\n2   30.5      28.9  18.2\n3   28.8      25.2  16.6\n4   32.4      29.4  18.2\n5   32.2      27.7  17.7\n6   35.7      30.6  18.8\n```\n:::\n:::\n\n\n## Estatística descritiva e Matriz de Dispersão\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(psych)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'psych'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:faraway':\n\n    logit\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:ggplot2':\n\n    %+%, alpha\n```\n:::\n\n```{.r .cell-code}\ndescribe(conj_treino)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          vars   n   mean    sd median trimmed   mad   min    max  range  skew\nbrozek       1 224  18.86  7.72  19.00   18.82  8.45   0.0  45.10  45.10  0.08\nidade        2 224  44.78 12.42  43.50   44.36 12.60  22.0  81.00  59.00  0.29\npeso         3 224 179.13 29.59 177.00  177.82 28.35 118.5 363.15 244.65  1.22\naltura       4 224  70.16  3.78  70.25   70.31  2.97  29.5  77.75  48.25 -5.48\npescoco      5 224  37.99  2.47  37.90   37.96  2.37  31.1  51.20  20.10  0.58\ntorax        6 224 100.80  8.39  99.75  100.30  8.08  79.3 136.20  56.90  0.68\nabdom        7 224  92.52 10.74  90.90   91.98 10.82  69.4 148.10  78.70  0.90\nquadril      8 224  99.93  7.20  99.35   99.54  5.71  85.0 147.70  62.70  1.56\ncoxa         9 224  59.45  5.27  59.10   59.25  4.60  47.2  87.30  40.10  0.80\njoelho      10 224  38.56  2.41  38.40   38.48  2.30  33.0  49.10  16.10  0.50\ntornozelo   11 224  23.10  1.74  22.85   22.98  1.41  19.1  33.90  14.80  2.29\nbiceps      12 224  32.34  3.04  32.30   32.34  3.11  24.8  45.00  20.20  0.20\nantebraco   13 224  28.66  2.04  28.75   28.68  2.00  21.0  34.90  13.90 -0.26\npulso       14 224  18.22  0.94  18.30   18.20  0.89  15.8  21.40   5.60  0.29\n          kurtosis   se\nbrozek       -0.39 0.52\nidade        -0.36 0.83\npeso          5.51 1.98\naltura       57.59 0.25\npescoco       2.73 0.17\ntorax         1.15 0.56\nabdom         2.53 0.72\nquadril       7.97 0.48\ncoxa          2.79 0.35\njoelho        1.06 0.16\ntornozelo    11.65 0.12\nbiceps        0.51 0.20\nantebraco     0.89 0.14\npulso         0.45 0.06\n```\n:::\n\n```{.r .cell-code}\npairs.panels(conj_treino)\n```\n\n::: {.cell-output-display}\n![](Aula05_files/figure-html/unnamed-chunk-4-1.png){width=90%}\n:::\n\n```{.r .cell-code}\npairs.panels(conj_treino[,1:7])\n```\n\n::: {.cell-output-display}\n![](Aula05_files/figure-html/unnamed-chunk-4-2.png){width=90%}\n:::\n\n```{.r .cell-code}\npairs.panels(conj_treino[,c(1,8:14)])\n```\n\n::: {.cell-output-display}\n![](Aula05_files/figure-html/unnamed-chunk-4-3.png){width=90%}\n:::\n:::\n\n\n## Matriz de correlação\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(corrplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\ncorrplot 0.92 loaded\n```\n:::\n\n```{.r .cell-code}\nmat_corr <- cor(conj_treino)\ncorrplot(mat_corr)\n```\n\n::: {.cell-output-display}\n![](Aula05_files/figure-html/unnamed-chunk-5-1.png){width=90%}\n:::\n:::\n\n\n## Regressão Múltipla\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1a <- lm(brozek ~ ., data=conj_treino)\nsummary(mod1a)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = brozek ~ ., data = conj_treino)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-10.0507  -2.6484  -0.0864   2.8196   9.3863 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -13.55860   17.49304  -0.775  0.43916    \nidade         0.04398    0.03171   1.387  0.16694    \npeso         -0.08151    0.05559  -1.466  0.14408    \naltura       -0.06734    0.09043  -0.745  0.45726    \npescoco      -0.50983    0.22858  -2.230  0.02678 *  \ntorax        -0.01038    0.09828  -0.106  0.91597    \nabdom         0.89639    0.08292  10.810  < 2e-16 ***\nquadril      -0.25304    0.14978  -1.689  0.09262 .  \ncoxa          0.27120    0.13833   1.961  0.05126 .  \njoelho        0.04954    0.23704   0.209  0.83465    \ntornozelo     0.13702    0.20872   0.656  0.51223    \nbiceps        0.21144    0.17910   1.181  0.23911    \nantebraco     0.42384    0.19078   2.222  0.02738 *  \npulso        -1.51764    0.52213  -2.907  0.00405 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.949 on 210 degrees of freedom\nMultiple R-squared:  0.7538,\tAdjusted R-squared:  0.7386 \nF-statistic: 49.47 on 13 and 210 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n## Métodos de seleção de modelo\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Best Subset \nmod1.bs <- regsubsets(brozek ~ . , data = conj_treino, nvmax = 14)\nsum.mod1bs <- summary(mod1.bs)\nsum.mod1bs\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSubset selection object\nCall: regsubsets.formula(brozek ~ ., data = conj_treino, nvmax = 14)\n13 Variables  (and intercept)\n          Forced in Forced out\nidade         FALSE      FALSE\npeso          FALSE      FALSE\naltura        FALSE      FALSE\npescoco       FALSE      FALSE\ntorax         FALSE      FALSE\nabdom         FALSE      FALSE\nquadril       FALSE      FALSE\ncoxa          FALSE      FALSE\njoelho        FALSE      FALSE\ntornozelo     FALSE      FALSE\nbiceps        FALSE      FALSE\nantebraco     FALSE      FALSE\npulso         FALSE      FALSE\n1 subsets of each size up to 13\nSelection Algorithm: exhaustive\n          idade peso altura pescoco torax abdom quadril coxa joelho tornozelo\n1  ( 1 )  \" \"   \" \"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n2  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n3  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n4  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n5  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \"*\"  \" \"    \" \"      \n6  ( 1 )  \" \"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n7  ( 1 )  \" \"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n8  ( 1 )  \"*\"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n9  ( 1 )  \"*\"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n10  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n11  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \"*\"      \n12  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \"*\"    \"*\"      \n13  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \"*\"   \"*\"   \"*\"     \"*\"  \"*\"    \"*\"      \n          biceps antebraco pulso\n1  ( 1 )  \" \"    \" \"       \" \"  \n2  ( 1 )  \" \"    \" \"       \" \"  \n3  ( 1 )  \" \"    \" \"       \"*\"  \n4  ( 1 )  \" \"    \"*\"       \"*\"  \n5  ( 1 )  \" \"    \"*\"       \"*\"  \n6  ( 1 )  \"*\"    \"*\"       \"*\"  \n7  ( 1 )  \" \"    \"*\"       \"*\"  \n8  ( 1 )  \" \"    \"*\"       \"*\"  \n9  ( 1 )  \"*\"    \"*\"       \"*\"  \n10  ( 1 ) \"*\"    \"*\"       \"*\"  \n11  ( 1 ) \"*\"    \"*\"       \"*\"  \n12  ( 1 ) \"*\"    \"*\"       \"*\"  \n13  ( 1 ) \"*\"    \"*\"       \"*\"  \n```\n:::\n\n```{.r .cell-code}\nnames(sum.mod1bs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"which\"  \"rsq\"    \"rss\"    \"adjr2\"  \"cp\"     \"bic\"    \"outmat\" \"obj\"   \n```\n:::\n:::\n\n\n## Avaliando o modelos\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Os modelos vão ser escolhidos com base no menor Cp\nplot(sum.mod1bs$cp,xlab=\"Numero de Variaveis\",ylab=\"Cp\")\nwhich.min(sum.mod1bs$cp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 8\n```\n:::\n\n```{.r .cell-code}\npoints(8,sum.mod1bs$cp[8],pch=20,col=\"red\")\n```\n\n::: {.cell-output-display}\n![](Aula05_files/figure-html/unnamed-chunk-8-1.png){width=90%}\n:::\n:::\n\n\n## Como extrair detalhes do ajuste\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoef(mod1.bs,8)  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n (Intercept)        idade         peso      pescoco        abdom      quadril \n-17.66873314   0.04903682  -0.08086437  -0.49111763   0.89449420  -0.23874321 \n        coxa    antebraco        pulso \n  0.34303707   0.51253418  -1.45541810 \n```\n:::\n:::\n\n\n## Forward Stepwise (passo a passo à frente)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1.fw <- regsubsets(brozek ~ . , data = conj_treino, nvmax = 14, method=\"forward\")\nsum.mod1fw <- summary(mod1.fw)\nsum.mod1fw\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSubset selection object\nCall: regsubsets.formula(brozek ~ ., data = conj_treino, nvmax = 14, \n    method = \"forward\")\n13 Variables  (and intercept)\n          Forced in Forced out\nidade         FALSE      FALSE\npeso          FALSE      FALSE\naltura        FALSE      FALSE\npescoco       FALSE      FALSE\ntorax         FALSE      FALSE\nabdom         FALSE      FALSE\nquadril       FALSE      FALSE\ncoxa          FALSE      FALSE\njoelho        FALSE      FALSE\ntornozelo     FALSE      FALSE\nbiceps        FALSE      FALSE\nantebraco     FALSE      FALSE\npulso         FALSE      FALSE\n1 subsets of each size up to 13\nSelection Algorithm: forward\n          idade peso altura pescoco torax abdom quadril coxa joelho tornozelo\n1  ( 1 )  \" \"   \" \"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n2  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n3  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n4  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n5  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \"*\"  \" \"    \" \"      \n6  ( 1 )  \" \"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \" \"     \"*\"  \" \"    \" \"      \n7  ( 1 )  \" \"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n8  ( 1 )  \"*\"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n9  ( 1 )  \"*\"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n10  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n11  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \"*\"      \n12  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \"*\"    \"*\"      \n13  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \"*\"   \"*\"   \"*\"     \"*\"  \"*\"    \"*\"      \n          biceps antebraco pulso\n1  ( 1 )  \" \"    \" \"       \" \"  \n2  ( 1 )  \" \"    \" \"       \" \"  \n3  ( 1 )  \" \"    \" \"       \"*\"  \n4  ( 1 )  \" \"    \"*\"       \"*\"  \n5  ( 1 )  \" \"    \"*\"       \"*\"  \n6  ( 1 )  \" \"    \"*\"       \"*\"  \n7  ( 1 )  \" \"    \"*\"       \"*\"  \n8  ( 1 )  \" \"    \"*\"       \"*\"  \n9  ( 1 )  \"*\"    \"*\"       \"*\"  \n10  ( 1 ) \"*\"    \"*\"       \"*\"  \n11  ( 1 ) \"*\"    \"*\"       \"*\"  \n12  ( 1 ) \"*\"    \"*\"       \"*\"  \n13  ( 1 ) \"*\"    \"*\"       \"*\"  \n```\n:::\n\n```{.r .cell-code}\nnames(sum.mod1fw)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"which\"  \"rsq\"    \"rss\"    \"adjr2\"  \"cp\"     \"bic\"    \"outmat\" \"obj\"   \n```\n:::\n:::\n\n\n## Avaliando o modelo\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Os modelos vão ser escolhidos com base no menor Cp\nplot(sum.mod1fw$cp,xlab=\"Numero de Variaveis\",ylab=\"Cp\")\nwhich.min(sum.mod1fw$cp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 8\n```\n:::\n\n```{.r .cell-code}\npoints(8,sum.mod1fw$cp[8],pch=20,col=\"red\")\n```\n\n::: {.cell-output-display}\n![](Aula05_files/figure-html/unnamed-chunk-11-1.png){width=90%}\n:::\n:::\n\n\n## Como extrair detalhes do ajuste\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoef(mod1.fw,8)  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n (Intercept)        idade         peso      pescoco        abdom      quadril \n-17.66873314   0.04903682  -0.08086437  -0.49111763   0.89449420  -0.23874321 \n        coxa    antebraco        pulso \n  0.34303707   0.51253418  -1.45541810 \n```\n:::\n:::\n\n\n## Backward Stepwise (passo a passo atrás)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1.bw <- regsubsets(brozek ~ . , data = conj_treino, nvmax = 14, method=\"backward\")\nsum.mod1bw <- summary(mod1.bw)\nsum.mod1bw\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSubset selection object\nCall: regsubsets.formula(brozek ~ ., data = conj_treino, nvmax = 14, \n    method = \"backward\")\n13 Variables  (and intercept)\n          Forced in Forced out\nidade         FALSE      FALSE\npeso          FALSE      FALSE\naltura        FALSE      FALSE\npescoco       FALSE      FALSE\ntorax         FALSE      FALSE\nabdom         FALSE      FALSE\nquadril       FALSE      FALSE\ncoxa          FALSE      FALSE\njoelho        FALSE      FALSE\ntornozelo     FALSE      FALSE\nbiceps        FALSE      FALSE\nantebraco     FALSE      FALSE\npulso         FALSE      FALSE\n1 subsets of each size up to 13\nSelection Algorithm: backward\n          idade peso altura pescoco torax abdom quadril coxa joelho tornozelo\n1  ( 1 )  \" \"   \" \"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n2  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n3  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n4  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n5  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \"*\"  \" \"    \" \"      \n6  ( 1 )  \" \"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \" \"     \"*\"  \" \"    \" \"      \n7  ( 1 )  \" \"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n8  ( 1 )  \"*\"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n9  ( 1 )  \"*\"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n10  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n11  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \"*\"      \n12  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \"*\"    \"*\"      \n13  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \"*\"   \"*\"   \"*\"     \"*\"  \"*\"    \"*\"      \n          biceps antebraco pulso\n1  ( 1 )  \" \"    \" \"       \" \"  \n2  ( 1 )  \" \"    \" \"       \" \"  \n3  ( 1 )  \" \"    \" \"       \"*\"  \n4  ( 1 )  \" \"    \"*\"       \"*\"  \n5  ( 1 )  \" \"    \"*\"       \"*\"  \n6  ( 1 )  \" \"    \"*\"       \"*\"  \n7  ( 1 )  \" \"    \"*\"       \"*\"  \n8  ( 1 )  \" \"    \"*\"       \"*\"  \n9  ( 1 )  \"*\"    \"*\"       \"*\"  \n10  ( 1 ) \"*\"    \"*\"       \"*\"  \n11  ( 1 ) \"*\"    \"*\"       \"*\"  \n12  ( 1 ) \"*\"    \"*\"       \"*\"  \n13  ( 1 ) \"*\"    \"*\"       \"*\"  \n```\n:::\n\n```{.r .cell-code}\nnames(sum.mod1bw)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"which\"  \"rsq\"    \"rss\"    \"adjr2\"  \"cp\"     \"bic\"    \"outmat\" \"obj\"   \n```\n:::\n:::\n\n\n## Avaliando o modelo\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Os modelos vão ser escolhidos com base no menor Cp\nplot(sum.mod1bw$cp,xlab=\"Numero de Variaveis\",ylab=\"Cp\")\nwhich.min(sum.mod1bw$cp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 8\n```\n:::\n\n```{.r .cell-code}\npoints(8,sum.mod1bw$cp[8],pch=20,col=\"red\")\n```\n\n::: {.cell-output-display}\n![](Aula05_files/figure-html/unnamed-chunk-14-1.png){width=90%}\n:::\n:::\n\n\n## Como extrair detalhes do ajuste\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoef(mod1.bw,8)  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n (Intercept)        idade         peso      pescoco        abdom      quadril \n-17.66873314   0.04903682  -0.08086437  -0.49111763   0.89449420  -0.23874321 \n        coxa    antebraco        pulso \n  0.34303707   0.51253418  -1.45541810 \n```\n:::\n:::\n\n\nComo vimos, independente do método de seleção de variáveis, usando o Cp o melhor modelo é o com 8 variáveis explicativas: idade, peso, pescoco, abdom, quadril, coxa, antebraco e pulso\n\n## Testando outra estatística de seleção de modelos - BIC\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# BIC\nplot(sum.mod1bs$bic,xlab=\"Numero de Variaveis\",ylab=\"BIC\")\nwhich.min(sum.mod1bs$bic)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4\n```\n:::\n\n```{.r .cell-code}\npoints(4,sum.mod1bs$bic[4],pch=20,col=\"red\")\n```\n\n::: {.cell-output-display}\n![](Aula05_files/figure-html/unnamed-chunk-16-1.png){width=90%}\n:::\n:::\n\n\n## Como extrair detalhes do ajuste\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoef(mod1.bs,4)  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Intercept)        peso       abdom   antebraco       pulso \n-30.2919680  -0.1244007   0.9288492   0.5181297  -1.6114492 \n```\n:::\n:::\n\n\nPelo BIC o melhor modelo é o com 4 variáves explicativas: peso, abdom, antebraço e pulso.\n\n## Comparando os dois modelos com o lm()\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Usando o lm para ajustar o modelo com as variáveis selecionadas pelo BIC\n## Seleção do BIC\nmod1a.lm <- lm(brozek ~ peso + abdom + antebraco + pulso,data=conj_treino)\nsummary(mod1a.lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = brozek ~ peso + abdom + antebraco + pulso, data = conj_treino)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-9.7403 -2.8496 -0.1399  2.9035  8.5253 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -30.29197    7.02195  -4.314 2.43e-05 ***\npeso         -0.12440    0.02400  -5.182 4.97e-07 ***\nabdom         0.92885    0.05554  16.723  < 2e-16 ***\nantebraco     0.51813    0.17193   3.014 0.002885 ** \npulso        -1.61145    0.43290  -3.722 0.000251 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.998 on 219 degrees of freedom\nMultiple R-squared:  0.7369,\tAdjusted R-squared:  0.7321 \nF-statistic: 153.4 on 4 and 219 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\n## Seleção do Cp\nmod1b.lm <- lm(brozek ~ idade + peso + pescoco + abdom + quadril + coxa + antebraco + pulso,data=conj_treino)\nsummary(mod1b.lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = brozek ~ idade + peso + pescoco + abdom + quadril + \n    coxa + antebraco + pulso, data = conj_treino)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-9.9166 -2.7293 -0.1825  2.7588  9.5966 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -17.66873   11.67115  -1.514  0.13152    \nidade         0.04904    0.03024   1.622  0.10634    \npeso         -0.08086    0.04091  -1.976  0.04938 *  \npescoco      -0.49112    0.21790  -2.254  0.02521 *  \nabdom         0.89449    0.07019  12.744  < 2e-16 ***\nquadril      -0.23874    0.13868  -1.721  0.08660 .  \ncoxa          0.34304    0.12521   2.740  0.00667 ** \nantebraco     0.51253    0.17573   2.917  0.00391 ** \npulso        -1.45542    0.49709  -2.928  0.00378 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.928 on 215 degrees of freedom\nMultiple R-squared:  0.7508,\tAdjusted R-squared:  0.7415 \nF-statistic: 80.95 on 8 and 215 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nAjustando com o lm o modelo com as variáveis indicadas pelo BIC obtivemos um R2 ajustado de 0,7321, um erro padrão de resíduo de 3,998. Pelos valores da estatística t vemos que todas as variáveis escolhidas são estatisticamente significativas\n\nAjustando pelo Cp o R2 ajustado foi de 0,7415 e o erro padrão do resíduo foi de 3,928.\n\nNo entanto com o Cp, temos uma variável que se mostrou não significativas: idade Parece que o Cp exagerou!\n\n## Avaliando Colinearidade\n\nUma investigação minuciosa da multicolinearidade envolverá a análise do valor do $R^2$ que resulta da regressão de cada uma das variáveis explicativas contra todas as outras. A relação entre as variáveis explicativas pode ser julgada examinando uma quantidade chamada fator de inflacionário da variância (FIV) ou Variance Inflation Factor (VIF). Seja $Rj~^{2}$ o quadrado do coeficiente de correlação múltipla que resulta quando a variável explicativa $Xj~$ é ajustada contra todas as outras variáveis explicativas. Então o vif para $Xj~$ é $VIFj = 1 / (1-Rj~^{2})$\n\n**A regra geral é que vifs superiores a 4 justificam novas investigações, enquanto VIFs superiores a 10 são sinais de multicolinearidade grave que requerem correção.**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'car'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:psych':\n\n    logit\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:faraway':\n\n    logit, vif\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    some\n```\n:::\n\n```{.r .cell-code}\nvif(mod1a.lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     peso     abdom antebraco     pulso \n 7.038103  4.967719  1.721647  2.310727 \n```\n:::\n:::\n\n\n## Testando os dois modelos com o conjunto de teste\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modelo com base no BIC\nsummary(mod1a.lm)$sigma\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3.997985\n```\n:::\n\n```{.r .cell-code}\nsummary(mod1a.lm)$adj.r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7321416\n```\n:::\n\n```{.r .cell-code}\nsqrt(mean((conj_teste$brozek - predict(mod1a.lm, conj_teste)) ^ 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4.231517\n```\n:::\n\n```{.r .cell-code}\n# Modelo com base no Cp\nsummary(mod1b.lm)$sigma\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3.92764\n```\n:::\n\n```{.r .cell-code}\nsummary(mod1b.lm)$adj.r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7414846\n```\n:::\n\n```{.r .cell-code}\nsqrt(mean((conj_teste$brozek - predict(mod1b.lm, conj_teste)) ^ 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4.301996\n```\n:::\n:::\n\n\nO erro de teste do BIC deu 4,231517. O erro de teste do Cp deu 4,301996, maior que o modelo do BIC.\n\n## Avaliando os Resíduos\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(2,2))\nplot(mod1a.lm)\n```\n\n::: {.cell-output-display}\n![](Aula05_files/figure-html/unnamed-chunk-21-1.png){width=90%}\n:::\n\n```{.r .cell-code}\npar(mfrow=c(1,1))\nlibrary(car)\nresidualPlots(mod1a.lm, tests=FALSE)\n```\n\n::: {.cell-output-display}\n![](Aula05_files/figure-html/unnamed-chunk-21-2.png){width=90%}\n:::\n\n```{.r .cell-code}\nshapiro.test(mod1a.lm$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mod1a.lm$residuals\nW = 0.98912, p-value = 0.08867\n```\n:::\n\n```{.r .cell-code}\nlibrary(lmtest)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: zoo\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'zoo'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n```\n:::\n\n```{.r .cell-code}\nbptest(mod1a.lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tstudentized Breusch-Pagan test\n\ndata:  mod1a.lm\nBP = 1.0144, df = 4, p-value = 0.9076\n```\n:::\n\n```{.r .cell-code}\ninfluencePlot(mod1a.lm)\n```\n\n::: {.cell-output-display}\n![](Aula05_files/figure-html/unnamed-chunk-21-3.png){width=90%}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n       StudRes        Hat      CookD\n39  -2.6515288 0.28623188 0.54876460\n175  0.9995493 0.21064336 0.05332302\n225 -2.4952041 0.02389734 0.02977518\n```\n:::\n:::\n",
    "supporting": [
      "Aula05_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}