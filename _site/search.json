[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Sobre",
    "section": "",
    "text": "Bom dia / Boa tarde / Boa Noite,\nSou o Professor Ricardo Accioly e esta é a página principal do site da disciplina Análise Estatística II IME05-00296 do Departamento de Estatística da UERJ.\nEste site foi construído usando Quarto e foi baseado em diversas fontes de informação obtidas na internet.\nSeguem algumas referências úteis para o Quarto:\n[Quarto](https://quarto.org/ “Quarto”)\n[Curso da Duke University](https://sta210-s22.github.io/website/ “STA210”)\n[Como criar um blog com o Quarto](https://beamilz.com/posts/2022-06-05-creating-a-blog-with-quarto/en/index.html “Blog”)\n[Webnar do Quarto](https://www.youtube.com/watch?v=yvi5uXQMvu4materials/1-welcome-to-quarto/slides/welcome-to-quarto.html#/title-slide “Webnar”)"
  },
  {
    "objectID": "acesso-rstudio.html",
    "href": "acesso-rstudio.html",
    "title": "RStudio Cloud",
    "section": "",
    "text": "Para acessar as tarefas no RStudio Cloud, abra uma conta gratuita no mesmo e acesse o link abaixo\nRStudio"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Análise Estatística II",
    "section": "",
    "text": "Esta página você vai encontrar o material didático que servirá de complemento para as aulas da disciplina de Análise Estatística II.\nAs mudanças serão constantes ao longo do semestre.\nAula 01\nAula 02\nAula 03\nAula 04\nAula 05\nAula 06"
  },
  {
    "objectID": "semanas/Aula01.html",
    "href": "semanas/Aula01.html",
    "title": "Distribuições de Probabilidade",
    "section": "",
    "text": "library(tidyverse)\nlibrary(kableExtra)"
  },
  {
    "objectID": "semanas/Aula01.html#fraudes-em-uma-loja",
    "href": "semanas/Aula01.html#fraudes-em-uma-loja",
    "title": "Distribuições de Probabilidade",
    "section": "Fraudes em uma loja",
    "text": "Fraudes em uma loja\nBuscando obter um modelo para o número de fraudes com cartão numa loja, foram coletadas, ao longo de 1 ano, o número de ocorrências por semana. Os dados obtidos foram:\n\n0 ocorrências em 9 semanas\n1 ocorrência em 14 semanas\n2 ocorrências em 13 semanas\n3 ocorrências em 9 semanas\n4 ocorrências em 4 semanas\n5 ocorrências em 2 semanas\n6 ocorrências em 1 semana\n\n\nsemanas <- c(9, 14, 13, 9, 4, 2, 1)\nsum(semanas)\n\n[1] 52\n\nprobabilidade <- semanas/52\nprobabilidade\n\n[1] 0.17307692 0.26923077 0.25000000 0.17307692 0.07692308 0.03846154 0.01923077\n\nround(probabilidade, 2) # arredondando para 2 casas decimais\n\n[1] 0.17 0.27 0.25 0.17 0.08 0.04 0.02"
  },
  {
    "objectID": "semanas/Aula01.html#criando-uma-tabela",
    "href": "semanas/Aula01.html#criando-uma-tabela",
    "title": "Distribuições de Probabilidade",
    "section": "Criando uma tabela",
    "text": "Criando uma tabela\n\nfraude_loja <- data.frame(n_fraudes=0:6, prob=probabilidade)\nfraude_loja\n\n  n_fraudes       prob\n1         0 0.17307692\n2         1 0.26923077\n3         2 0.25000000\n4         3 0.17307692\n5         4 0.07692308\n6         5 0.03846154\n7         6 0.01923077\n\nfraude_loja %>% kbl(digits = 2) %>% kable_minimal()\n\n\n\n \n  \n    n_fraudes \n    prob \n  \n \n\n  \n    0 \n    0.17 \n  \n  \n    1 \n    0.27 \n  \n  \n    2 \n    0.25 \n  \n  \n    3 \n    0.17 \n  \n  \n    4 \n    0.08 \n  \n  \n    5 \n    0.04 \n  \n  \n    6 \n    0.02"
  },
  {
    "objectID": "semanas/Aula01.html#visualizando-a-distribuição",
    "href": "semanas/Aula01.html#visualizando-a-distribuição",
    "title": "Distribuições de Probabilidade",
    "section": "Visualizando a distribuição",
    "text": "Visualizando a distribuição\n\nfraudes <- 0:6\nplot(fraudes, probabilidade, xlab = \"Numero de fraudes numa semana\", ylab = \"Probabilidade\", type = \"h\")"
  },
  {
    "objectID": "semanas/Aula01.html#probabilidade-acumulada",
    "href": "semanas/Aula01.html#probabilidade-acumulada",
    "title": "Distribuições de Probabilidade",
    "section": "Probabilidade Acumulada",
    "text": "Probabilidade Acumulada\n\nprob_acum <- cumsum(probabilidade)\nfraude_loja2 <- data.frame(n_fraudes=0:6, prob_acum=prob_acum)\nfraude_loja2 %>% kbl(digits = 2) %>% kable_minimal()\n\n\n\n \n  \n    n_fraudes \n    prob_acum \n  \n \n\n  \n    0 \n    0.17 \n  \n  \n    1 \n    0.44 \n  \n  \n    2 \n    0.69 \n  \n  \n    3 \n    0.87 \n  \n  \n    4 \n    0.94 \n  \n  \n    5 \n    0.98 \n  \n  \n    6 \n    1.00 \n  \n\n\n\n\n\n\nplot(fraudes, prob_acum, xlab = \"Numero de fraudes numa semana\",\nylab = \"Probabilidade Acumulada (P(X<=x))\", type = \"S\")"
  },
  {
    "objectID": "semanas/Aula01.html#distribuições-de-probabilidade-no-r",
    "href": "semanas/Aula01.html#distribuições-de-probabilidade-no-r",
    "title": "Distribuições de Probabilidade",
    "section": "Distribuições de Probabilidade no R",
    "text": "Distribuições de Probabilidade no R\nNo R nós temos quatro funções que podem nos fornecer elementos de uma distribuição de probabilidade:\n\nDensidade ou probabilidade\nProbabilidade acumulada / Função distribuição acumulada\nQuantis\nNúmeros aleatórios"
  },
  {
    "objectID": "semanas/Aula01.html#exemplo-de-distribuição-discreta",
    "href": "semanas/Aula01.html#exemplo-de-distribuição-discreta",
    "title": "Distribuições de Probabilidade",
    "section": "Exemplo de distribuição discreta",
    "text": "Exemplo de distribuição discreta"
  },
  {
    "objectID": "semanas/Aula01.html#probabilidades-de-uma-binomial",
    "href": "semanas/Aula01.html#probabilidades-de-uma-binomial",
    "title": "Distribuições de Probabilidade",
    "section": "Probabilidades de uma binomial",
    "text": "Probabilidades de uma binomial\n\nx <- 0:50\nplot(x, dbinom(x, size=50, prob = 0.30), type=\"h\")"
  },
  {
    "objectID": "semanas/Aula01.html#probabilidade-acumulada-1",
    "href": "semanas/Aula01.html#probabilidade-acumulada-1",
    "title": "Distribuições de Probabilidade",
    "section": "Probabilidade Acumulada",
    "text": "Probabilidade Acumulada\n\nplot(x, pbinom(x, size=50, prob = 0.30))"
  },
  {
    "objectID": "semanas/Aula01.html#quantis",
    "href": "semanas/Aula01.html#quantis",
    "title": "Distribuições de Probabilidade",
    "section": "Quantis",
    "text": "Quantis\n\nqbinom(seq(0.1,0.9,0.1), size = 50, prob=0.30)\n\n[1] 11 12 13 14 15 16 17 18 19"
  },
  {
    "objectID": "semanas/Aula01.html#números-aleatórios",
    "href": "semanas/Aula01.html#números-aleatórios",
    "title": "Distribuições de Probabilidade",
    "section": "Números aleatórios",
    "text": "Números aleatórios\n\nset.seed(22)\nrbinom(50, size = 50, prob=0.3)\n\n [1] 13 15 23 15 18 17 16 17 14 14 21 16 15 18 14 11 14 12 16 14 12 14 15 18 17\n[26] 20 15 24 12 12 12 13 18 12 22  9 18 10 10 15 13 14 15  8 13 12 12 14 13 13"
  },
  {
    "objectID": "semanas/Aula01.html#probabilidades-de-uma-poisson",
    "href": "semanas/Aula01.html#probabilidades-de-uma-poisson",
    "title": "Distribuições de Probabilidade",
    "section": "Probabilidades de uma Poisson",
    "text": "Probabilidades de uma Poisson\n\nx <- 0:6\nplot(x, dpois(x, lambda = 1.9), type=\"h\")"
  },
  {
    "objectID": "semanas/Aula01.html#lei-de-benford",
    "href": "semanas/Aula01.html#lei-de-benford",
    "title": "Distribuições de Probabilidade",
    "section": "Lei de Benford",
    "text": "Lei de Benford\nEm 1996 T.P. Hill mosrou que podemos aproximar as frequencias dos dígitos usando a expressão abaixo.\n\nx <- 1:9\nprob <- log10(1 + 1/x)\nbendford <- data.frame(x=x, prob=prob)\nbendford %>% kbl(digits = 3) %>% kable_minimal()\n\n\n\n \n  \n    x \n    prob \n  \n \n\n  \n    1 \n    0.301 \n  \n  \n    2 \n    0.176 \n  \n  \n    3 \n    0.125 \n  \n  \n    4 \n    0.097 \n  \n  \n    5 \n    0.079 \n  \n  \n    6 \n    0.067 \n  \n  \n    7 \n    0.058 \n  \n  \n    8 \n    0.051 \n  \n  \n    9 \n    0.046"
  },
  {
    "objectID": "semanas/Aula01.html#exemplo-de-distribuição-contínua",
    "href": "semanas/Aula01.html#exemplo-de-distribuição-contínua",
    "title": "Distribuições de Probabilidade",
    "section": "Exemplo de distribuição contínua",
    "text": "Exemplo de distribuição contínua"
  },
  {
    "objectID": "semanas/Aula01.html#distribuição-exponencial",
    "href": "semanas/Aula01.html#distribuição-exponencial",
    "title": "Distribuições de Probabilidade",
    "section": "Distribuição Exponencial",
    "text": "Distribuição Exponencial\nTempo até uma falha\n\nset.seed(22)\ncurve(dexp(x, 4), 0, 2, xlab = \"t\", ylab = \"dexp(t, 4)\")\nx <- seq(0, 0.5, 0.001)\nlines (x, dexp(x, 4), type = \"h\", col=\"grey\") \ntext(0.5, dexp(0.3, 4), expression(P(T <= 0,5)))"
  },
  {
    "objectID": "semanas/Aula01.html#distribuição-normal",
    "href": "semanas/Aula01.html#distribuição-normal",
    "title": "Distribuições de Probabilidade",
    "section": "Distribuição Normal",
    "text": "Distribuição Normal\n\nx <- seq(-3,3,0.1)\nplot(x, dnorm(x, mean=0, sd=1), type=\"l\", xlab = \"Quantis da Normal Padrão\", ylab=\"Densidade de Probabilidade\")"
  },
  {
    "objectID": "semanas/Aula01.html#distribuição-normal-1",
    "href": "semanas/Aula01.html#distribuição-normal-1",
    "title": "Distribuições de Probabilidade",
    "section": "Distribuição Normal",
    "text": "Distribuição Normal\n\nx <- seq(-3,3,0.1)\nplot(x, dnorm(x, mean=0, sd=1), type=\"l\", xlab = \"Quantis da Normal Padrão\", ylab=\"Densidade de Probabilidade\")\ny <- seq(-1, 1, 0.01) \nlines(y, dnorm(y, mean = 0, sd = 1), type = \"h\",\ncol = \"grey\")"
  },
  {
    "objectID": "semanas/Aula01.html#função-distribuição-acumulada",
    "href": "semanas/Aula01.html#função-distribuição-acumulada",
    "title": "Distribuições de Probabilidade",
    "section": "Função distribuição acumulada",
    "text": "Função distribuição acumulada\n\nprob_acum <- pnorm(x, mean=0, sd=1)\nplot(x, prob_acum, xlab = \"Quantis da Normal Padrão\",\nylab = \"FDA (P(X<=x))\", type = \"l\")"
  },
  {
    "objectID": "semanas/Aula01.html#quantil-da-normal",
    "href": "semanas/Aula01.html#quantil-da-normal",
    "title": "Distribuições de Probabilidade",
    "section": "Quantil da Normal",
    "text": "Quantil da Normal\n\nqnorm(c(0.25,0.5,0.75,0.95), mean=0, sd=1)\n\n[1] -0.6744898  0.0000000  0.6744898  1.6448536\n\nqnorm(c(0.95,0.975,0.99), mean=0, sd=1)\n\n[1] 1.644854 1.959964 2.326348"
  },
  {
    "objectID": "semanas/Aula01.html#números-aleatórios-1",
    "href": "semanas/Aula01.html#números-aleatórios-1",
    "title": "Distribuições de Probabilidade",
    "section": "Números Aleatórios",
    "text": "Números Aleatórios\n\nset.seed(22)\nrnorm(10, mean=0,sd=1)\n\n [1] -0.51213909  2.48518368  1.00782615  0.29281457 -0.20895936  1.85809239\n [7] -0.06602641 -0.16276495 -0.19986068  0.30056173"
  },
  {
    "objectID": "semanas/Aula01.html#gráfico-qq-normal",
    "href": "semanas/Aula01.html#gráfico-qq-normal",
    "title": "Distribuições de Probabilidade",
    "section": "Gráfico QQ Normal",
    "text": "Gráfico QQ Normal\n\nset.seed(22)\nx <- rnorm(30, mean = 10, sd=1)\nqqnorm(x)\nqqline(x)"
  },
  {
    "objectID": "semanas/Aula01.html#gráfico-qq-normal-1",
    "href": "semanas/Aula01.html#gráfico-qq-normal-1",
    "title": "Distribuições de Probabilidade",
    "section": "Gráfico QQ Normal",
    "text": "Gráfico QQ Normal\n\nset.seed(22)\nx <- rnorm(100, mean = 10, sd=1)\nqqnorm(x)\nqqline(x)"
  },
  {
    "objectID": "semanas/Aula01.html#gráfico-qq-normal-2",
    "href": "semanas/Aula01.html#gráfico-qq-normal-2",
    "title": "Distribuições de Probabilidade",
    "section": "Gráfico QQ Normal",
    "text": "Gráfico QQ Normal\n\nset.seed(22)\nx <- rnorm(1000, mean = 10, sd=1)\nqqnorm(x)\nqqline(x)"
  },
  {
    "objectID": "semanas/Aula01.html#como-fica-a-exponencial",
    "href": "semanas/Aula01.html#como-fica-a-exponencial",
    "title": "Distribuições de Probabilidade",
    "section": "Como fica a exponencial?",
    "text": "Como fica a exponencial?\n\nset.seed(22)\nx <- rexp(100, rate=2)\nqqnorm(x)\nqqline(x)"
  },
  {
    "objectID": "semanas/Aula01.html#como-fica-a-t",
    "href": "semanas/Aula01.html#como-fica-a-t",
    "title": "Distribuições de Probabilidade",
    "section": "Como fica a t?",
    "text": "Como fica a t?\n\nset.seed(22)\nx <- rt(100, df=2)\nqqnorm(x)\nqqline(x)"
  },
  {
    "objectID": "semanas/Aula01.html#como-fica-a-t-1",
    "href": "semanas/Aula01.html#como-fica-a-t-1",
    "title": "Distribuições de Probabilidade",
    "section": "Como fica a t?",
    "text": "Como fica a t?\n\nx <- rt(100, df=5)\nqqnorm(x)\nqqline(x)"
  },
  {
    "objectID": "semanas/Aula01.html#como-fica-a-t-2",
    "href": "semanas/Aula01.html#como-fica-a-t-2",
    "title": "Distribuições de Probabilidade",
    "section": "Como fica a t",
    "text": "Como fica a t\n\nx <- seq(-3,3,0.1)\ncurve(dt(x, df=2), -3, 3, xlab = \"\", ylab = \"Densidade de Probabilidade\", col=1, ylim=c(0,0.5))\ncurve(dnorm(x, mean=0, sd=1), -3, 3, col=2, add=TRUE)\nlegend(1,0.5, c(\"t\", \"Normal\"), col=1:2, lty = 1)"
  },
  {
    "objectID": "semanas/Aula01.html#outro-gráfico-qq",
    "href": "semanas/Aula01.html#outro-gráfico-qq",
    "title": "Distribuições de Probabilidade",
    "section": "Outro gráfico QQ",
    "text": "Outro gráfico QQ\n\nlibrary(car)\n\nCarregando pacotes exigidos: carData\n\n\n\nAttaching package: 'car'\n\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\n\nThe following object is masked from 'package:purrr':\n\n    some\n\nset.seed(22)\nx <- rt(100, df=5)\nqqPlot(x, distribution=\"norm\")\n\n\n\n\n[1] 35 18\n\nqqPlot(x, distribution=\"t\", df=5)\n\n\n\n\n[1] 35 18"
  },
  {
    "objectID": "semanas/Aula01.html#como-fica-a-lognormal",
    "href": "semanas/Aula01.html#como-fica-a-lognormal",
    "title": "Distribuições de Probabilidade",
    "section": "Como fica a Lognormal?",
    "text": "Como fica a Lognormal?\n\nx <- rlnorm(100, meanlog = 0, sdlog = 1)\nqqnorm(x)\nqqline(x)"
  },
  {
    "objectID": "semanas/Aula02.html",
    "href": "semanas/Aula02.html",
    "title": "Probabilidade Parte 2",
    "section": "",
    "text": "library(tidyverse)\nlibrary(kableExtra)\n\n# parametros para o ggplot2\nggplot2::theme_set(ggplot2::theme_minimal(base_size = 16))\n\n# parametros para imagens\nknitr::opts_chunk$set(\n  fig.width = 8,\n  fig.asp = 0.618,\n  fig.retina = 3,\n  dpi = 300,\n  out.width = \"80%\"\n)"
  },
  {
    "objectID": "semanas/Aula02.html#desigualdade-de-markov",
    "href": "semanas/Aula02.html#desigualdade-de-markov",
    "title": "Probabilidade Parte 2",
    "section": "Desigualdade de Markov",
    "text": "Desigualdade de Markov\n\\begin{aligned} \\color{black}{\\mathbf{P(X>=t)}} &<= \\color{black}{\\frac{E(X)}{t}} \\end{aligned}\nUm fabricante sabe que a média do diametro de um produto é 10 mm. Ele quer estimar a proporçaõ de produtos que serão maiores ou iguais a 20 mm.\n\\begin{aligned} \\color{black}{\\mathbf{P(X>=20)}} &<= \\color{black}{\\frac{10}{20}} = \\color{black}{\\frac{1}{2}} \\end{aligned}\nVamos supor que os diametros sejam normalmente distribuídos. Como seria a probabilidade acima, considerando vários valores de desvio padrão?\n\nsd <- seq(1, 100, 5)\nplot(sd, 1 - pnorm(20, 10, sd), ylim = c(0, 1),\nxlab = \"Desvio Padrão\", ylab = \"P(X >= 20)\")\nabline (h = 10/20)\ntext(50, 0.55, \"Limite de Markov\")"
  },
  {
    "objectID": "semanas/Aula02.html#normal-bivariada",
    "href": "semanas/Aula02.html#normal-bivariada",
    "title": "Probabilidade Parte 2",
    "section": "Normal Bivariada",
    "text": "Normal Bivariada\n\nlibrary(mvtnorm)\n\n# Matriz de covariâncias\nsigma <- matrix(c(1, 0.5, 0.5, 1), 2, 2)\n\n## Valores de x e y \nx <- seq(-4, 4, length=25)\ny <- seq(-4, 4, length=25)\n\n# Função para avaliar a densidade da normal bivariada\nbv.norm <- function(x, y, sigma) {\n  z <- cbind(x,y)\n  return(dmvnorm(z, sigma=sigma))\n}\n# Usando outer para avaliar a fdp num grid de valores x e y\nfxy <- outer(x, y, bv.norm, sigma)\n\n# Criando o gráfico 3D\npersp(x, y, fxy, theta=60, phi=20, expand=0.4, ticktype=\"detailed\", \n      zlab=\"\",col=\"grey\", cex.lab=1)"
  },
  {
    "objectID": "semanas/Aula02.html#t-bivariada",
    "href": "semanas/Aula02.html#t-bivariada",
    "title": "Probabilidade Parte 2",
    "section": "t Bivariada",
    "text": "t Bivariada\n\n#library(mvtnorm)\n\n# Matriz de covariâncias\nsigma <- matrix(c(1, 0.5, 0.5, 1), 2, 2)\n\n## Valores de x e y \nx <- seq(-4, 4, length=25)\ny <- seq(-4, 4, length=25)\n\n\n# Função para avaliar a densidade da normal bivariada\nbv.t <- function(x, y, sigma) {\n  z <- cbind(x,y)\n  return(dmvt(z, sigma=sigma))\n}\n# Usando outer para avaliar a fdp num grid de valores x e y\nfxy <- outer(x, y, bv.t, sigma)\n\n# Criando o gráfico 3D\npersp(x, y, fxy, theta=40, phi=30, expand=0.5, ticktype=\"detailed\", \n      zlab=\"\",col=\"grey\", cex.lab=1)"
  },
  {
    "objectID": "semanas/Aula03.html",
    "href": "semanas/Aula03.html",
    "title": "Inferência",
    "section": "",
    "text": "library(tidyverse)\nlibrary(kableExtra)\n\n\n# parametros para o ggplot2\nggplot2::theme_set(ggplot2::theme_minimal(base_size = 16))\n\n# parametros para imagens\nknitr::opts_chunk$set(\n  fig.width = 8,\n  fig.asp = 0.618,\n  fig.retina = 3,\n  dpi = 300,\n  out.width = \"80%\"\n)"
  },
  {
    "objectID": "semanas/Aula03.html#população",
    "href": "semanas/Aula03.html#população",
    "title": "Inferência",
    "section": "População",
    "text": "População\nVamos supor que nossa população (universo) seja composto de 1000 valores aleatórios gerados a partir de uma normal padrão.\n\nset.seed(123)\npopulacao <- rnorm(1000,0,1)\nsummary(populacao)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-2.80978 -0.62832  0.00921  0.01613  0.66460  3.24104"
  },
  {
    "objectID": "semanas/Aula03.html#amostras",
    "href": "semanas/Aula03.html#amostras",
    "title": "Inferência",
    "section": "Amostras",
    "text": "Amostras\n\nset.seed(125)\namostra1 <- sample(populacao, size=30)\nset.seed(126)\namostra2 <- sample(populacao, size=30)\nset.seed(127)\namostra3 <- sample(populacao, size=30)\nset.seed(128)\namostra4 <- sample(populacao, size=30)\namostras <- cbind(amostra1, amostra2, amostra3, amostra4)\n# amostras\nmedias <- colMeans(amostras)\ndesvios <- apply(amostras, 2,sd)\nic.i <- medias - 1.96*desvios\nic.s <- medias + 1.96*desvios\nnames(desvios) <- c(\"dp1\", \"dp2\", \"dp3\", \"dp4\")\nknitr::kable(cbind(medias,desvios, ic.i, ic.s), digits = 3)\n\n\n\n \n  \n      \n    medias \n    desvios \n    ic.i \n    ic.s \n  \n \n\n  \n    amostra1 \n    0.087 \n    1.066 \n    -2.002 \n    2.176 \n  \n  \n    amostra2 \n    -0.029 \n    1.158 \n    -2.298 \n    2.240 \n  \n  \n    amostra3 \n    -0.160 \n    0.883 \n    -1.890 \n    1.571 \n  \n  \n    amostra4 \n    0.135 \n    0.708 \n    -1.253 \n    1.523"
  },
  {
    "objectID": "semanas/Aula03.html#amostras-1",
    "href": "semanas/Aula03.html#amostras-1",
    "title": "Inferência",
    "section": "Amostras",
    "text": "Amostras\n\nset.seed(125)\namostra1 <- sample(populacao, size=100)\nset.seed(126)\namostra2 <- sample(populacao, size=100)\nset.seed(127)\namostra3 <- sample(populacao, size=100)\nset.seed(128)\namostra4 <- sample(populacao, size=100)\namostras <- cbind(amostra1, amostra2, amostra3, amostra4)\nmedias <- colMeans(amostras)\ndesvios <- apply(amostras, 2,sd)\nic.i <- medias - 1.96*desvios\nic.s <- medias + 1.96*desvios\nnames(desvios) <- c(\"dp1\", \"dp2\", \"dp3\", \"dp4\")\nknitr::kable(cbind(medias,desvios, ic.i, ic.s), digits = 3)\n\n\n\n \n  \n      \n    medias \n    desvios \n    ic.i \n    ic.s \n  \n \n\n  \n    amostra1 \n    0.033 \n    1.004 \n    -1.935 \n    2.000 \n  \n  \n    amostra2 \n    0.091 \n    0.995 \n    -1.859 \n    2.041 \n  \n  \n    amostra3 \n    0.084 \n    0.922 \n    -1.724 \n    1.891 \n  \n  \n    amostra4 \n    -0.069 \n    0.917 \n    -1.866 \n    1.728"
  },
  {
    "objectID": "semanas/Aula03.html#preparando-simulação",
    "href": "semanas/Aula03.html#preparando-simulação",
    "title": "Inferência",
    "section": "Preparando simulação",
    "text": "Preparando simulação\n\ndef.par <- par(no.readonly = TRUE) # salvando configuração\n\nn=cbind(c(3, 10, 30), # tamanho de amostras para os gráficos 1ª distribuição\n        c(3, 10, 30), # tamanho de amostras para os gráficos 2ª distribuição\n        c(3, 10, 30), # tamanho de amostras para os gráficos 3ª distribuição\n        c(3, 10, 30)) # tamanho de amostras para os gráficos 4ª distribuição\nX<-list(\n  x1 = matrix(NA,nrow=200,ncol=3), # Matriz que armazenara as médias da primeira dist\n  x2 = matrix(NA,nrow=200,ncol=3), # Matriz que armazenara as médias da segunda dist\n  x3 = matrix(NA,nrow=200,ncol=3), # Matriz que armazenara as médias da terceira dist\n  x4 = matrix(NA,nrow=200,ncol=3)) # Matriz que armazenara as médias da quarta dist\n\nset.seed(123)\n\nfor ( i in 1:3){  # iterando ao longo do tamanho de amostras de cada linha\n  for ( j in 1: 200){  # Construindo 200 observacoes para cada gráfico  \n    X$x1[j,i] <-  mean( runif( n=n[i,1])) \n    # Calculando a média para cada uma das 200 simulacoes de uma distribuicao uniforme\n    X$x2[j,i] <-  mean(  rexp( n=n[i,2], rate=2)) \n    # Calculando a média para cada uma das 200 simulacoes de uma distribuicao                exponencial\n    X$x3[j,i] <-  mean(rchisq( n=n[i,3], df=1)) \n    # Calculando a média para cada uma das 200 simulacoes de uma distribuicao                 qui-quadrado\n    X$x4[j,i] <-  mean( rbeta( n=n[i,4], shape1 = .2, shape2 = .2)) \n    # Calculando a média para cada uma das 200 simulacoes de uma distribuicao beta\n  }\n}"
  },
  {
    "objectID": "semanas/Aula03.html#resultado-das-simulações",
    "href": "semanas/Aula03.html#resultado-das-simulações",
    "title": "Inferência",
    "section": "Resultado das Simulações",
    "text": "Resultado das Simulações\nApresentação das 200 simulações das distribuições uniforme, exponencial, Chiquadrado e beta para os tamanhos de amostras n= 3, 10 e 30"
  },
  {
    "objectID": "semanas/Aula03.html#distribuição-uniforme",
    "href": "semanas/Aula03.html#distribuição-uniforme",
    "title": "Inferência",
    "section": "Distribuição Uniforme",
    "text": "Distribuição Uniforme\n\nlayout(rbind(c(1,2,3,4)))\nplot(dunif(x = seq(0,1,0.05)),type=\"l\", ylab=\"f(x)\", main=\"fdp-Uniforme(0,1)\", xlab=\"X\")\nhist(X$x1[,1], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[1,1]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x1[,2], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[2,1]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x1[,3], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[3,1]), freq = FALSE, xlab=\"X_bar\")"
  },
  {
    "objectID": "semanas/Aula03.html#distribuição-exponencial",
    "href": "semanas/Aula03.html#distribuição-exponencial",
    "title": "Inferência",
    "section": "Distribuição exponencial",
    "text": "Distribuição exponencial\n\nlayout(rbind(c(1,2,3,4)))\nplot(dexp(x = seq(0,1,0.05),rate=2),type=\"l\", ylab=\"f(x)\", main=\"fdp-Exponencial(1/2)\", xlab=\"X\")\nhist(X$x2[,1], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[1,2]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x2[,2], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[2,2]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x2[,3], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[3,2]), freq = FALSE, xlab=\"X_bar\")"
  },
  {
    "objectID": "semanas/Aula03.html#distribuição-chi-quadrado",
    "href": "semanas/Aula03.html#distribuição-chi-quadrado",
    "title": "Inferência",
    "section": "Distribuição Chi-Quadrado",
    "text": "Distribuição Chi-Quadrado\n\nlayout(rbind(c(1,2,3,4)))\nplot(dchisq(x = seq(0,1,0.05),df=1),type=\"l\", ylab=\"f(x)\", main=\"fdp-QuiQuad(1)\", xlab=\"X\")\nhist(X$x3[,1], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[1,3]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x3[,2], col = \"lightblue3\", border = \"dark gray\",\n     main = paste(\"n = \", n[2,3]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x3[,3], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[3,3]), freq = FALSE, xlab=\"X_bar\")"
  },
  {
    "objectID": "semanas/Aula03.html#distribuição-beta",
    "href": "semanas/Aula03.html#distribuição-beta",
    "title": "Inferência",
    "section": "Distribuição Beta",
    "text": "Distribuição Beta\n\nlayout(rbind(c(1,2,3,4)))\nplot(dbeta(x = seq(0,1,0.05), shape1 = .2, shape2 = .2),type=\"l\", ylab=\"f(x)\", main=\"fdp-Beta(0.2, 0.2)\", xlab=\"X\")\nhist(X$x4[,1], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[1,4]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x4[,2], col = \"lightblue3\", border = \"dark gray\", \n     main = paste(\"n = \", n[2,4]), freq = FALSE, xlab=\"X_bar\")\nhist(X$x4[,3], col = \"lightblue3\", border = \"dark gray\",\n     main = paste(\"n = \", n[3,4]), freq = FALSE, xlab=\"X_bar\")\n\n\n\n\n\npar(def.par)  # restaurando"
  },
  {
    "objectID": "semanas/Aula03.html#reamostragem",
    "href": "semanas/Aula03.html#reamostragem",
    "title": "Inferência",
    "section": "Reamostragem",
    "text": "Reamostragem\n\n# Intervalos de Confiança Bootstrap\nlibrary(boot)\nset.seed(123)\ndados1 <- rnorm(n=100, mean = 5, sd = 1)\nsummary(dados1)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  2.691   4.506   5.062   5.090   5.692   7.187 \n\nbootMediana <- function(dados, indices) median(dados[indices])\nb <- boot(dados1, bootMediana, R = 1000)\nb\n\n\nORDINARY NONPARAMETRIC BOOTSTRAP\n\n\nCall:\nboot(data = dados1, statistic = bootMediana, R = 1000)\n\n\nBootstrap Statistics :\n    original      bias    std. error\nt1* 5.061756 -0.01277126   0.1315266\n\nplot(b)\n\n\n\nboot.ci(b, conf=0.95, type = c(\"norm\", \"basic\", \"perc\", \"bca\"))\n\nBOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS\nBased on 1000 bootstrap replicates\n\nCALL : \nboot.ci(boot.out = b, conf = 0.95, type = c(\"norm\", \"basic\", \n    \"perc\", \"bca\"))\n\nIntervals : \nLevel      Normal              Basic         \n95%   ( 4.817,  5.332 )   ( 4.806,  5.344 )  \n\nLevel     Percentile            BCa          \n95%   ( 4.780,  5.318 )   ( 4.777,  5.278 )  \nCalculations and Intervals on Original Scale"
  },
  {
    "objectID": "semanas/Aula04.html",
    "href": "semanas/Aula04.html",
    "title": "Regressão Linear",
    "section": "",
    "text": "library(tidyverse)\nlibrary(kableExtra)\n\n# parametros para imagens\nknitr::opts_chunk$set(\n  fig.width = 8,\n  fig.asp = 0.73,\n  fig.retina = 3,\n  dpi = 300,\n  out.width = \"90%\"\n)"
  },
  {
    "objectID": "semanas/Aula04.html#explorando-os-dados",
    "href": "semanas/Aula04.html#explorando-os-dados",
    "title": "Regressão Linear",
    "section": "Explorando os dados",
    "text": "Explorando os dados"
  },
  {
    "objectID": "semanas/Aula04.html#anscombe",
    "href": "semanas/Aula04.html#anscombe",
    "title": "Regressão Linear",
    "section": "Anscombe",
    "text": "Anscombe\n\nanscombe <- read.table(\"anscombe.txt\",header=TRUE)\nattach(anscombe)\npar(mfrow=c(2,2))\nplot(x1,y1,xlim=c(4,20),ylim=c(3,14),main=\"Dados  1\")\nabline(lsfit(x1,y1))\nplot(x2,y2,xlim=c(4,20),ylim=c(3,14),main=\"Dados 2\")\nabline(lsfit(x2,y2))\nplot(x3,y3,xlim=c(4,20),ylim=c(3,14),main=\"Dados 3\")\nabline(lsfit(x3,y3))\nplot(x4,y4,xlim=c(4,20),ylim=c(3,14),main=\"Dados 4\")\nabline(lsfit(x4,y4))\n\n\n\n\n\nm1 <- lm(y1~x1)\nm2 <- lm(y2~x2)\nm3 <- lm(y3~x3)\nm4 <- lm(y4~x4)\nmodelos <- rbind(coef(m1),coef(m2),coef(m3),coef(m4))\ncolnames(modelos) <- c(\"Intercept\", \"x\") \nmodelos\n\n     Intercept         x\n[1,]  3.000091 0.5000909\n[2,]  3.000909 0.5000000\n[3,]  3.002455 0.4997273\n[4,]  3.001727 0.4999091"
  },
  {
    "objectID": "semanas/Aula04.html#dados-de-propaganda",
    "href": "semanas/Aula04.html#dados-de-propaganda",
    "title": "Regressão Linear",
    "section": "Dados de propaganda",
    "text": "Dados de propaganda\nO conjunto de dados contém estatísticas sobre as vendas de um produto em 200 diferentes mercados, juntamente com orçamentos publicitários em cada um desses mercados, para diferentes canais de mídia: TV, rádio e jornal. As vendas estão em milhares de unidades e o orçamento está em milhares de dólares. Os dados são oriundo do livro Introduction to Statistical Learning.\n\nlibrary(readxl)\npropaganda <- read_excel(\"Propaganda.xlsx\")\nsummary(propaganda)\n\n       TV             Radio          Newspaper          Sales      \n Min.   :  0.70   Min.   : 0.000   Min.   :  0.30   Min.   : 1.60  \n 1st Qu.: 74.38   1st Qu.: 9.975   1st Qu.: 12.75   1st Qu.:10.38  \n Median :149.75   Median :22.900   Median : 25.75   Median :12.90  \n Mean   :147.04   Mean   :23.264   Mean   : 30.55   Mean   :14.02  \n 3rd Qu.:218.82   3rd Qu.:36.525   3rd Qu.: 45.10   3rd Qu.:17.40  \n Max.   :296.40   Max.   :49.600   Max.   :114.00   Max.   :27.00"
  },
  {
    "objectID": "semanas/Aula04.html#renomeando",
    "href": "semanas/Aula04.html#renomeando",
    "title": "Regressão Linear",
    "section": "Renomeando",
    "text": "Renomeando\n\npropaganda <- propaganda %>% rename(Jornal = Newspaper, Vendas = Sales)"
  },
  {
    "objectID": "semanas/Aula04.html#sumario",
    "href": "semanas/Aula04.html#sumario",
    "title": "Regressão Linear",
    "section": "Sumario",
    "text": "Sumario\n\nsummary(propaganda)\n\n       TV             Radio            Jornal           Vendas     \n Min.   :  0.70   Min.   : 0.000   Min.   :  0.30   Min.   : 1.60  \n 1st Qu.: 74.38   1st Qu.: 9.975   1st Qu.: 12.75   1st Qu.:10.38  \n Median :149.75   Median :22.900   Median : 25.75   Median :12.90  \n Mean   :147.04   Mean   :23.264   Mean   : 30.55   Mean   :14.02  \n 3rd Qu.:218.82   3rd Qu.:36.525   3rd Qu.: 45.10   3rd Qu.:17.40  \n Max.   :296.40   Max.   :49.600   Max.   :114.00   Max.   :27.00  \n\nnrow(propaganda)\n\n[1] 200"
  },
  {
    "objectID": "semanas/Aula04.html#linhas-inicias",
    "href": "semanas/Aula04.html#linhas-inicias",
    "title": "Regressão Linear",
    "section": "Linhas inicias",
    "text": "Linhas inicias\n\nlibrary(gt)\ngt(head(propaganda, 10))\n\n\n\n\n\n  \n  \n    \n      TV\n      Radio\n      Jornal\n      Vendas\n    \n  \n  \n    230.1\n37.8\n69.2\n22.1\n    44.5\n39.3\n45.1\n10.4\n    17.2\n45.9\n69.3\n9.3\n    151.5\n41.3\n58.5\n18.5\n    180.8\n10.8\n58.4\n12.9\n    8.7\n48.9\n75.0\n7.2\n    57.5\n32.8\n23.5\n11.8\n    120.2\n19.6\n11.6\n13.2\n    8.6\n2.1\n1.0\n4.8\n    199.8\n2.6\n21.2\n10.6"
  },
  {
    "objectID": "semanas/Aula04.html#estatísticas-descritivas",
    "href": "semanas/Aula04.html#estatísticas-descritivas",
    "title": "Regressão Linear",
    "section": "Estatísticas descritivas",
    "text": "Estatísticas descritivas\n\nlibrary(psych)\n\n\nAttaching package: 'psych'\n\n\nThe following objects are masked from 'package:ggplot2':\n\n    %+%, alpha\n\ndescribe(propaganda)\n\n       vars   n   mean    sd median trimmed    mad min   max range  skew\nTV        1 200 147.04 85.85 149.75  147.20 108.82 0.7 296.4 295.7 -0.07\nRadio     2 200  23.26 14.85  22.90   23.00  19.79 0.0  49.6  49.6  0.09\nJornal    3 200  30.55 21.78  25.75   28.41  23.13 0.3 114.0 113.7  0.88\nVendas    4 200  14.02  5.22  12.90   13.78   4.82 1.6  27.0  25.4  0.40\n       kurtosis   se\nTV        -1.24 6.07\nRadio     -1.28 1.05\nJornal     0.57 1.54\nVendas    -0.45 0.37"
  },
  {
    "objectID": "semanas/Aula04.html#histogramas",
    "href": "semanas/Aula04.html#histogramas",
    "title": "Regressão Linear",
    "section": "Histogramas",
    "text": "Histogramas\n\npar(mfrow = c(2, 2))\nhist(propaganda$TV,breaks=\"Sturges\", main=\"TV - Regra de Sturges\")\nhist(propaganda$Radio,breaks=\"Sturges\", main=\"Radio - Regra de Sturges\")\nhist(propaganda$Jornal, breaks=\"Sturges\", main=\"Jornal - Regra de Sturges\")\nhist(propaganda$Vendas, breaks=\"Sturges\", main=\"Vendas - Regra de Sturges\")\n\n\n\npar(mfrow = c(1, 1))"
  },
  {
    "objectID": "semanas/Aula04.html#grafico-de-densidade",
    "href": "semanas/Aula04.html#grafico-de-densidade",
    "title": "Regressão Linear",
    "section": "Grafico de Densidade",
    "text": "Grafico de Densidade\n\nlibrary(patchwork)\ng1 <- ggplot(propaganda, aes(TV)) + geom_density()\ng2 <- ggplot(propaganda, aes(Radio)) + geom_density()\ng3 <- ggplot(propaganda, aes(Jornal)) + geom_density()\ng4 <- ggplot(propaganda, aes(Vendas)) + geom_density()\n(g1 + g2)/(g3 + g4)"
  },
  {
    "objectID": "semanas/Aula04.html#box-plot",
    "href": "semanas/Aula04.html#box-plot",
    "title": "Regressão Linear",
    "section": "Box-Plot",
    "text": "Box-Plot\n\nlibrary(caret)\n\nCarregando pacotes exigidos: lattice\n\n\n\nAttaching package: 'caret'\n\n\nThe following object is masked from 'package:purrr':\n\n    lift\n\nfeaturePlot(x = propaganda[ , c(\"TV\", \"Radio\", \"Jornal\")], y=factor(rep(\"Midia\",200)), \"box\")"
  },
  {
    "objectID": "semanas/Aula04.html#grafico-de-dispersão",
    "href": "semanas/Aula04.html#grafico-de-dispersão",
    "title": "Regressão Linear",
    "section": "Grafico de Dispersão",
    "text": "Grafico de Dispersão\n\nfeaturePlot(x = propaganda[ , c(\"TV\", \"Radio\", \"Jornal\")], y = propaganda$Vendas)"
  },
  {
    "objectID": "semanas/Aula04.html#matriz-de-dispersão",
    "href": "semanas/Aula04.html#matriz-de-dispersão",
    "title": "Regressão Linear",
    "section": "Matriz de dispersão",
    "text": "Matriz de dispersão\n\npairs.panels(propaganda) \n\n\n\n\n\nlibrary(GGally)\n\nRegistered S3 method overwritten by 'GGally':\n  method from   \n  +.gg   ggplot2\n\nggpairs(propaganda)"
  },
  {
    "objectID": "semanas/Aula04.html#correlações",
    "href": "semanas/Aula04.html#correlações",
    "title": "Regressão Linear",
    "section": "Correlações",
    "text": "Correlações\n\nmcorr <- cor(propaganda)\nlibrary(corrplot)\n\ncorrplot 0.92 loaded\n\ncorrplot(mcorr)\n\n\n\ncorrplot(mcorr,method = \"number\")"
  },
  {
    "objectID": "semanas/Aula04.html#criando-amostra-de-treino-e-teste",
    "href": "semanas/Aula04.html#criando-amostra-de-treino-e-teste",
    "title": "Regressão Linear",
    "section": "Criando amostra de treino e teste",
    "text": "Criando amostra de treino e teste\n\nlibrary(caret)\nset.seed(21)\ny <- propaganda$Vendas\nindice_teste <- createDataPartition(y, times = 1, p = 0.20, list = FALSE)\n\nconj_treino <- propaganda %>% slice(-indice_teste)\nconj_teste <- propaganda %>% slice(indice_teste)\n\nstr(conj_treino)\n\ntibble [159 × 4] (S3: tbl_df/tbl/data.frame)\n $ TV    : num [1:159] 17.2 151.5 8.7 120.2 199.8 ...\n $ Radio : num [1:159] 45.9 41.3 48.9 19.6 2.6 5.8 24 35.1 7.6 32.9 ...\n $ Jornal: num [1:159] 69.3 58.5 75 11.6 21.2 24.2 4 65.9 7.2 46 ...\n $ Vendas: num [1:159] 9.3 18.5 7.2 13.2 10.6 8.6 17.4 9.2 9.7 19 ...\n\nstr(conj_teste)\n\ntibble [41 × 4] (S3: tbl_df/tbl/data.frame)\n $ TV    : num [1:41] 230.1 44.5 180.8 57.5 8.6 ...\n $ Radio : num [1:41] 37.8 39.3 10.8 32.8 2.1 39.6 23.9 3.5 28.3 17.4 ...\n $ Jornal: num [1:41] 69.2 45.1 58.4 23.5 1 55.8 19.1 19.5 43.2 38.6 ...\n $ Vendas: num [1:41] 22.1 10.4 12.9 11.8 4.8 24.4 14.6 12 21.4 11.9 ...\n\ngt(head(conj_treino, 10))\n\n\n\n\n\n  \n  \n    \n      TV\n      Radio\n      Jornal\n      Vendas\n    \n  \n  \n    17.2\n45.9\n69.3\n9.3\n    151.5\n41.3\n58.5\n18.5\n    8.7\n48.9\n75.0\n7.2\n    120.2\n19.6\n11.6\n13.2\n    199.8\n2.6\n21.2\n10.6\n    66.1\n5.8\n24.2\n8.6\n    214.7\n24.0\n4.0\n17.4\n    23.8\n35.1\n65.9\n9.2\n    97.5\n7.6\n7.2\n9.7\n    204.1\n32.9\n46.0\n19.0"
  },
  {
    "objectID": "semanas/Aula04.html#regressão-simples-vendas-sim-tv",
    "href": "semanas/Aula04.html#regressão-simples-vendas-sim-tv",
    "title": "Regressão Linear",
    "section": "Regressão Simples \\(Vendas \\sim TV\\)",
    "text": "Regressão Simples \\(Vendas \\sim TV\\)\n\nmod1 <- lm( Vendas ~ TV, data = conj_treino)"
  },
  {
    "objectID": "semanas/Aula04.html#informações-do-ajuste-e-resultados",
    "href": "semanas/Aula04.html#informações-do-ajuste-e-resultados",
    "title": "Regressão Linear",
    "section": "Informações do ajuste e Resultados",
    "text": "Informações do ajuste e Resultados\n\nnames(mod1)\n\n [1] \"coefficients\"  \"residuals\"     \"effects\"       \"rank\"         \n [5] \"fitted.values\" \"assign\"        \"qr\"            \"df.residual\"  \n [9] \"xlevels\"       \"call\"          \"terms\"         \"model\"        \n\nsummary(mod1)\n\n\nCall:\nlm(formula = Vendas ~ TV, data = conj_treino)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-7.8261 -1.7616 -0.0599  1.8989  7.3220 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  7.21359    0.50614   14.25   <2e-16 ***\nTV           0.04614    0.00301   15.33   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.158 on 157 degrees of freedom\nMultiple R-squared:  0.5995,    Adjusted R-squared:  0.5969 \nF-statistic:   235 on 1 and 157 DF,  p-value: < 2.2e-16\n\nsum_mod1 <- summary(mod1)\nnames(sum_mod1)\n\n [1] \"call\"          \"terms\"         \"residuals\"     \"coefficients\" \n [5] \"aliased\"       \"sigma\"         \"df\"            \"r.squared\"    \n [9] \"adj.r.squared\" \"fstatistic\"    \"cov.unscaled\""
  },
  {
    "objectID": "semanas/Aula04.html#outras-informações-do-ajuste",
    "href": "semanas/Aula04.html#outras-informações-do-ajuste",
    "title": "Regressão Linear",
    "section": "Outras informações do Ajuste",
    "text": "Outras informações do Ajuste\n\nsum_mod1$sigma\n\n[1] 3.15769\n\nsum_mod1$r.squared\n\n[1] 0.5994649"
  },
  {
    "objectID": "semanas/Aula04.html#gráfico-da-regressão",
    "href": "semanas/Aula04.html#gráfico-da-regressão",
    "title": "Regressão Linear",
    "section": "Gráfico da Regressão",
    "text": "Gráfico da Regressão\n\ncoeflinear <- mod1$coefficients[1]\ncoefang <- mod1$coefficients[2]\nggplot(conj_treino, aes(x=TV, y=Vendas)) +\n    geom_point() +\n    geom_abline(slope = coefang,intercept = coeflinear, color=\"blue\" ) + \n    geom_hline(yintercept=coeflinear, linetype=\"dashed\", color = \"red\")"
  },
  {
    "objectID": "semanas/Aula04.html#gráfico-da-regressão-1",
    "href": "semanas/Aula04.html#gráfico-da-regressão-1",
    "title": "Regressão Linear",
    "section": "Gráfico da Regressão",
    "text": "Gráfico da Regressão\n\nlibrary(car)\nscatterplot(Vendas ~ TV, data = conj_treino, smooth=F)"
  },
  {
    "objectID": "semanas/Aula04.html#intervalo-de-confiança-para-beta_0-e-beta_1",
    "href": "semanas/Aula04.html#intervalo-de-confiança-para-beta_0-e-beta_1",
    "title": "Regressão Linear",
    "section": "Intervalo de Confiança para \\(\\beta_0\\) e \\(\\beta_1\\)",
    "text": "Intervalo de Confiança para \\(\\beta_0\\) e \\(\\beta_1\\)\n\nconfint(mod1, level=0.95)\n\n                 2.5 %     97.5 %\n(Intercept) 6.21386581 8.21330660\nTV          0.04019365 0.05208397"
  },
  {
    "objectID": "semanas/Aula04.html#previsões",
    "href": "semanas/Aula04.html#previsões",
    "title": "Regressão Linear",
    "section": "Previsões",
    "text": "Previsões\n\npredict(mod1, data.frame(TV=c(50, 150, 250)), interval = \"prediction\")\n\n        fit       lwr      upr\n1  9.520527  3.237859 15.80319\n2 14.134407  7.877747 20.39107\n3 18.748288 12.461271 25.03530"
  },
  {
    "objectID": "semanas/Aula04.html#anova",
    "href": "semanas/Aula04.html#anova",
    "title": "Regressão Linear",
    "section": "ANOVA",
    "text": "ANOVA\n\nanova(mod1)\n\nAnalysis of Variance Table\n\nResponse: Vendas\n           Df Sum Sq Mean Sq F value    Pr(>F)    \nTV          1 2342.9 2342.94  234.98 < 2.2e-16 ***\nResiduals 157 1565.5    9.97                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "semanas/Aula04.html#analisando-os-resíduos",
    "href": "semanas/Aula04.html#analisando-os-resíduos",
    "title": "Regressão Linear",
    "section": "Analisando os Resíduos",
    "text": "Analisando os Resíduos\n\npar(mfrow = c(2, 2))\nplot(mod1)\n\n\n\npar(mfrow = c(1, 1))"
  },
  {
    "objectID": "semanas/Aula04.html#verificando-independencia-dos-resíduos",
    "href": "semanas/Aula04.html#verificando-independencia-dos-resíduos",
    "title": "Regressão Linear",
    "section": "Verificando Independencia dos Resíduos",
    "text": "Verificando Independencia dos Resíduos\n\nlibrary(lmtest)\n\nCarregando pacotes exigidos: zoo\n\n\n\nAttaching package: 'zoo'\n\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n\ndwtest(mod1)\n\n\n    Durbin-Watson test\n\ndata:  mod1\nDW = 1.8578, p-value = 0.1835\nalternative hypothesis: true autocorrelation is greater than 0"
  },
  {
    "objectID": "semanas/Aula04.html#verificando-homocedasticidade-dos-resíduos",
    "href": "semanas/Aula04.html#verificando-homocedasticidade-dos-resíduos",
    "title": "Regressão Linear",
    "section": "Verificando Homocedasticidade dos Resíduos",
    "text": "Verificando Homocedasticidade dos Resíduos\n\nbptest(mod1)\n\n\n    studentized Breusch-Pagan test\n\ndata:  mod1\nBP = 37.881, df = 1, p-value = 7.519e-10"
  },
  {
    "objectID": "semanas/Aula04.html#verificando-pontos-afastados",
    "href": "semanas/Aula04.html#verificando-pontos-afastados",
    "title": "Regressão Linear",
    "section": "Verificando Pontos Afastados",
    "text": "Verificando Pontos Afastados\n\n#car\ninfluencePlot(mod1)\n\n\n\n\n        StudRes        Hat        CookD\n25  -2.55414901 0.02527870 8.171837e-02\n29  -0.01917304 0.02604819 4.947274e-06\n102  2.36589044 0.01128730 3.104163e-02\n104 -1.82461340 0.02550673 4.293306e-02\n139  2.27443079 0.02182638 5.621969e-02"
  },
  {
    "objectID": "semanas/Aula04.html#verificando-normalidade-dos-resíduos",
    "href": "semanas/Aula04.html#verificando-normalidade-dos-resíduos",
    "title": "Regressão Linear",
    "section": "Verificando Normalidade dos Resíduos",
    "text": "Verificando Normalidade dos Resíduos\n\nlibrary(moments)\njarque.test(sum_mod1$residuals)\n\n\n    Jarque-Bera Normality Test\n\ndata:  sum_mod1$residuals\nJB = 0.28717, p-value = 0.8662\nalternative hypothesis: greater"
  },
  {
    "objectID": "semanas/Aula04.html#transformação-de-box-cox",
    "href": "semanas/Aula04.html#transformação-de-box-cox",
    "title": "Regressão Linear",
    "section": "Transformação de Box-Cox",
    "text": "Transformação de Box-Cox\n\n#car\nboxCox(mod1)"
  },
  {
    "objectID": "semanas/Aula04.html#avaliando-modelo-com-conjunto-de-teste",
    "href": "semanas/Aula04.html#avaliando-modelo-com-conjunto-de-teste",
    "title": "Regressão Linear",
    "section": "Avaliando Modelo com Conjunto de Teste",
    "text": "Avaliando Modelo com Conjunto de Teste\n\n# Erro de Teste\nsqrt(mean((conj_teste$Vendas - predict(mod1, conj_teste)) ^ 2)) \n\n[1] 3.629383\n\n# Erro de Treino\nsum_mod1$sigma\n\n[1] 3.15769"
  },
  {
    "objectID": "semanas/Aula05.html",
    "href": "semanas/Aula05.html",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "",
    "text": "library(tidyverse)\n\n# parametros para imagens\nknitr::opts_chunk$set(\n  fig.width = 8,\n  fig.asp = 0.73,\n  fig.retina = 3,\n  dpi = 300,\n  out.width = \"90%\"\n)"
  },
  {
    "objectID": "semanas/Aula05.html#carregando-bibliotecas",
    "href": "semanas/Aula05.html#carregando-bibliotecas",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Carregando Bibliotecas",
    "text": "Carregando Bibliotecas\n\nlibrary(faraway)\nlibrary(leaps) # Metodos de selecao"
  },
  {
    "objectID": "semanas/Aula05.html#carregando-os-dados",
    "href": "semanas/Aula05.html#carregando-os-dados",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Carregando os dados",
    "text": "Carregando os dados\nNeste exercíco vamos ajustar um modelo de regressão linear múltipla ao conjunto de dados fat da biblioteca faraway.\n\nCom o conjunto de dados de gordura (fat) na biblioteca (faraway), queremos ajustar um modelo de regressão linear múltipla para prever o percentual de gordura corporal (y = brozek) usando diversas variáveis disponíveis, com exceção de:\n\n\nsiri (outra forma de cálculo do % de gordura corporal)\ndensidade (é usada nas fórmulas brozek e siri)\nlivre (é computada usando fórmula brozek)\nadipos (é calculada a partir do peso e da altura)\n\n\nVamos criar um conjunto de treino (90%) e outro de teste (10%)\nA partir do conjunto de dados você deverá usar três métodos de seleção de variáveis explicativas:\n\n\nO melhor subconjunto (bestsubset)\nSeleção passo a passo a frente (forward selection)\nSeleção passo a passo para trás (backward selection)\n\n\nPara cada método vamos ajustar o modelo usando o lm() com as variáveis selecionadas. Compare os resultados dos três métodos e escreva suas conclusões\nPor último vamo avaliar os resíduos do modelo\n\n\nlibrary(faraway)\ndata(\"fat\")\ngordura <- fat\nstr(gordura)\n\n'data.frame':   252 obs. of  18 variables:\n $ brozek : num  12.6 6.9 24.6 10.9 27.8 20.6 19 12.8 5.1 12 ...\n $ siri   : num  12.3 6.1 25.3 10.4 28.7 20.9 19.2 12.4 4.1 11.7 ...\n $ density: num  1.07 1.09 1.04 1.08 1.03 ...\n $ age    : int  23 22 22 26 24 24 26 25 25 23 ...\n $ weight : num  154 173 154 185 184 ...\n $ height : num  67.8 72.2 66.2 72.2 71.2 ...\n $ adipos : num  23.7 23.4 24.7 24.9 25.6 26.5 26.2 23.6 24.6 25.8 ...\n $ free   : num  135 161 116 165 133 ...\n $ neck   : num  36.2 38.5 34 37.4 34.4 39 36.4 37.8 38.1 42.1 ...\n $ chest  : num  93.1 93.6 95.8 101.8 97.3 ...\n $ abdom  : num  85.2 83 87.9 86.4 100 94.4 90.7 88.5 82.5 88.6 ...\n $ hip    : num  94.5 98.7 99.2 101.2 101.9 ...\n $ thigh  : num  59 58.7 59.6 60.1 63.2 66 58.4 60 62.9 63.1 ...\n $ knee   : num  37.3 37.3 38.9 37.3 42.2 42 38.3 39.4 38.3 41.7 ...\n $ ankle  : num  21.9 23.4 24 22.8 24 25.6 22.9 23.2 23.8 25 ...\n $ biceps : num  32 30.5 28.8 32.4 32.2 35.7 31.9 30.5 35.9 35.6 ...\n $ forearm: num  27.4 28.9 25.2 29.4 27.7 30.6 27.8 29 31.1 30 ...\n $ wrist  : num  17.1 18.2 16.6 18.2 17.7 18.8 17.7 18.8 18.2 19.2 ..."
  },
  {
    "objectID": "semanas/Aula05.html#renomeando-as-variáveis",
    "href": "semanas/Aula05.html#renomeando-as-variáveis",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Renomeando as variáveis",
    "text": "Renomeando as variáveis\n\ngordura <- gordura %>% rename(densidade = density, idade = age, peso=weight, altura = height,\n                          livre = free, pescoco = neck, torax = chest, quadril = hip,\n                           coxa = thigh, joelho = knee, tornozelo = ankle, antebraco = forearm,\n                           pulso = wrist) %>% \n                            select(brozek, idade, peso, altura, pescoco, torax, abdom, quadril,\n                                   coxa, joelho, tornozelo, biceps,antebraco, pulso)                             \nstr(gordura)\n\n'data.frame':   252 obs. of  14 variables:\n $ brozek   : num  12.6 6.9 24.6 10.9 27.8 20.6 19 12.8 5.1 12 ...\n $ idade    : int  23 22 22 26 24 24 26 25 25 23 ...\n $ peso     : num  154 173 154 185 184 ...\n $ altura   : num  67.8 72.2 66.2 72.2 71.2 ...\n $ pescoco  : num  36.2 38.5 34 37.4 34.4 39 36.4 37.8 38.1 42.1 ...\n $ torax    : num  93.1 93.6 95.8 101.8 97.3 ...\n $ abdom    : num  85.2 83 87.9 86.4 100 94.4 90.7 88.5 82.5 88.6 ...\n $ quadril  : num  94.5 98.7 99.2 101.2 101.9 ...\n $ coxa     : num  59 58.7 59.6 60.1 63.2 66 58.4 60 62.9 63.1 ...\n $ joelho   : num  37.3 37.3 38.9 37.3 42.2 42 38.3 39.4 38.3 41.7 ...\n $ tornozelo: num  21.9 23.4 24 22.8 24 25.6 22.9 23.2 23.8 25 ...\n $ biceps   : num  32 30.5 28.8 32.4 32.2 35.7 31.9 30.5 35.9 35.6 ...\n $ antebraco: num  27.4 28.9 25.2 29.4 27.7 30.6 27.8 29 31.1 30 ...\n $ pulso    : num  17.1 18.2 16.6 18.2 17.7 18.8 17.7 18.8 18.2 19.2 ...\n\n\n\n# Fat\n# - brozek: Percentual de gordura corporal usando a equação de Brozek, 457/Densidade - 414,2\n# - siri:  Percentual de gordura corporal usando a equação de Siri, 495/Densidade - 450\n# - densidade: Densidade (gm/$cm^3$)\n# - idade: idade (anos)\n# - peso: Peso (libras)\n# - altura: Altura (polegadas)\n# - adipos: Índice de adiposidade = Peso/Altura$^2$ (kg/$m^2$)\n# - livre: Peso livre de gordura = (1 - fração de gordura corporal) * Peso, utilizando a fórmula de Brozek (lbs)\n# - pescoco: Circunferência do pescoço (cm)\n# - torax: Circunferência torácica (cm)\n# - abdom: Circunferência do abdômen (cm) no umbigo e nível com a crista ilíaca\n# - quadril: Circunferência do quadril (cm)\n# - coxa: Circunferência da coxa (cm)\n# - joelho: Circunferência do joelho (cm)\n# - tornozelo: Circunferência do tornozelo (cm)\n# - biceps: Circunferência estendida dos bíceps (cm)\n# - antebraco: Circunferência do antebraço (cm)\n# - pulso: Circunferência do pulso (cm)"
  },
  {
    "objectID": "semanas/Aula05.html#conjunto-de-teste-e-treino",
    "href": "semanas/Aula05.html#conjunto-de-teste-e-treino",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Conjunto de teste e treino",
    "text": "Conjunto de teste e treino\n\nlibrary(caret)\n\nCarregando pacotes exigidos: lattice\n\n\n\nAttaching package: 'lattice'\n\n\nThe following object is masked from 'package:faraway':\n\n    melanoma\n\n\n\nAttaching package: 'caret'\n\n\nThe following object is masked from 'package:purrr':\n\n    lift\n\nset.seed(1234)\ny <- gordura$brozek\nindice_teste <- createDataPartition(y, times = 1, p = 0.10, list = FALSE)\n\nconj_treino <- gordura %>% slice(-indice_teste)\nconj_teste <- gordura %>% slice(indice_teste)\n\nsummary(conj_treino)\n\n     brozek          idade            peso           altura     \n Min.   : 0.00   Min.   :22.00   Min.   :118.5   Min.   :29.50  \n 1st Qu.:12.80   1st Qu.:35.75   1st Qu.:159.0   1st Qu.:68.25  \n Median :19.00   Median :43.50   Median :177.0   Median :70.25  \n Mean   :18.86   Mean   :44.78   Mean   :179.1   Mean   :70.16  \n 3rd Qu.:24.60   3rd Qu.:53.25   3rd Qu.:196.8   3rd Qu.:72.25  \n Max.   :45.10   Max.   :81.00   Max.   :363.1   Max.   :77.75  \n    pescoco          torax            abdom           quadril      \n Min.   :31.10   Min.   : 79.30   Min.   : 69.40   Min.   : 85.00  \n 1st Qu.:36.40   1st Qu.: 94.83   1st Qu.: 84.58   1st Qu.: 95.58  \n Median :37.90   Median : 99.75   Median : 90.90   Median : 99.35  \n Mean   :37.99   Mean   :100.80   Mean   : 92.52   Mean   : 99.93  \n 3rd Qu.:39.52   3rd Qu.:105.30   3rd Qu.: 99.72   3rd Qu.:103.28  \n Max.   :51.20   Max.   :136.20   Max.   :148.10   Max.   :147.70  \n      coxa           joelho        tornozelo         biceps     \n Min.   :47.20   Min.   :33.00   Min.   :19.10   Min.   :24.80  \n 1st Qu.:56.00   1st Qu.:36.90   1st Qu.:22.00   1st Qu.:30.30  \n Median :59.10   Median :38.40   Median :22.85   Median :32.30  \n Mean   :59.45   Mean   :38.56   Mean   :23.10   Mean   :32.34  \n 3rd Qu.:62.35   3rd Qu.:40.00   3rd Qu.:24.00   3rd Qu.:34.40  \n Max.   :87.30   Max.   :49.10   Max.   :33.90   Max.   :45.00  \n   antebraco         pulso      \n Min.   :21.00   Min.   :15.80  \n 1st Qu.:27.30   1st Qu.:17.60  \n Median :28.75   Median :18.30  \n Mean   :28.66   Mean   :18.22  \n 3rd Qu.:30.00   3rd Qu.:18.80  \n Max.   :34.90   Max.   :21.40  \n\nstr(conj_treino)\n\n'data.frame':   224 obs. of  14 variables:\n $ brozek   : num  12.6 6.9 24.6 10.9 27.8 20.6 19 12.8 5.1 12 ...\n $ idade    : int  23 22 22 26 24 24 26 25 25 23 ...\n $ peso     : num  154 173 154 185 184 ...\n $ altura   : num  67.8 72.2 66.2 72.2 71.2 ...\n $ pescoco  : num  36.2 38.5 34 37.4 34.4 39 36.4 37.8 38.1 42.1 ...\n $ torax    : num  93.1 93.6 95.8 101.8 97.3 ...\n $ abdom    : num  85.2 83 87.9 86.4 100 94.4 90.7 88.5 82.5 88.6 ...\n $ quadril  : num  94.5 98.7 99.2 101.2 101.9 ...\n $ coxa     : num  59 58.7 59.6 60.1 63.2 66 58.4 60 62.9 63.1 ...\n $ joelho   : num  37.3 37.3 38.9 37.3 42.2 42 38.3 39.4 38.3 41.7 ...\n $ tornozelo: num  21.9 23.4 24 22.8 24 25.6 22.9 23.2 23.8 25 ...\n $ biceps   : num  32 30.5 28.8 32.4 32.2 35.7 31.9 30.5 35.9 35.6 ...\n $ antebraco: num  27.4 28.9 25.2 29.4 27.7 30.6 27.8 29 31.1 30 ...\n $ pulso    : num  17.1 18.2 16.6 18.2 17.7 18.8 17.7 18.8 18.2 19.2 ...\n\nsummary(conj_teste)\n\n     brozek          idade            peso           altura     \n Min.   : 7.10   Min.   :24.00   Min.   :133.5   Min.   :65.00  \n 1st Qu.:13.15   1st Qu.:36.50   1st Qu.:158.6   1st Qu.:67.94  \n Median :19.05   Median :42.50   Median :167.8   Median :69.75  \n Mean   :19.60   Mean   :45.71   Mean   :177.3   Mean   :70.05  \n 3rd Qu.:24.10   3rd Qu.:54.75   3rd Qu.:198.8   3rd Qu.:71.81  \n Max.   :38.20   Max.   :72.00   Max.   :247.2   Max.   :76.00  \n    pescoco          torax            abdom           quadril      \n Min.   :33.60   Min.   : 88.20   Min.   : 73.70   Min.   : 88.50  \n 1st Qu.:36.30   1st Qu.: 93.83   1st Qu.: 86.08   1st Qu.: 95.03  \n Median :38.30   Median : 98.00   Median : 92.15   Median : 98.15  \n Mean   :38.01   Mean   :101.00   Mean   : 92.84   Mean   : 99.72  \n 3rd Qu.:38.95   3rd Qu.:106.72   3rd Qu.: 98.95   3rd Qu.:103.72  \n Max.   :42.10   Max.   :118.50   Max.   :115.60   Max.   :116.10  \n      coxa           joelho        tornozelo         biceps     \n Min.   :50.30   Min.   :34.50   Min.   :20.40   Min.   :27.90  \n 1st Qu.:56.23   1st Qu.:37.55   1st Qu.:22.20   1st Qu.:29.98  \n Median :57.35   Median :38.75   Median :22.70   Median :31.05  \n Mean   :59.06   Mean   :38.85   Mean   :23.09   Mean   :31.76  \n 3rd Qu.:62.20   3rd Qu.:39.73   3rd Qu.:23.80   3rd Qu.:32.27  \n Max.   :71.20   Max.   :45.00   Max.   :26.30   Max.   :38.50  \n   antebraco         pulso      \n Min.   :25.20   Min.   :16.90  \n 1st Qu.:27.27   1st Qu.:17.70  \n Median :28.60   Median :18.45  \n Mean   :28.68   Mean   :18.32  \n 3rd Qu.:30.07   3rd Qu.:18.85  \n Max.   :32.80   Max.   :19.90  \n\nstr(conj_teste)\n\n'data.frame':   28 obs. of  14 variables:\n $ brozek   : num  20.5 19 15.3 13.4 31.1 38.2 11.2 7.1 21.1 23.7 ...\n $ idade    : int  35 28 28 27 41 49 40 49 54 62 ...\n $ peso     : num  163 179 200 168 247 ...\n $ altura   : num  66 68 69.8 71.2 73.5 ...\n $ pescoco  : num  36.4 39.1 41.3 38.1 42.1 38.4 33.6 35.1 35.6 35.5 ...\n $ torax    : num  99.1 103.3 111.4 93 117 ...\n $ abdom    : num  92.8 95.9 98.8 79.1 115.6 ...\n $ quadril  : num  99.2 104.9 104.8 94.5 116.1 ...\n $ coxa     : num  63.1 63.5 63.4 57.3 71.2 61.9 53.3 52.6 55 56.6 ...\n $ joelho   : num  38.7 38 40.6 36.2 43.3 38.3 34.5 37.6 36.1 38.6 ...\n $ tornozelo: num  21.7 22.1 24.6 24.5 26.3 21.9 22.5 22.6 21.7 22.4 ...\n $ biceps   : num  31.1 32.5 33 29 37.3 32 27.9 38.5 29.6 31.5 ...\n $ antebraco: num  26.4 30.3 32.8 30 31.7 29.8 26.2 27.4 27.4 27.3 ...\n $ pulso    : num  16.9 18.4 19.9 18.8 19.7 17 17.3 18.5 17.4 18.6 ...\n\nhead(conj_treino)\n\n  brozek idade   peso altura pescoco torax abdom quadril coxa joelho tornozelo\n1   12.6    23 154.25  67.75    36.2  93.1  85.2    94.5 59.0   37.3      21.9\n2    6.9    22 173.25  72.25    38.5  93.6  83.0    98.7 58.7   37.3      23.4\n3   24.6    22 154.00  66.25    34.0  95.8  87.9    99.2 59.6   38.9      24.0\n4   10.9    26 184.75  72.25    37.4 101.8  86.4   101.2 60.1   37.3      22.8\n5   27.8    24 184.25  71.25    34.4  97.3 100.0   101.9 63.2   42.2      24.0\n6   20.6    24 210.25  74.75    39.0 104.5  94.4   107.8 66.0   42.0      25.6\n  biceps antebraco pulso\n1   32.0      27.4  17.1\n2   30.5      28.9  18.2\n3   28.8      25.2  16.6\n4   32.4      29.4  18.2\n5   32.2      27.7  17.7\n6   35.7      30.6  18.8"
  },
  {
    "objectID": "semanas/Aula05.html#estatística-descritiva-e-matriz-de-dispersão",
    "href": "semanas/Aula05.html#estatística-descritiva-e-matriz-de-dispersão",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Estatística descritiva e Matriz de Dispersão",
    "text": "Estatística descritiva e Matriz de Dispersão\n\nlibrary(psych)\n\n\nAttaching package: 'psych'\n\n\nThe following object is masked from 'package:faraway':\n\n    logit\n\n\nThe following objects are masked from 'package:ggplot2':\n\n    %+%, alpha\n\ndescribe(conj_treino)\n\n          vars   n   mean    sd median trimmed   mad   min    max  range  skew\nbrozek       1 224  18.86  7.72  19.00   18.82  8.45   0.0  45.10  45.10  0.08\nidade        2 224  44.78 12.42  43.50   44.36 12.60  22.0  81.00  59.00  0.29\npeso         3 224 179.13 29.59 177.00  177.82 28.35 118.5 363.15 244.65  1.22\naltura       4 224  70.16  3.78  70.25   70.31  2.97  29.5  77.75  48.25 -5.48\npescoco      5 224  37.99  2.47  37.90   37.96  2.37  31.1  51.20  20.10  0.58\ntorax        6 224 100.80  8.39  99.75  100.30  8.08  79.3 136.20  56.90  0.68\nabdom        7 224  92.52 10.74  90.90   91.98 10.82  69.4 148.10  78.70  0.90\nquadril      8 224  99.93  7.20  99.35   99.54  5.71  85.0 147.70  62.70  1.56\ncoxa         9 224  59.45  5.27  59.10   59.25  4.60  47.2  87.30  40.10  0.80\njoelho      10 224  38.56  2.41  38.40   38.48  2.30  33.0  49.10  16.10  0.50\ntornozelo   11 224  23.10  1.74  22.85   22.98  1.41  19.1  33.90  14.80  2.29\nbiceps      12 224  32.34  3.04  32.30   32.34  3.11  24.8  45.00  20.20  0.20\nantebraco   13 224  28.66  2.04  28.75   28.68  2.00  21.0  34.90  13.90 -0.26\npulso       14 224  18.22  0.94  18.30   18.20  0.89  15.8  21.40   5.60  0.29\n          kurtosis   se\nbrozek       -0.39 0.52\nidade        -0.36 0.83\npeso          5.51 1.98\naltura       57.59 0.25\npescoco       2.73 0.17\ntorax         1.15 0.56\nabdom         2.53 0.72\nquadril       7.97 0.48\ncoxa          2.79 0.35\njoelho        1.06 0.16\ntornozelo    11.65 0.12\nbiceps        0.51 0.20\nantebraco     0.89 0.14\npulso         0.45 0.06\n\npairs.panels(conj_treino)\n\n\n\npairs.panels(conj_treino[,1:7])\n\n\n\npairs.panels(conj_treino[,c(1,8:14)])"
  },
  {
    "objectID": "semanas/Aula05.html#matriz-de-correlação",
    "href": "semanas/Aula05.html#matriz-de-correlação",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Matriz de correlação",
    "text": "Matriz de correlação\n\nlibrary(corrplot)\n\ncorrplot 0.92 loaded\n\nmat_corr <- cor(conj_treino)\ncorrplot(mat_corr)"
  },
  {
    "objectID": "semanas/Aula05.html#regressão-múltipla",
    "href": "semanas/Aula05.html#regressão-múltipla",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Regressão Múltipla",
    "text": "Regressão Múltipla\n\nmod1a <- lm(brozek ~ ., data=conj_treino)\nsummary(mod1a)\n\n\nCall:\nlm(formula = brozek ~ ., data = conj_treino)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-10.0507  -2.6484  -0.0864   2.8196   9.3863 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -13.55860   17.49304  -0.775  0.43916    \nidade         0.04398    0.03171   1.387  0.16694    \npeso         -0.08151    0.05559  -1.466  0.14408    \naltura       -0.06734    0.09043  -0.745  0.45726    \npescoco      -0.50983    0.22858  -2.230  0.02678 *  \ntorax        -0.01038    0.09828  -0.106  0.91597    \nabdom         0.89639    0.08292  10.810  < 2e-16 ***\nquadril      -0.25304    0.14978  -1.689  0.09262 .  \ncoxa          0.27120    0.13833   1.961  0.05126 .  \njoelho        0.04954    0.23704   0.209  0.83465    \ntornozelo     0.13702    0.20872   0.656  0.51223    \nbiceps        0.21144    0.17910   1.181  0.23911    \nantebraco     0.42384    0.19078   2.222  0.02738 *  \npulso        -1.51764    0.52213  -2.907  0.00405 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.949 on 210 degrees of freedom\nMultiple R-squared:  0.7538,    Adjusted R-squared:  0.7386 \nF-statistic: 49.47 on 13 and 210 DF,  p-value: < 2.2e-16"
  },
  {
    "objectID": "semanas/Aula05.html#métodos-de-seleção-de-modelo",
    "href": "semanas/Aula05.html#métodos-de-seleção-de-modelo",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Métodos de seleção de modelo",
    "text": "Métodos de seleção de modelo\n\n## Best Subset \nmod1.bs <- regsubsets(brozek ~ . , data = conj_treino, nvmax = 14)\nsum.mod1bs <- summary(mod1.bs)\nsum.mod1bs\n\nSubset selection object\nCall: regsubsets.formula(brozek ~ ., data = conj_treino, nvmax = 14)\n13 Variables  (and intercept)\n          Forced in Forced out\nidade         FALSE      FALSE\npeso          FALSE      FALSE\naltura        FALSE      FALSE\npescoco       FALSE      FALSE\ntorax         FALSE      FALSE\nabdom         FALSE      FALSE\nquadril       FALSE      FALSE\ncoxa          FALSE      FALSE\njoelho        FALSE      FALSE\ntornozelo     FALSE      FALSE\nbiceps        FALSE      FALSE\nantebraco     FALSE      FALSE\npulso         FALSE      FALSE\n1 subsets of each size up to 13\nSelection Algorithm: exhaustive\n          idade peso altura pescoco torax abdom quadril coxa joelho tornozelo\n1  ( 1 )  \" \"   \" \"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n2  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n3  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n4  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n5  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \"*\"  \" \"    \" \"      \n6  ( 1 )  \" \"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n7  ( 1 )  \" \"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n8  ( 1 )  \"*\"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n9  ( 1 )  \"*\"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n10  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n11  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \"*\"      \n12  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \"*\"    \"*\"      \n13  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \"*\"   \"*\"   \"*\"     \"*\"  \"*\"    \"*\"      \n          biceps antebraco pulso\n1  ( 1 )  \" \"    \" \"       \" \"  \n2  ( 1 )  \" \"    \" \"       \" \"  \n3  ( 1 )  \" \"    \" \"       \"*\"  \n4  ( 1 )  \" \"    \"*\"       \"*\"  \n5  ( 1 )  \" \"    \"*\"       \"*\"  \n6  ( 1 )  \"*\"    \"*\"       \"*\"  \n7  ( 1 )  \" \"    \"*\"       \"*\"  \n8  ( 1 )  \" \"    \"*\"       \"*\"  \n9  ( 1 )  \"*\"    \"*\"       \"*\"  \n10  ( 1 ) \"*\"    \"*\"       \"*\"  \n11  ( 1 ) \"*\"    \"*\"       \"*\"  \n12  ( 1 ) \"*\"    \"*\"       \"*\"  \n13  ( 1 ) \"*\"    \"*\"       \"*\"  \n\nnames(sum.mod1bs)\n\n[1] \"which\"  \"rsq\"    \"rss\"    \"adjr2\"  \"cp\"     \"bic\"    \"outmat\" \"obj\""
  },
  {
    "objectID": "semanas/Aula05.html#avaliando-o-modelos",
    "href": "semanas/Aula05.html#avaliando-o-modelos",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Avaliando o modelos",
    "text": "Avaliando o modelos\n\n## Os modelos vão ser escolhidos com base no menor Cp\nplot(sum.mod1bs$cp,xlab=\"Numero de Variaveis\",ylab=\"Cp\")\nwhich.min(sum.mod1bs$cp)\n\n[1] 8\n\npoints(8,sum.mod1bs$cp[8],pch=20,col=\"red\")"
  },
  {
    "objectID": "semanas/Aula05.html#como-extrair-detalhes-do-ajuste",
    "href": "semanas/Aula05.html#como-extrair-detalhes-do-ajuste",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Como extrair detalhes do ajuste",
    "text": "Como extrair detalhes do ajuste\n\ncoef(mod1.bs,8)  \n\n (Intercept)        idade         peso      pescoco        abdom      quadril \n-17.66873314   0.04903682  -0.08086437  -0.49111763   0.89449420  -0.23874321 \n        coxa    antebraco        pulso \n  0.34303707   0.51253418  -1.45541810"
  },
  {
    "objectID": "semanas/Aula05.html#forward-stepwise-passo-a-passo-à-frente",
    "href": "semanas/Aula05.html#forward-stepwise-passo-a-passo-à-frente",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Forward Stepwise (passo a passo à frente)",
    "text": "Forward Stepwise (passo a passo à frente)\n\nmod1.fw <- regsubsets(brozek ~ . , data = conj_treino, nvmax = 14, method=\"forward\")\nsum.mod1fw <- summary(mod1.fw)\nsum.mod1fw\n\nSubset selection object\nCall: regsubsets.formula(brozek ~ ., data = conj_treino, nvmax = 14, \n    method = \"forward\")\n13 Variables  (and intercept)\n          Forced in Forced out\nidade         FALSE      FALSE\npeso          FALSE      FALSE\naltura        FALSE      FALSE\npescoco       FALSE      FALSE\ntorax         FALSE      FALSE\nabdom         FALSE      FALSE\nquadril       FALSE      FALSE\ncoxa          FALSE      FALSE\njoelho        FALSE      FALSE\ntornozelo     FALSE      FALSE\nbiceps        FALSE      FALSE\nantebraco     FALSE      FALSE\npulso         FALSE      FALSE\n1 subsets of each size up to 13\nSelection Algorithm: forward\n          idade peso altura pescoco torax abdom quadril coxa joelho tornozelo\n1  ( 1 )  \" \"   \" \"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n2  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n3  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n4  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n5  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \"*\"  \" \"    \" \"      \n6  ( 1 )  \" \"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \" \"     \"*\"  \" \"    \" \"      \n7  ( 1 )  \" \"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n8  ( 1 )  \"*\"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n9  ( 1 )  \"*\"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n10  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n11  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \"*\"      \n12  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \"*\"    \"*\"      \n13  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \"*\"   \"*\"   \"*\"     \"*\"  \"*\"    \"*\"      \n          biceps antebraco pulso\n1  ( 1 )  \" \"    \" \"       \" \"  \n2  ( 1 )  \" \"    \" \"       \" \"  \n3  ( 1 )  \" \"    \" \"       \"*\"  \n4  ( 1 )  \" \"    \"*\"       \"*\"  \n5  ( 1 )  \" \"    \"*\"       \"*\"  \n6  ( 1 )  \" \"    \"*\"       \"*\"  \n7  ( 1 )  \" \"    \"*\"       \"*\"  \n8  ( 1 )  \" \"    \"*\"       \"*\"  \n9  ( 1 )  \"*\"    \"*\"       \"*\"  \n10  ( 1 ) \"*\"    \"*\"       \"*\"  \n11  ( 1 ) \"*\"    \"*\"       \"*\"  \n12  ( 1 ) \"*\"    \"*\"       \"*\"  \n13  ( 1 ) \"*\"    \"*\"       \"*\"  \n\nnames(sum.mod1fw)\n\n[1] \"which\"  \"rsq\"    \"rss\"    \"adjr2\"  \"cp\"     \"bic\"    \"outmat\" \"obj\""
  },
  {
    "objectID": "semanas/Aula05.html#avaliando-o-modelo",
    "href": "semanas/Aula05.html#avaliando-o-modelo",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Avaliando o modelo",
    "text": "Avaliando o modelo\n\n## Os modelos vão ser escolhidos com base no menor Cp\nplot(sum.mod1fw$cp,xlab=\"Numero de Variaveis\",ylab=\"Cp\")\nwhich.min(sum.mod1fw$cp)\n\n[1] 8\n\npoints(8,sum.mod1fw$cp[8],pch=20,col=\"red\")"
  },
  {
    "objectID": "semanas/Aula05.html#como-extrair-detalhes-do-ajuste-1",
    "href": "semanas/Aula05.html#como-extrair-detalhes-do-ajuste-1",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Como extrair detalhes do ajuste",
    "text": "Como extrair detalhes do ajuste\n\ncoef(mod1.fw,8)  \n\n (Intercept)        idade         peso      pescoco        abdom      quadril \n-17.66873314   0.04903682  -0.08086437  -0.49111763   0.89449420  -0.23874321 \n        coxa    antebraco        pulso \n  0.34303707   0.51253418  -1.45541810"
  },
  {
    "objectID": "semanas/Aula05.html#backward-stepwise-passo-a-passo-atrás",
    "href": "semanas/Aula05.html#backward-stepwise-passo-a-passo-atrás",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Backward Stepwise (passo a passo atrás)",
    "text": "Backward Stepwise (passo a passo atrás)\n\nmod1.bw <- regsubsets(brozek ~ . , data = conj_treino, nvmax = 14, method=\"backward\")\nsum.mod1bw <- summary(mod1.bw)\nsum.mod1bw\n\nSubset selection object\nCall: regsubsets.formula(brozek ~ ., data = conj_treino, nvmax = 14, \n    method = \"backward\")\n13 Variables  (and intercept)\n          Forced in Forced out\nidade         FALSE      FALSE\npeso          FALSE      FALSE\naltura        FALSE      FALSE\npescoco       FALSE      FALSE\ntorax         FALSE      FALSE\nabdom         FALSE      FALSE\nquadril       FALSE      FALSE\ncoxa          FALSE      FALSE\njoelho        FALSE      FALSE\ntornozelo     FALSE      FALSE\nbiceps        FALSE      FALSE\nantebraco     FALSE      FALSE\npulso         FALSE      FALSE\n1 subsets of each size up to 13\nSelection Algorithm: backward\n          idade peso altura pescoco torax abdom quadril coxa joelho tornozelo\n1  ( 1 )  \" \"   \" \"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n2  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n3  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n4  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n5  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \"*\"  \" \"    \" \"      \n6  ( 1 )  \" \"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \" \"     \"*\"  \" \"    \" \"      \n7  ( 1 )  \" \"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n8  ( 1 )  \"*\"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n9  ( 1 )  \"*\"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n10  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n11  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \"*\"      \n12  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \"*\"    \"*\"      \n13  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \"*\"   \"*\"   \"*\"     \"*\"  \"*\"    \"*\"      \n          biceps antebraco pulso\n1  ( 1 )  \" \"    \" \"       \" \"  \n2  ( 1 )  \" \"    \" \"       \" \"  \n3  ( 1 )  \" \"    \" \"       \"*\"  \n4  ( 1 )  \" \"    \"*\"       \"*\"  \n5  ( 1 )  \" \"    \"*\"       \"*\"  \n6  ( 1 )  \" \"    \"*\"       \"*\"  \n7  ( 1 )  \" \"    \"*\"       \"*\"  \n8  ( 1 )  \" \"    \"*\"       \"*\"  \n9  ( 1 )  \"*\"    \"*\"       \"*\"  \n10  ( 1 ) \"*\"    \"*\"       \"*\"  \n11  ( 1 ) \"*\"    \"*\"       \"*\"  \n12  ( 1 ) \"*\"    \"*\"       \"*\"  \n13  ( 1 ) \"*\"    \"*\"       \"*\"  \n\nnames(sum.mod1bw)\n\n[1] \"which\"  \"rsq\"    \"rss\"    \"adjr2\"  \"cp\"     \"bic\"    \"outmat\" \"obj\""
  },
  {
    "objectID": "semanas/Aula05.html#avaliando-o-modelo-1",
    "href": "semanas/Aula05.html#avaliando-o-modelo-1",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Avaliando o modelo",
    "text": "Avaliando o modelo\n\n## Os modelos vão ser escolhidos com base no menor Cp\nplot(sum.mod1bw$cp,xlab=\"Numero de Variaveis\",ylab=\"Cp\")\nwhich.min(sum.mod1bw$cp)\n\n[1] 8\n\npoints(8,sum.mod1bw$cp[8],pch=20,col=\"red\")"
  },
  {
    "objectID": "semanas/Aula05.html#como-extrair-detalhes-do-ajuste-2",
    "href": "semanas/Aula05.html#como-extrair-detalhes-do-ajuste-2",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Como extrair detalhes do ajuste",
    "text": "Como extrair detalhes do ajuste\n\ncoef(mod1.bw,8)  \n\n (Intercept)        idade         peso      pescoco        abdom      quadril \n-17.66873314   0.04903682  -0.08086437  -0.49111763   0.89449420  -0.23874321 \n        coxa    antebraco        pulso \n  0.34303707   0.51253418  -1.45541810 \n\n\nComo vimos, independente do método de seleção de variáveis, usando o Cp o melhor modelo é o com 8 variáveis explicativas: idade, peso, pescoco, abdom, quadril, coxa, antebraco e pulso"
  },
  {
    "objectID": "semanas/Aula05.html#testando-outra-estatística-de-seleção-de-modelos---bic",
    "href": "semanas/Aula05.html#testando-outra-estatística-de-seleção-de-modelos---bic",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Testando outra estatística de seleção de modelos - BIC",
    "text": "Testando outra estatística de seleção de modelos - BIC\n\n# BIC\nplot(sum.mod1bs$bic,xlab=\"Numero de Variaveis\",ylab=\"BIC\")\nwhich.min(sum.mod1bs$bic)\n\n[1] 4\n\npoints(4,sum.mod1bs$bic[4],pch=20,col=\"red\")"
  },
  {
    "objectID": "semanas/Aula05.html#como-extrair-detalhes-do-ajuste-3",
    "href": "semanas/Aula05.html#como-extrair-detalhes-do-ajuste-3",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Como extrair detalhes do ajuste",
    "text": "Como extrair detalhes do ajuste\n\ncoef(mod1.bs,4)  \n\n(Intercept)        peso       abdom   antebraco       pulso \n-30.2919680  -0.1244007   0.9288492   0.5181297  -1.6114492 \n\n\nPelo BIC o melhor modelo é o com 4 variáves explicativas: peso, abdom, antebraço e pulso."
  },
  {
    "objectID": "semanas/Aula05.html#comparando-os-dois-modelos-com-o-lm",
    "href": "semanas/Aula05.html#comparando-os-dois-modelos-com-o-lm",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Comparando os dois modelos com o lm()",
    "text": "Comparando os dois modelos com o lm()\n\n## Usando o lm para ajustar o modelo com as variáveis selecionadas pelo BIC\n## Seleção do BIC\nmod1a.lm <- lm(brozek ~ peso + abdom + antebraco + pulso,data=conj_treino)\nsummary(mod1a.lm)\n\n\nCall:\nlm(formula = brozek ~ peso + abdom + antebraco + pulso, data = conj_treino)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-9.7403 -2.8496 -0.1399  2.9035  8.5253 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -30.29197    7.02195  -4.314 2.43e-05 ***\npeso         -0.12440    0.02400  -5.182 4.97e-07 ***\nabdom         0.92885    0.05554  16.723  < 2e-16 ***\nantebraco     0.51813    0.17193   3.014 0.002885 ** \npulso        -1.61145    0.43290  -3.722 0.000251 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.998 on 219 degrees of freedom\nMultiple R-squared:  0.7369,    Adjusted R-squared:  0.7321 \nF-statistic: 153.4 on 4 and 219 DF,  p-value: < 2.2e-16\n\n## Seleção do Cp\nmod1b.lm <- lm(brozek ~ idade + peso + pescoco + abdom + quadril + coxa + antebraco + pulso,data=conj_treino)\nsummary(mod1b.lm)\n\n\nCall:\nlm(formula = brozek ~ idade + peso + pescoco + abdom + quadril + \n    coxa + antebraco + pulso, data = conj_treino)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-9.9166 -2.7293 -0.1825  2.7588  9.5966 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -17.66873   11.67115  -1.514  0.13152    \nidade         0.04904    0.03024   1.622  0.10634    \npeso         -0.08086    0.04091  -1.976  0.04938 *  \npescoco      -0.49112    0.21790  -2.254  0.02521 *  \nabdom         0.89449    0.07019  12.744  < 2e-16 ***\nquadril      -0.23874    0.13868  -1.721  0.08660 .  \ncoxa          0.34304    0.12521   2.740  0.00667 ** \nantebraco     0.51253    0.17573   2.917  0.00391 ** \npulso        -1.45542    0.49709  -2.928  0.00378 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.928 on 215 degrees of freedom\nMultiple R-squared:  0.7508,    Adjusted R-squared:  0.7415 \nF-statistic: 80.95 on 8 and 215 DF,  p-value: < 2.2e-16\n\n\nAjustando com o lm o modelo com as variáveis indicadas pelo BIC obtivemos um R2 ajustado de 0,7321, um erro padrão de resíduo de 3,998. Pelos valores da estatística t vemos que todas as variáveis escolhidas são estatisticamente significativas\nAjustando pelo Cp o R2 ajustado foi de 0,7415 e o erro padrão do resíduo foi de 3,928.\nNo entanto com o Cp, temos uma variável que se mostrou não significativas: idade Parece que o Cp exagerou!"
  },
  {
    "objectID": "semanas/Aula05.html#avaliando-colinearidade",
    "href": "semanas/Aula05.html#avaliando-colinearidade",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Avaliando Colinearidade",
    "text": "Avaliando Colinearidade\nUma investigação minuciosa da multicolinearidade envolverá a análise do valor do \\(R^2\\) que resulta da regressão de cada uma das variáveis explicativas contra todas as outras. A relação entre as variáveis explicativas pode ser julgada examinando uma quantidade chamada fator de inflacionário da variância (FIV) ou Variance Inflation Factor (VIF). Seja \\(Rj~^{2}\\) o quadrado do coeficiente de correlação múltipla que resulta quando a variável explicativa \\(Xj~\\) é ajustada contra todas as outras variáveis explicativas. Então o vif para \\(Xj~\\) é \\(VIFj = 1 / (1-Rj~^{2})\\)\nA regra geral é que vifs superiores a 4 justificam novas investigações, enquanto VIFs superiores a 10 são sinais de multicolinearidade grave que requerem correção.\n\nlibrary(car)\n\nCarregando pacotes exigidos: carData\n\n\n\nAttaching package: 'car'\n\n\nThe following object is masked from 'package:psych':\n\n    logit\n\n\nThe following objects are masked from 'package:faraway':\n\n    logit, vif\n\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\n\nThe following object is masked from 'package:purrr':\n\n    some\n\nvif(mod1a.lm)\n\n     peso     abdom antebraco     pulso \n 7.038103  4.967719  1.721647  2.310727"
  },
  {
    "objectID": "semanas/Aula05.html#testando-os-dois-modelos-com-o-conjunto-de-teste",
    "href": "semanas/Aula05.html#testando-os-dois-modelos-com-o-conjunto-de-teste",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Testando os dois modelos com o conjunto de teste",
    "text": "Testando os dois modelos com o conjunto de teste\n\n# Modelo com base no BIC\nsummary(mod1a.lm)$sigma\n\n[1] 3.997985\n\nsummary(mod1a.lm)$adj.r.squared\n\n[1] 0.7321416\n\nsqrt(mean((conj_teste$brozek - predict(mod1a.lm, conj_teste)) ^ 2))\n\n[1] 4.231517\n\n# Modelo com base no Cp\nsummary(mod1b.lm)$sigma\n\n[1] 3.92764\n\nsummary(mod1b.lm)$adj.r.squared\n\n[1] 0.7414846\n\nsqrt(mean((conj_teste$brozek - predict(mod1b.lm, conj_teste)) ^ 2))\n\n[1] 4.301996\n\n\nO erro de teste do BIC deu 4,231517. O erro de teste do Cp deu 4,301996, maior que o modelo do BIC."
  },
  {
    "objectID": "semanas/Aula05.html#avaliando-os-resíduos",
    "href": "semanas/Aula05.html#avaliando-os-resíduos",
    "title": "Regressão Múltipla e Seleção de Modelos",
    "section": "Avaliando os Resíduos",
    "text": "Avaliando os Resíduos\n\npar(mfrow=c(2,2))\nplot(mod1a.lm)\n\n\n\npar(mfrow=c(1,1))\nlibrary(car)\nresidualPlots(mod1a.lm, tests=FALSE)\n\n\n\nshapiro.test(mod1a.lm$residuals)\n\n\n    Shapiro-Wilk normality test\n\ndata:  mod1a.lm$residuals\nW = 0.98912, p-value = 0.08867\n\nlibrary(lmtest)\n\nCarregando pacotes exigidos: zoo\n\n\n\nAttaching package: 'zoo'\n\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n\nbptest(mod1a.lm)\n\n\n    studentized Breusch-Pagan test\n\ndata:  mod1a.lm\nBP = 1.0144, df = 4, p-value = 0.9076\n\ninfluencePlot(mod1a.lm)\n\n\n\n\n       StudRes        Hat      CookD\n39  -2.6515288 0.28623188 0.54876460\n175  0.9995493 0.21064336 0.05332302\n225 -2.4952041 0.02389734 0.02977518"
  },
  {
    "objectID": "semanas/Aula05A.html",
    "href": "semanas/Aula05A.html",
    "title": "Regularização de Modelos",
    "section": "",
    "text": "library(tidyverse)\n\n# parametros para imagens\nknitr::opts_chunk$set(\n  fig.width = 8,\n  fig.asp = 0.73,\n  fig.retina = 3,\n  dpi = 300,\n  out.width = \"90%\"\n)"
  },
  {
    "objectID": "semanas/Aula05A.html#carregando-bibliotecas",
    "href": "semanas/Aula05A.html#carregando-bibliotecas",
    "title": "Regularização de Modelos",
    "section": "Carregando Bibliotecas",
    "text": "Carregando Bibliotecas\n\nlibrary(faraway)\nlibrary(glmnet)"
  },
  {
    "objectID": "semanas/Aula05A.html#carregando-os-dados",
    "href": "semanas/Aula05A.html#carregando-os-dados",
    "title": "Regularização de Modelos",
    "section": "Carregando os dados",
    "text": "Carregando os dados\nNeste exercíco vamos ajustar um modelo de regressão linear múltipla ao conjunto de dados fat da biblioteca faraway.\n\ndata(\"fat\")\ngordura <- fat\nstr(gordura)\n\n'data.frame':   252 obs. of  18 variables:\n $ brozek : num  12.6 6.9 24.6 10.9 27.8 20.6 19 12.8 5.1 12 ...\n $ siri   : num  12.3 6.1 25.3 10.4 28.7 20.9 19.2 12.4 4.1 11.7 ...\n $ density: num  1.07 1.09 1.04 1.08 1.03 ...\n $ age    : int  23 22 22 26 24 24 26 25 25 23 ...\n $ weight : num  154 173 154 185 184 ...\n $ height : num  67.8 72.2 66.2 72.2 71.2 ...\n $ adipos : num  23.7 23.4 24.7 24.9 25.6 26.5 26.2 23.6 24.6 25.8 ...\n $ free   : num  135 161 116 165 133 ...\n $ neck   : num  36.2 38.5 34 37.4 34.4 39 36.4 37.8 38.1 42.1 ...\n $ chest  : num  93.1 93.6 95.8 101.8 97.3 ...\n $ abdom  : num  85.2 83 87.9 86.4 100 94.4 90.7 88.5 82.5 88.6 ...\n $ hip    : num  94.5 98.7 99.2 101.2 101.9 ...\n $ thigh  : num  59 58.7 59.6 60.1 63.2 66 58.4 60 62.9 63.1 ...\n $ knee   : num  37.3 37.3 38.9 37.3 42.2 42 38.3 39.4 38.3 41.7 ...\n $ ankle  : num  21.9 23.4 24 22.8 24 25.6 22.9 23.2 23.8 25 ...\n $ biceps : num  32 30.5 28.8 32.4 32.2 35.7 31.9 30.5 35.9 35.6 ...\n $ forearm: num  27.4 28.9 25.2 29.4 27.7 30.6 27.8 29 31.1 30 ...\n $ wrist  : num  17.1 18.2 16.6 18.2 17.7 18.8 17.7 18.8 18.2 19.2 ..."
  },
  {
    "objectID": "semanas/Aula05A.html#renomeando-as-variáveis",
    "href": "semanas/Aula05A.html#renomeando-as-variáveis",
    "title": "Regularização de Modelos",
    "section": "Renomeando as variáveis",
    "text": "Renomeando as variáveis\n\ngordura <- gordura %>% rename(densidade = density, idade = age, peso=weight, altura = height,\n                          livre = free, pescoco = neck, torax = chest, quadril = hip,\n                           coxa = thigh, joelho = knee, tornozelo = ankle, antebraco = forearm,\n                           pulso = wrist) %>% \n                            select(brozek, idade, peso, altura, pescoco,                                        torax, abdom, quadril, coxa, joelho, tornozelo, biceps,antebraco, pulso)                             \nstr(gordura)\n\n'data.frame':   252 obs. of  14 variables:\n $ brozek   : num  12.6 6.9 24.6 10.9 27.8 20.6 19 12.8 5.1 12 ...\n $ idade    : int  23 22 22 26 24 24 26 25 25 23 ...\n $ peso     : num  154 173 154 185 184 ...\n $ altura   : num  67.8 72.2 66.2 72.2 71.2 ...\n $ pescoco  : num  36.2 38.5 34 37.4 34.4 39 36.4 37.8 38.1 42.1 ...\n $ torax    : num  93.1 93.6 95.8 101.8 97.3 ...\n $ abdom    : num  85.2 83 87.9 86.4 100 94.4 90.7 88.5 82.5 88.6 ...\n $ quadril  : num  94.5 98.7 99.2 101.2 101.9 ...\n $ coxa     : num  59 58.7 59.6 60.1 63.2 66 58.4 60 62.9 63.1 ...\n $ joelho   : num  37.3 37.3 38.9 37.3 42.2 42 38.3 39.4 38.3 41.7 ...\n $ tornozelo: num  21.9 23.4 24 22.8 24 25.6 22.9 23.2 23.8 25 ...\n $ biceps   : num  32 30.5 28.8 32.4 32.2 35.7 31.9 30.5 35.9 35.6 ...\n $ antebraco: num  27.4 28.9 25.2 29.4 27.7 30.6 27.8 29 31.1 30 ...\n $ pulso    : num  17.1 18.2 16.6 18.2 17.7 18.8 17.7 18.8 18.2 19.2 ...\n\n\n\n# Fat\n# - brozek: Percentual de gordura corporal usando a equação de Brozek, 457/Densidade - 414,2\n# - siri:  Percentual de gordura corporal usando a equação de Siri, 495/Densidade - 450\n# - densidade: Densidade (gm/$cm^3$)\n# - idade: idade (anos)\n# - peso: Peso (libras)\n# - altura: Altura (polegadas)\n# - adipos: Índice de adiposidade = Peso/Altura$^2$ (kg/$m^2$)\n# - livre: Peso livre de gordura = (1 - fração de gordura corporal) * Peso, utilizando a fórmula de Brozek (lbs)\n# - pescoco: Circunferência do pescoço (cm)\n# - torax: Circunferência torácica (cm)\n# - abdom: Circunferência do abdômen (cm) no umbigo e nível com a crista ilíaca\n# - quadril: Circunferência do quadril (cm)\n# - coxa: Circunferência da coxa (cm)\n# - joelho: Circunferência do joelho (cm)\n# - tornozelo: Circunferência do tornozelo (cm)\n# - biceps: Circunferência estendida dos bíceps (cm)\n# - antebraco: Circunferência do antebraço (cm)\n# - pulso: Circunferência do pulso (cm)"
  },
  {
    "objectID": "semanas/Aula05A.html#conjunto-de-teste-e-treino",
    "href": "semanas/Aula05A.html#conjunto-de-teste-e-treino",
    "title": "Regularização de Modelos",
    "section": "Conjunto de teste e treino",
    "text": "Conjunto de teste e treino\n\nlibrary(caret)\n\nCarregando pacotes exigidos: lattice\n\n\n\nAttaching package: 'lattice'\n\n\nThe following object is masked from 'package:faraway':\n\n    melanoma\n\n\n\nAttaching package: 'caret'\n\n\nThe following object is masked from 'package:purrr':\n\n    lift\n\nset.seed(1234)\ny <- gordura$brozek\nindice_teste <- createDataPartition(y, times = 1, p = 0.10, list = FALSE)\n\nconj_treino <- gordura %>% slice(-indice_teste)\nconj_teste <- gordura %>% slice(indice_teste)\n\nsummary(conj_treino)\n\n     brozek          idade            peso           altura     \n Min.   : 0.00   Min.   :22.00   Min.   :118.5   Min.   :29.50  \n 1st Qu.:12.80   1st Qu.:35.75   1st Qu.:159.0   1st Qu.:68.25  \n Median :19.00   Median :43.50   Median :177.0   Median :70.25  \n Mean   :18.86   Mean   :44.78   Mean   :179.1   Mean   :70.16  \n 3rd Qu.:24.60   3rd Qu.:53.25   3rd Qu.:196.8   3rd Qu.:72.25  \n Max.   :45.10   Max.   :81.00   Max.   :363.1   Max.   :77.75  \n    pescoco          torax            abdom           quadril      \n Min.   :31.10   Min.   : 79.30   Min.   : 69.40   Min.   : 85.00  \n 1st Qu.:36.40   1st Qu.: 94.83   1st Qu.: 84.58   1st Qu.: 95.58  \n Median :37.90   Median : 99.75   Median : 90.90   Median : 99.35  \n Mean   :37.99   Mean   :100.80   Mean   : 92.52   Mean   : 99.93  \n 3rd Qu.:39.52   3rd Qu.:105.30   3rd Qu.: 99.72   3rd Qu.:103.28  \n Max.   :51.20   Max.   :136.20   Max.   :148.10   Max.   :147.70  \n      coxa           joelho        tornozelo         biceps     \n Min.   :47.20   Min.   :33.00   Min.   :19.10   Min.   :24.80  \n 1st Qu.:56.00   1st Qu.:36.90   1st Qu.:22.00   1st Qu.:30.30  \n Median :59.10   Median :38.40   Median :22.85   Median :32.30  \n Mean   :59.45   Mean   :38.56   Mean   :23.10   Mean   :32.34  \n 3rd Qu.:62.35   3rd Qu.:40.00   3rd Qu.:24.00   3rd Qu.:34.40  \n Max.   :87.30   Max.   :49.10   Max.   :33.90   Max.   :45.00  \n   antebraco         pulso      \n Min.   :21.00   Min.   :15.80  \n 1st Qu.:27.30   1st Qu.:17.60  \n Median :28.75   Median :18.30  \n Mean   :28.66   Mean   :18.22  \n 3rd Qu.:30.00   3rd Qu.:18.80  \n Max.   :34.90   Max.   :21.40  \n\nstr(conj_treino)\n\n'data.frame':   224 obs. of  14 variables:\n $ brozek   : num  12.6 6.9 24.6 10.9 27.8 20.6 19 12.8 5.1 12 ...\n $ idade    : int  23 22 22 26 24 24 26 25 25 23 ...\n $ peso     : num  154 173 154 185 184 ...\n $ altura   : num  67.8 72.2 66.2 72.2 71.2 ...\n $ pescoco  : num  36.2 38.5 34 37.4 34.4 39 36.4 37.8 38.1 42.1 ...\n $ torax    : num  93.1 93.6 95.8 101.8 97.3 ...\n $ abdom    : num  85.2 83 87.9 86.4 100 94.4 90.7 88.5 82.5 88.6 ...\n $ quadril  : num  94.5 98.7 99.2 101.2 101.9 ...\n $ coxa     : num  59 58.7 59.6 60.1 63.2 66 58.4 60 62.9 63.1 ...\n $ joelho   : num  37.3 37.3 38.9 37.3 42.2 42 38.3 39.4 38.3 41.7 ...\n $ tornozelo: num  21.9 23.4 24 22.8 24 25.6 22.9 23.2 23.8 25 ...\n $ biceps   : num  32 30.5 28.8 32.4 32.2 35.7 31.9 30.5 35.9 35.6 ...\n $ antebraco: num  27.4 28.9 25.2 29.4 27.7 30.6 27.8 29 31.1 30 ...\n $ pulso    : num  17.1 18.2 16.6 18.2 17.7 18.8 17.7 18.8 18.2 19.2 ...\n\nsummary(conj_teste)\n\n     brozek          idade            peso           altura     \n Min.   : 7.10   Min.   :24.00   Min.   :133.5   Min.   :65.00  \n 1st Qu.:13.15   1st Qu.:36.50   1st Qu.:158.6   1st Qu.:67.94  \n Median :19.05   Median :42.50   Median :167.8   Median :69.75  \n Mean   :19.60   Mean   :45.71   Mean   :177.3   Mean   :70.05  \n 3rd Qu.:24.10   3rd Qu.:54.75   3rd Qu.:198.8   3rd Qu.:71.81  \n Max.   :38.20   Max.   :72.00   Max.   :247.2   Max.   :76.00  \n    pescoco          torax            abdom           quadril      \n Min.   :33.60   Min.   : 88.20   Min.   : 73.70   Min.   : 88.50  \n 1st Qu.:36.30   1st Qu.: 93.83   1st Qu.: 86.08   1st Qu.: 95.03  \n Median :38.30   Median : 98.00   Median : 92.15   Median : 98.15  \n Mean   :38.01   Mean   :101.00   Mean   : 92.84   Mean   : 99.72  \n 3rd Qu.:38.95   3rd Qu.:106.72   3rd Qu.: 98.95   3rd Qu.:103.72  \n Max.   :42.10   Max.   :118.50   Max.   :115.60   Max.   :116.10  \n      coxa           joelho        tornozelo         biceps     \n Min.   :50.30   Min.   :34.50   Min.   :20.40   Min.   :27.90  \n 1st Qu.:56.23   1st Qu.:37.55   1st Qu.:22.20   1st Qu.:29.98  \n Median :57.35   Median :38.75   Median :22.70   Median :31.05  \n Mean   :59.06   Mean   :38.85   Mean   :23.09   Mean   :31.76  \n 3rd Qu.:62.20   3rd Qu.:39.73   3rd Qu.:23.80   3rd Qu.:32.27  \n Max.   :71.20   Max.   :45.00   Max.   :26.30   Max.   :38.50  \n   antebraco         pulso      \n Min.   :25.20   Min.   :16.90  \n 1st Qu.:27.27   1st Qu.:17.70  \n Median :28.60   Median :18.45  \n Mean   :28.68   Mean   :18.32  \n 3rd Qu.:30.07   3rd Qu.:18.85  \n Max.   :32.80   Max.   :19.90  \n\nstr(conj_teste)\n\n'data.frame':   28 obs. of  14 variables:\n $ brozek   : num  20.5 19 15.3 13.4 31.1 38.2 11.2 7.1 21.1 23.7 ...\n $ idade    : int  35 28 28 27 41 49 40 49 54 62 ...\n $ peso     : num  163 179 200 168 247 ...\n $ altura   : num  66 68 69.8 71.2 73.5 ...\n $ pescoco  : num  36.4 39.1 41.3 38.1 42.1 38.4 33.6 35.1 35.6 35.5 ...\n $ torax    : num  99.1 103.3 111.4 93 117 ...\n $ abdom    : num  92.8 95.9 98.8 79.1 115.6 ...\n $ quadril  : num  99.2 104.9 104.8 94.5 116.1 ...\n $ coxa     : num  63.1 63.5 63.4 57.3 71.2 61.9 53.3 52.6 55 56.6 ...\n $ joelho   : num  38.7 38 40.6 36.2 43.3 38.3 34.5 37.6 36.1 38.6 ...\n $ tornozelo: num  21.7 22.1 24.6 24.5 26.3 21.9 22.5 22.6 21.7 22.4 ...\n $ biceps   : num  31.1 32.5 33 29 37.3 32 27.9 38.5 29.6 31.5 ...\n $ antebraco: num  26.4 30.3 32.8 30 31.7 29.8 26.2 27.4 27.4 27.3 ...\n $ pulso    : num  16.9 18.4 19.9 18.8 19.7 17 17.3 18.5 17.4 18.6 ...\n\nhead(conj_treino)\n\n  brozek idade   peso altura pescoco torax abdom quadril coxa joelho tornozelo\n1   12.6    23 154.25  67.75    36.2  93.1  85.2    94.5 59.0   37.3      21.9\n2    6.9    22 173.25  72.25    38.5  93.6  83.0    98.7 58.7   37.3      23.4\n3   24.6    22 154.00  66.25    34.0  95.8  87.9    99.2 59.6   38.9      24.0\n4   10.9    26 184.75  72.25    37.4 101.8  86.4   101.2 60.1   37.3      22.8\n5   27.8    24 184.25  71.25    34.4  97.3 100.0   101.9 63.2   42.2      24.0\n6   20.6    24 210.25  74.75    39.0 104.5  94.4   107.8 66.0   42.0      25.6\n  biceps antebraco pulso\n1   32.0      27.4  17.1\n2   30.5      28.9  18.2\n3   28.8      25.2  16.6\n4   32.4      29.4  18.2\n5   32.2      27.7  17.7\n6   35.7      30.6  18.8"
  },
  {
    "objectID": "semanas/Aula05A.html#métodos-de-regularização",
    "href": "semanas/Aula05A.html#métodos-de-regularização",
    "title": "Regularização de Modelos",
    "section": "Métodos de Regularização",
    "text": "Métodos de Regularização\nO pacote glmnet não usa a linguagem de formula, em particular nós devemos passar \\(x\\) como uma matriz e \\(y\\) como um vetor, pois não se usa a sintaxe \\(y \\sim x\\). Com isso será necessário ajustar x e y. A função model.matrix() é particularmente útil para criar x; não só produz uma matriz correspondente as variáveis explicativas, mas também transforma automaticamente quaisquer variáveis qualitativas em variáveis dummy. Esta última propriedade é importante porque o glmnet() só pode tomar insumos numéricos e quantitativos.\n\nx_treino <- model.matrix(brozek ~ . , data = conj_treino)[, -1]\ny_treino <- conj_treino$brozek\n\nx_teste <- model.matrix(brozek ~ . , data = conj_teste)[, -1]\ny_teste = conj_teste$brozek"
  },
  {
    "objectID": "semanas/Aula05A.html#regressão-ridge",
    "href": "semanas/Aula05A.html#regressão-ridge",
    "title": "Regularização de Modelos",
    "section": "Regressão Ridge",
    "text": "Regressão Ridge\nPrimeiro vamos ajustar um modelo de regressão Ridge. Isso é conseguido chamando glmnet() com alpha=0, se alpha=1 então glmnet() ajusta um lasso.(veja o arquivo de ajuda).\n\n## Estabelecendo um grid de valores para lambda\ngrid <- 10^seq(-2, 10, length = 100)\najusreg.ridge <- glmnet(x_treino, y_treino, alpha=0, lambda = grid)\n\nPor padrão, a função glmnet() executa a regressão ridge automaticamente selecionando a faixa de valores de \\(\\lambda\\). No entanto, aqui nós escolhemos implementar usando uma grade de valores que variam de \\(\\lambda = 10^{-2}\\) a \\(\\lambda = 10^{10}\\), cobrindo toda a gama de cenários do modelo nulo contendo apenas o coeficiente linear até o ajuste dos mínimos quadrados.\nTambém podemos calcular o modelo para um valor particular de \\(\\lambda\\) que não é um dos valores de grade. Observe que, por padrão, a função glmnet() padroniza as variáveis para que elas estejam na mesma escala. Esta padronização é muito importante no caso da regressão Ridge, pois ela é afetada pela mudança de escala das variáveis explicativas.\nAssociado a cada valor de \\(\\lambda\\) existe um vetor de coeficientes de regressão de ridge, que é armazenado em uma matriz que pode ser acessada por ‘coef()’. Neste caso, é uma matriz \\(14 \\times 100\\), com 14 linhas (uma para cada preditor, mais uma para o coeficiente linear) e 100 colunas (uma para cada valor de \\(\\lambda\\)).\n\ndim(coef(ajusreg.ridge))\n\n[1]  14 100\n\nplot(ajusreg.ridge, xvar=\"lambda\", label=TRUE) # Representando os coeficientes\n\n\n\n\nQuando \\(\\lambda\\) é grande o esperado é que os coeficentes sejam pequenos e quando \\(\\lambda\\) é pequeno os coeficientes assumem valores maiores.\n\najusreg.ridge$lambda[1] # Mostra primeiro valor de lambda\n\n[1] 1e+10\n\ncoef(ajusreg.ridge)[,1] # Mostra os coeficientes associados com o primeiro valor\n\n  (Intercept)         idade          peso        altura       pescoco \n 1.885536e+01  1.338553e-10  1.236410e-10 -1.600035e-10  1.169395e-09 \n        torax         abdom       quadril          coxa        joelho \n 4.956103e-10  4.493519e-10  5.088269e-10  6.527140e-10  1.261101e-09 \n    tornozelo        biceps     antebraco         pulso \n 9.163067e-10  1.030597e-09  1.086599e-09  2.221473e-09 \n\najusreg.ridge$lambda[100] # Mostra centésimo valor de lambda\n\n[1] 0.01\n\ncoef(ajusreg.ridge)[,100] # Mostra os coeficientes associados com o centésimo valor\n\n  (Intercept)         idade          peso        altura       pescoco \n-12.665025839   0.046501055  -0.076440683  -0.071739239  -0.508989778 \n        torax         abdom       quadril          coxa        joelho \n -0.004699019   0.880707557  -0.249676597   0.270555234   0.041556722 \n    tornozelo        biceps     antebraco         pulso \n  0.131190982   0.205106982   0.421414914  -1.536327001 \n\n\n\nlibrary(plotmo)\n\nCarregando pacotes exigidos: Formula\n\n\nCarregando pacotes exigidos: plotrix\n\n\nCarregando pacotes exigidos: TeachingDemos\n\nplot_glmnet(ajusreg.ridge)"
  },
  {
    "objectID": "semanas/Aula05A.html#cross-validation-no-ridge",
    "href": "semanas/Aula05A.html#cross-validation-no-ridge",
    "title": "Regularização de Modelos",
    "section": "Cross-Validation no Ridge",
    "text": "Cross-Validation no Ridge\nNós podemos usar o k-fold cross validation para identificar o melhor valor de \\(\\lambda\\)\nA biblioteca glmnet já tem internamente uma função para uso do crosss validation. O default são 10 envelopes de dados nfold=10.\n\nset.seed(21)\nridge_cv <- cv.glmnet(x_treino,y_treino, alpha=0) ## por padrão k=10\nplot(ridge_cv)\n\n\n\nm_lamb <- ridge_cv$lambda.min  # Seleciona o lambda que minimiza o MSE (EQM) de treino\nm_lamb\n\n[1] 0.6249388\n\nlog(m_lamb)\n\n[1] -0.4701016\n\ncoef(ridge_cv, s=m_lamb)\n\n14 x 1 sparse Matrix of class \"dgCMatrix\"\n                      s1\n(Intercept) -8.319874051\nidade        0.091812033\npeso        -0.007728679\naltura      -0.160691835\npescoco     -0.363896737\ntorax        0.125326493\nabdom        0.499795486\nquadril     -0.043728201\ncoxa         0.205412068\njoelho      -0.022764635\ntornozelo   -0.013758365\nbiceps       0.126449185\nantebraco    0.320053910\npulso       -1.604822469"
  },
  {
    "objectID": "semanas/Aula05A.html#avaliando-com-conjunto-de-teste",
    "href": "semanas/Aula05A.html#avaliando-com-conjunto-de-teste",
    "title": "Regularização de Modelos",
    "section": "Avaliando com conjunto de teste",
    "text": "Avaliando com conjunto de teste\nEm seguida avaliamos seu MSE no conjunto de teste, usando \\(\\lambda\\) = m_lamb. Observe o uso da função ‘predict()’: desta vez temos previsões para um conjunto de teste, com o argumento newx.\n\najusreg.ridge2 <- glmnet(x_treino, y_treino, alpha=0, lambda = m_lamb)\ny_prev <- predict(ajusreg.ridge2, s = m_lamb, newx = x_teste)\n# Metricas de desempenho\nsqrt(mean((y_prev - y_teste)^2))\n\n[1] 4.299097"
  },
  {
    "objectID": "semanas/Aula05A.html#lasso",
    "href": "semanas/Aula05A.html#lasso",
    "title": "Regularização de Modelos",
    "section": "LASSO",
    "text": "LASSO\nPrimeiro ajustamos com todos os dados como no caso do Ridge\n\najusreg.lasso <- glmnet(x_treino,y_treino, alpha = 1)\nplot(ajusreg.lasso, xvar=\"lambda\", label=TRUE) # Representando os coeficientes\n\n\n\nplot_glmnet(ajusreg.lasso)"
  },
  {
    "objectID": "semanas/Aula05A.html#validação-cruzada-no-lasso",
    "href": "semanas/Aula05A.html#validação-cruzada-no-lasso",
    "title": "Regularização de Modelos",
    "section": "Validação Cruzada no LASSO",
    "text": "Validação Cruzada no LASSO\n\nlasso_cv <- cv.glmnet(x_treino,y_treino, alpha = 1)\nplot(lasso_cv)\n\n\n\nm_lamb1 <- lasso_cv$lambda.min  # Seleciona o lambda que minimiza o MSE de treino\nm_lamb1\n\n[1] 0.02143833\n\nlog(m_lamb1)\n\n[1] -3.842575\n\ncoef(lasso_cv, s=m_lamb1)\n\n14 x 1 sparse Matrix of class \"dgCMatrix\"\n                      s1\n(Intercept) -10.75177926\nidade         0.04473875\npeso         -0.06573034\naltura       -0.07857314\npescoco      -0.49517762\ntorax         .         \nabdom         0.85968374\nquadril      -0.22418970\ncoxa          0.23815551\njoelho        .         \ntornozelo     0.09359249\nbiceps        0.17940630\nantebraco     0.40651180\npulso        -1.49340953"
  },
  {
    "objectID": "semanas/Aula05A.html#avaliando-com-conjunto-de-teste-1",
    "href": "semanas/Aula05A.html#avaliando-com-conjunto-de-teste-1",
    "title": "Regularização de Modelos",
    "section": "Avaliando com conjunto de teste",
    "text": "Avaliando com conjunto de teste\n\najusreg.lasso2 <- glmnet(x_treino, y_treino, alpha=1, lambda = m_lamb1)\ny_prev <- predict(ajusreg.lasso2, s = m_lamb1, newx = x_teste)\n# Metricas de desempenho\nsqrt(mean((y_prev - y_teste)^2))\n\n[1] 4.300859"
  },
  {
    "objectID": "semanas/Aula05A.html#comparando-com-a-seleção-de-modelos-usando-o-bic",
    "href": "semanas/Aula05A.html#comparando-com-a-seleção-de-modelos-usando-o-bic",
    "title": "Regularização de Modelos",
    "section": "Comparando com a seleção de modelos usando o BIC",
    "text": "Comparando com a seleção de modelos usando o BIC\n\nlibrary(leaps)\n## Best Subset \nmod1.bs <- regsubsets(brozek ~ . , data = conj_treino, nvmax = 14)\nsum.mod1bs <- summary(mod1.bs)\nsum.mod1bs\n\nSubset selection object\nCall: regsubsets.formula(brozek ~ ., data = conj_treino, nvmax = 14)\n13 Variables  (and intercept)\n          Forced in Forced out\nidade         FALSE      FALSE\npeso          FALSE      FALSE\naltura        FALSE      FALSE\npescoco       FALSE      FALSE\ntorax         FALSE      FALSE\nabdom         FALSE      FALSE\nquadril       FALSE      FALSE\ncoxa          FALSE      FALSE\njoelho        FALSE      FALSE\ntornozelo     FALSE      FALSE\nbiceps        FALSE      FALSE\nantebraco     FALSE      FALSE\npulso         FALSE      FALSE\n1 subsets of each size up to 13\nSelection Algorithm: exhaustive\n          idade peso altura pescoco torax abdom quadril coxa joelho tornozelo\n1  ( 1 )  \" \"   \" \"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n2  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n3  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n4  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n5  ( 1 )  \" \"   \"*\"  \" \"    \" \"     \" \"   \"*\"   \" \"     \"*\"  \" \"    \" \"      \n6  ( 1 )  \" \"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \" \"     \" \"  \" \"    \" \"      \n7  ( 1 )  \" \"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n8  ( 1 )  \"*\"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n9  ( 1 )  \"*\"   \"*\"  \" \"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n10  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \" \"      \n11  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \" \"    \"*\"      \n12  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \" \"   \"*\"   \"*\"     \"*\"  \"*\"    \"*\"      \n13  ( 1 ) \"*\"   \"*\"  \"*\"    \"*\"     \"*\"   \"*\"   \"*\"     \"*\"  \"*\"    \"*\"      \n          biceps antebraco pulso\n1  ( 1 )  \" \"    \" \"       \" \"  \n2  ( 1 )  \" \"    \" \"       \" \"  \n3  ( 1 )  \" \"    \" \"       \"*\"  \n4  ( 1 )  \" \"    \"*\"       \"*\"  \n5  ( 1 )  \" \"    \"*\"       \"*\"  \n6  ( 1 )  \"*\"    \"*\"       \"*\"  \n7  ( 1 )  \" \"    \"*\"       \"*\"  \n8  ( 1 )  \" \"    \"*\"       \"*\"  \n9  ( 1 )  \"*\"    \"*\"       \"*\"  \n10  ( 1 ) \"*\"    \"*\"       \"*\"  \n11  ( 1 ) \"*\"    \"*\"       \"*\"  \n12  ( 1 ) \"*\"    \"*\"       \"*\"  \n13  ( 1 ) \"*\"    \"*\"       \"*\"  \n\nnames(sum.mod1bs)\n\n[1] \"which\"  \"rsq\"    \"rss\"    \"adjr2\"  \"cp\"     \"bic\"    \"outmat\" \"obj\"   \n\nplot(sum.mod1bs$bic,xlab=\"Numero de Variaveis\",ylab=\"BIC\")\nwhich.min(sum.mod1bs$bic)\n\n[1] 4\n\npoints(4,sum.mod1bs$bic[4],pch=20,col=\"red\")"
  },
  {
    "objectID": "semanas/Aula05A.html#ajustando-no-lm-e-vendo-o-erro-no-conjunto-de-teste",
    "href": "semanas/Aula05A.html#ajustando-no-lm-e-vendo-o-erro-no-conjunto-de-teste",
    "title": "Regularização de Modelos",
    "section": "Ajustando no lm() e vendo o erro no conjunto de teste",
    "text": "Ajustando no lm() e vendo o erro no conjunto de teste\nObservando so resultados de erro vemos que tanto a regressão Ridge como o LASSO apresentaram valores de erro maiores que o modelo definido através da melhor seleção de modelos (best subset regression). Aqui usamos o BIC como critério de deleção de variáveis.\n\nmod1a.lm <- lm(brozek ~ peso + abdom + antebraco + pulso,data=conj_treino)\nsummary(mod1a.lm)\n\n\nCall:\nlm(formula = brozek ~ peso + abdom + antebraco + pulso, data = conj_treino)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-9.7403 -2.8496 -0.1399  2.9035  8.5253 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -30.29197    7.02195  -4.314 2.43e-05 ***\npeso         -0.12440    0.02400  -5.182 4.97e-07 ***\nabdom         0.92885    0.05554  16.723  < 2e-16 ***\nantebraco     0.51813    0.17193   3.014 0.002885 ** \npulso        -1.61145    0.43290  -3.722 0.000251 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.998 on 219 degrees of freedom\nMultiple R-squared:  0.7369,    Adjusted R-squared:  0.7321 \nF-statistic: 153.4 on 4 and 219 DF,  p-value: < 2.2e-16\n\nsqrt(mean((conj_teste$brozek - predict(mod1a.lm, conj_teste)) ^ 2)) \n\n[1] 4.231517"
  },
  {
    "objectID": "semanas/Aula06.html",
    "href": "semanas/Aula06.html",
    "title": "Avaliando Series Temporais",
    "section": "",
    "text": "# parametros para imagens\nknitr::opts_chunk$set(\n  fig.width = 8,\n  fig.asp = 0.618,\n  fig.retina = 3,\n  dpi = 300,\n  out.width = \"80%\"\n)"
  },
  {
    "objectID": "semanas/Aula06.html#séries-temporais",
    "href": "semanas/Aula06.html#séries-temporais",
    "title": "Avaliando Series Temporais",
    "section": "Séries Temporais",
    "text": "Séries Temporais\nNestes exemplos vamos usar algumas bibliotecas do R que são usadas na análise de séries temporais financeiras e também na sua modelagem."
  },
  {
    "objectID": "semanas/Aula06.html#obtendo-e-visualizando-uma-st",
    "href": "semanas/Aula06.html#obtendo-e-visualizando-uma-st",
    "title": "Avaliando Series Temporais",
    "section": "Obtendo e Visualizando uma ST",
    "text": "Obtendo e Visualizando uma ST\nVamos inicialmente usando a biblioteca (pacote) quantmod fazer um download dos preços da Petrobras (PETR4) entre 2000 e 2022.\nA biblioteca quantmod depende dos pacotes xts e do zoo que são dois pacotes usados para manipular dados de series temporais.\n\nlibrary(quantmod)\n\nCarregando pacotes exigidos: xts\n\n\nCarregando pacotes exigidos: zoo\n\n\n\nAttaching package: 'zoo'\n\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n\n\nCarregando pacotes exigidos: TTR\n\n\nRegistered S3 method overwritten by 'quantmod':\n  method            from\n  as.zoo.data.frame zoo \n\ngetSymbols(\"PETR4.SA\",from=\"2000-01-01\", to=\"2022-09-30\")\n\nWarning: PETR4.SA contains missing values. Some functions will not work if\nobjects contain missing values in the middle of the series. Consider using\nna.omit(), na.approx(), na.fill(), etc to remove or replace them.\n\n\n[1] \"PETR4.SA\"\n\nhead(PETR4.SA)\n\n           PETR4.SA.Open PETR4.SA.High PETR4.SA.Low PETR4.SA.Close\n2000-01-03         5.875         5.875        5.875          5.875\n2000-01-04         5.550         5.550        5.550          5.550\n2000-01-05         5.494         5.494        5.494          5.494\n2000-01-06         5.475         5.475        5.475          5.475\n2000-01-07         5.500         5.500        5.500          5.500\n2000-01-10         5.613         5.613        5.613          5.613\n           PETR4.SA.Volume PETR4.SA.Adjusted\n2000-01-03     35389440000          2.139588\n2000-01-04     28861440000          2.021228\n2000-01-05     43033600000          2.000833\n2000-01-06     34055680000          1.993914\n2000-01-07     20912640000          2.003018\n2000-01-10     19563520000          2.044172\n\n# A biblioteca tem uma forma diferenciada de apresentação das series financeiras\nchartSeries(PETR4.SA,theme=\"white\")\n\n\n\n\nVeja que os dados recebidos tem valores de abertura (open), alta (high), baixa (low) e fechamento (close)\n\nsummary(PETR4.SA)\n\n     Index            PETR4.SA.Open   PETR4.SA.High    PETR4.SA.Low   \n Min.   :2000-01-03   Min.   : 4.20   Min.   : 4.27   Min.   : 4.120  \n 1st Qu.:2005-07-04   1st Qu.:10.15   1st Qu.:10.35   1st Qu.: 9.969  \n Median :2011-03-28   Median :19.09   Median :19.39   Median :18.765  \n Mean   :2011-04-09   Mean   :18.92   Mean   :19.20   Mean   :18.617  \n 3rd Qu.:2017-01-03   3rd Qu.:26.05   3rd Qu.:26.43   3rd Qu.:25.650  \n Max.   :2022-09-29   Max.   :67.50   Max.   :67.50   Max.   :51.950  \n                      NA's   :1       NA's   :1       NA's   :1       \n PETR4.SA.Close  PETR4.SA.Volume     PETR4.SA.Adjusted\n Min.   : 4.20   Min.   :0.000e+00   Min.   : 1.593   \n 1st Qu.:10.11   1st Qu.:2.113e+07   1st Qu.: 4.263   \n Median :19.10   Median :3.374e+07   Median : 8.625   \n Mean   :18.89   Mean   :5.644e+08   Mean   : 8.904   \n 3rd Qu.:26.00   3rd Qu.:5.434e+07   3rd Qu.:12.128   \n Max.   :52.51   Max.   :7.356e+10   Max.   :34.480   \n NA's   :1       NA's   :1           NA's   :1"
  },
  {
    "objectID": "semanas/Aula06.html#vamos-selecionar-somente-o-fechamento-close",
    "href": "semanas/Aula06.html#vamos-selecionar-somente-o-fechamento-close",
    "title": "Avaliando Series Temporais",
    "section": "Vamos selecionar somente o fechamento (close)",
    "text": "Vamos selecionar somente o fechamento (close)\nPara trabalhar com somente uma das series vamos selecionar sua coluna de dados\n\nPETR4.SA.Close <- PETR4.SA[,\"PETR4.SA.Close\"]\nchartSeries(PETR4.SA.Close,theme=\"white\")"
  },
  {
    "objectID": "semanas/Aula06.html#podemos-extrair-somente-um-ano",
    "href": "semanas/Aula06.html#podemos-extrair-somente-um-ano",
    "title": "Avaliando Series Temporais",
    "section": "Podemos extrair somente um ano?",
    "text": "Podemos extrair somente um ano?\nVamos usar os dados de 2000.\n\nPETR4_2000 <- PETR4.SA.Close[\"2000\"]\nchartSeries(PETR4_2000,theme=\"white\")"
  },
  {
    "objectID": "semanas/Aula06.html#podemos-extrair-um-intervalo",
    "href": "semanas/Aula06.html#podemos-extrair-um-intervalo",
    "title": "Avaliando Series Temporais",
    "section": "Podemos extrair um intervalo?",
    "text": "Podemos extrair um intervalo?\nVamos usar os dados de 2000 a 2001.\n\nPETR4_2000_2001 <- PETR4.SA.Close[\"2000/2001\"] \nchartSeries(PETR4_2000_2001,theme=\"white\")"
  },
  {
    "objectID": "semanas/Aula06.html#vamos-trabalhar-com-outro-intervalo",
    "href": "semanas/Aula06.html#vamos-trabalhar-com-outro-intervalo",
    "title": "Avaliando Series Temporais",
    "section": "Vamos trabalhar com outro intervalo",
    "text": "Vamos trabalhar com outro intervalo\nVamos usar dados de set/21 a set/22.\n\nPETR4.SA.Close <- PETR4.SA.Close[\"2021-09-01/2022-09-30\"]\nchartSeries(PETR4.SA.Close,theme=\"white\")"
  },
  {
    "objectID": "semanas/Aula06.html#visualizando-o-início-e-o-fim-da-serie",
    "href": "semanas/Aula06.html#visualizando-o-início-e-o-fim-da-serie",
    "title": "Avaliando Series Temporais",
    "section": "Visualizando o início e o fim da serie",
    "text": "Visualizando o início e o fim da serie\nAqui vamos usar funções da xts visualizar diferentes periodos.\n\nfirst(PETR4.SA.Close, \"month\")\n\n           PETR4.SA.Close\n2021-09-01          27.04\n2021-09-02          26.60\n2021-09-03          26.33\n2021-09-06          26.46\n2021-09-08          24.97\n2021-09-09          25.50\n2021-09-10          25.34\n2021-09-13          26.23\n2021-09-14          25.88\n2021-09-15          26.33\n2021-09-16          26.10\n2021-09-17          24.93\n2021-09-20          24.65\n2021-09-21          25.21\n2021-09-22          25.85\n2021-09-23          26.84\n2021-09-24          26.90\n2021-09-27          27.14\n2021-09-28          26.96\n2021-09-29          27.39\n2021-09-30          27.23\n\nlast(PETR4.SA.Close, \"6 weeks\")\n\n           PETR4.SA.Close\n2022-08-22          32.41\n2022-08-23          33.44\n2022-08-24          33.64\n2022-08-25          33.28\n2022-08-26          33.64\n2022-08-29          34.48\n2022-08-30          32.43\n2022-08-31          33.23\n2022-09-01          33.85\n2022-09-02          33.42\n2022-09-05          33.34\n2022-09-06          32.10\n2022-09-08          31.80\n2022-09-09          31.79\n2022-09-12          31.48\n2022-09-13          30.65\n2022-09-14          31.12\n2022-09-15          31.06\n2022-09-16          30.78\n2022-09-19          31.27\n2022-09-20          31.09\n2022-09-21          31.17\n2022-09-22          31.94\n2022-09-23          29.94\n2022-09-26          29.29\n2022-09-27          29.67\n2022-09-28          29.27\n2022-09-29          29.31"
  },
  {
    "objectID": "semanas/Aula06.html#usando-o-pacote-astsa",
    "href": "semanas/Aula06.html#usando-o-pacote-astsa",
    "title": "Avaliando Series Temporais",
    "section": "Usando o pacote astsa",
    "text": "Usando o pacote astsa\nVamos usar algumas funcionalidades do pacote astsa que permite visualizações e modelagem de series temporais.\n\nlibrary(astsa)\nlag1.plot(PETR4.SA.Close,12, col=astsa.col(4, .3), pch=20, cex=2)"
  },
  {
    "objectID": "semanas/Aula06.html#esta-série-é-um-ruído-branco",
    "href": "semanas/Aula06.html#esta-série-é-um-ruído-branco",
    "title": "Avaliando Series Temporais",
    "section": "Esta série é um ruído branco?",
    "text": "Esta série é um ruído branco?\nPrimeiro vamos ver graficamente o FAC/ACF e a FACP/PACF e depois vamos usar o teste de Box-Pierce e Ljung-Box.\n\nacf2(PETR4.SA.Close)\n\n\n\n\n     [,1]  [,2] [,3] [,4]  [,5]  [,6] [,7]  [,8]  [,9] [,10] [,11] [,12] [,13]\nACF  0.95  0.90 0.86 0.82  0.78  0.73 0.69  0.65  0.60  0.56  0.52  0.49  0.45\nPACF 0.95 -0.01 0.05 0.00 -0.02 -0.03 0.00 -0.06 -0.08  0.01  0.05 -0.04  0.00\n     [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]\nACF   0.41  0.39  0.37  0.35  0.33  0.31  0.30  0.29  0.27  0.25  0.24  0.22\nPACF -0.03  0.08  0.05  0.02 -0.04  0.03  0.07 -0.03 -0.09 -0.04  0.05 -0.07\n     [,26] [,27]\nACF   0.21  0.20\nPACF  0.11 -0.05\n\nBox.test(PETR4.SA.Close, lag=20, type = \"Box-Pierce\")\n\n\n    Box-Pierce test\n\ndata:  PETR4.SA.Close\nX-squared = 2004.7, df = 20, p-value < 2.2e-16\n\nBox.test(PETR4.SA.Close, lag=20, type = \"Ljung-Box\")\n\n\n    Box-Ljung test\n\ndata:  PETR4.SA.Close\nX-squared = 2071.8, df = 20, p-value < 2.2e-16"
  },
  {
    "objectID": "semanas/Aula06.html#vamos-agora-trabalhar-com-os-log-retornos-das-ações",
    "href": "semanas/Aula06.html#vamos-agora-trabalhar-com-os-log-retornos-das-ações",
    "title": "Avaliando Series Temporais",
    "section": "Vamos agora trabalhar com os log retornos das ações",
    "text": "Vamos agora trabalhar com os log retornos das ações\nPara obter os log retornos vamos usar uma função da biblioteca qrmtools.\n\nlibrary(qrmtools)\npetr4.logret <- returns(PETR4.SA.Close, method=\"logarithmic\")\nhead(petr4.logret)\n\n                   [,1]\n2021-09-02 -0.016406072\n2021-09-03 -0.010202242\n2021-09-06  0.004925147\n2021-09-08 -0.057959057\n2021-09-09  0.021003388\n2021-09-10 -0.006294277\n\nchartSeries(petr4.logret,theme=\"white\")"
  },
  {
    "objectID": "semanas/Aula06.html#esta-série-é-um-ruído-branco-1",
    "href": "semanas/Aula06.html#esta-série-é-um-ruído-branco-1",
    "title": "Avaliando Series Temporais",
    "section": "Esta série é um ruído branco?",
    "text": "Esta série é um ruído branco?\nVamos usar o teste de Box-Pierce e Ljung-Box\n\nacf2(petr4.logret)\n\n\n\n\n      [,1]  [,2]  [,3]  [,4] [,5]  [,6] [,7] [,8]  [,9] [,10] [,11] [,12] [,13]\nACF  -0.03 -0.07 -0.02 -0.01 0.03 -0.04 0.04 0.07 -0.03 -0.08 -0.01 -0.03  0.02\nPACF -0.03 -0.08 -0.03 -0.02 0.02 -0.04 0.04 0.07 -0.02 -0.07 -0.01 -0.04  0.01\n     [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]\nACF  -0.08 -0.06 -0.01  0.03 -0.05 -0.07  0.02  0.09  0.04 -0.07  0.05 -0.13\nPACF -0.09 -0.07 -0.03  0.02 -0.05 -0.07  0.00  0.08  0.05 -0.05  0.04 -0.15\n     [,26] [,27]\nACF   0.03 -0.10\nPACF  0.03 -0.12\n\nBox.test(petr4.logret, lag=20, type = \"Box-Pierce\")\n\n\n    Box-Pierce test\n\ndata:  petr4.logret\nX-squared = 11.561, df = 20, p-value = 0.9304\n\nBox.test(petr4.logret, lag=20, type = \"Ljung-Box\")\n\n\n    Box-Ljung test\n\ndata:  petr4.logret\nX-squared = 12.146, df = 20, p-value = 0.9109"
  },
  {
    "objectID": "semanas/Aula06.html#vamos-avaliar-de-outra-forma",
    "href": "semanas/Aula06.html#vamos-avaliar-de-outra-forma",
    "title": "Avaliando Series Temporais",
    "section": "Vamos avaliar de outra forma",
    "text": "Vamos avaliar de outra forma\nNo teste anterior usamos somente o lag = 20 para testar a série. Vamos usar a biblioteca astsa que faz este teste para vários lags além de avaliar outras características da série.\n\nsarima(petr4.logret,p=0,d=0,q=0)\n\ninitial  value -3.635431 \niter   1 value -3.635431\nfinal  value -3.635431 \nconverged\ninitial  value -3.635431 \niter   1 value -3.635431\nfinal  value -3.635431 \nconverged\n\n\n\n\n\n$fit\n\nCall:\narima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), \n    xreg = xmean, include.mean = FALSE, transform.pars = trans, fixed = fixed, \n    optim.control = list(trace = trc, REPORT = 1, reltol = tol))\n\nCoefficients:\n       xmean\n      0.0003\ns.e.  0.0016\n\nsigma^2 estimated as 0.0006955:  log likelihood = 596.24,  aic = -1188.47\n\n$degrees_of_freedom\n[1] 268\n\n$ttable\n      Estimate     SE t.value p.value\nxmean    3e-04 0.0016  0.1862  0.8524\n\n$AIC\n[1] -4.418115\n\n$AICc\n[1] -4.418059\n\n$BIC\n[1] -4.391389"
  },
  {
    "objectID": "semanas/Aula06.html#podemos-agragar-valores-diários-de-diversas-formas",
    "href": "semanas/Aula06.html#podemos-agragar-valores-diários-de-diversas-formas",
    "title": "Avaliando Series Temporais",
    "section": "Podemos agragar valores diários de diversas formas",
    "text": "Podemos agragar valores diários de diversas formas\nPara agregar valores de series temporais vamos usar a biblioteca xts\n\nlibrary(xts)\npetr4.logret.sem <- apply.weekly(petr4.logret, sum)\nfirst(petr4.logret.sem, \"2 week\")\n\n                  [,1]\n2021-09-03 -0.02660831\n2021-09-10 -0.03832480\n\npetr4.logret.men <- apply.monthly(petr4.logret, sum)\nfirst(petr4.logret.men, \"2 month\")\n\n                   [,1]\n2021-09-30  0.007002019\n2021-10-29 -0.002942260"
  },
  {
    "objectID": "semanas/Aula06.html#os-log-retornos-seguem-uma-distribuição-normal",
    "href": "semanas/Aula06.html#os-log-retornos-seguem-uma-distribuição-normal",
    "title": "Avaliando Series Temporais",
    "section": "Os log retornos seguem uma distribuição normal?",
    "text": "Os log retornos seguem uma distribuição normal?\nVamos usar alguma ferrametas gráficas para avaliar os dados de log-retorno\n\nmu <- mean(petr4.logret)\nsigma <- sd(petr4.logret)\nc(mu, sigma)\n\n[1] 0.0002996708 0.0264217221\n\nx <- sort(coredata(petr4.logret))\nhist(x, breaks = \"Sturges\" , probability = TRUE)\nlines(x, dnorm(x, mean = mu, sd = sigma), col = \"red\")\n\n\n\nqqnorm(x)\nqqline(x)"
  },
  {
    "objectID": "semanas/Aula06.html#outra-avaliação-jarque-bera",
    "href": "semanas/Aula06.html#outra-avaliação-jarque-bera",
    "title": "Avaliando Series Temporais",
    "section": "Outra avaliação Jarque-Bera",
    "text": "Outra avaliação Jarque-Bera\n\nlibrary(moments)\nx <- sort(coredata(petr4.logret))\njarque.test(x)\n\n\n    Jarque-Bera Normality Test\n\ndata:  x\nJB = 367.04, p-value < 2.2e-16\nalternative hypothesis: greater"
  },
  {
    "objectID": "semanas/Aula06.html#e-o-log-retorno-semanal",
    "href": "semanas/Aula06.html#e-o-log-retorno-semanal",
    "title": "Avaliando Series Temporais",
    "section": "E o log retorno semanal?",
    "text": "E o log retorno semanal?\nVamos usar alguma ferrametas gráficas para avaliar os dados de log-retorno\n\nmu <- mean(petr4.logret.sem)\nsigma <- sd(petr4.logret.sem)\nc(mu, sigma)\n\n[1] 0.001414236 0.052515186\n\nx <- sort(coredata(petr4.logret.sem))\nhist(x, breaks = \"Sturges\" , probability = TRUE)\nlines(x, dnorm(x, mean = mu, sd = sigma), col = \"red\")\n\n\n\nqqnorm(x)\nqqline(x)"
  },
  {
    "objectID": "semanas/Aula06.html#outra-avaliação-jarque-bera-1",
    "href": "semanas/Aula06.html#outra-avaliação-jarque-bera-1",
    "title": "Avaliando Series Temporais",
    "section": "Outra avaliação Jarque-Bera",
    "text": "Outra avaliação Jarque-Bera\n\nlibrary(moments)\nx <- sort(coredata(petr4.logret.sem))\njarque.test(x)\n\n\n    Jarque-Bera Normality Test\n\ndata:  x\nJB = 1.0108, p-value = 0.6033\nalternative hypothesis: greater"
  },
  {
    "objectID": "semanas/Aula06.html#vamos-simular-um-processo-ar1",
    "href": "semanas/Aula06.html#vamos-simular-um-processo-ar1",
    "title": "Avaliando Series Temporais",
    "section": "Vamos simular um processo AR(1)",
    "text": "Vamos simular um processo AR(1)\nVamos usar as funções da biblioteca astsa.\n\npar(mfrow=c(2,1))                         \n# na expressão abaixo ~ é igual a um espaço e == é o igual\ntsplot(sarima.sim(ar= .9, n=100), col=4, ylab=\"\", main=(expression(AR(1)~~~phi==+.9))) \ntsplot(sarima.sim(ar=-.9, n=100), col=4, ylab=\"\", main=(expression(AR(1)~~~phi==-.9)))"
  },
  {
    "objectID": "semanas/Aula06.html#vamos-simular-um-processo-ma1",
    "href": "semanas/Aula06.html#vamos-simular-um-processo-ma1",
    "title": "Avaliando Series Temporais",
    "section": "Vamos simular um processo MA(1)",
    "text": "Vamos simular um processo MA(1)\nVamos usar as funções da biblioteca astsa.\n\npar(mfrow=c(2,1))                                   \ntsplot(sarima.sim(ma= .9, n=100), col=4, ylab=\"\", main=(expression(MA(1)~~~theta==+.9)))    \ntsplot(sarima.sim(ma=-.9, n=100), col=4, ylab=\"\", main=(expression(MA(1)~~~theta==-.9)))"
  },
  {
    "objectID": "semanas/Aula06.html#vamos-simular-um-ar2",
    "href": "semanas/Aula06.html#vamos-simular-um-ar2",
    "title": "Avaliando Series Temporais",
    "section": "Vamos simular um AR(2)",
    "text": "Vamos simular um AR(2)\nVamos usar outra função básica do R para simular um AR(2) para fazer a representação gráfica de um AR(2) através dos seus ACF e PACF.\n\nacf <- ARMAacf(ar=c(1.5,-.75), ma=0, 24)\npacf <- ARMAacf(ar=c(1.5,-.75), ma=0, 24, pacf=T)\npar(mfrow=c(1,2))\nplot(acf, type=\"h\", xlab=\"lag\")\nabline(h=0)\nplot(pacf, type=\"h\", xlab=\"lag\")\nabline(h=0)"
  },
  {
    "objectID": "semanas/Aula06.html#vamos-analisar-dados-de-recrutamento",
    "href": "semanas/Aula06.html#vamos-analisar-dados-de-recrutamento",
    "title": "Avaliando Series Temporais",
    "section": "Vamos analisar dados de Recrutamento",
    "text": "Vamos analisar dados de Recrutamento\nRecrutamento (índice do número de novos peixes) por um período de 453 meses que se passaram ao longo dos anos 1950-1987. O recrutamento é vagamente definido como um indicador de novos membros de uma população para a primeira fase de vida em que a mortalidade natural se estabiliza perto dos níveis adultos.\nEstes dados estão na biblioteca astsa.\nVamos usar uma parte para ajustar o modelo e depois vamos ver como ficam as previsões com relação aos resultados reais.\n\n# library(astsa)\ndata(rec)\nrecr <- window(rec, start=c(1950,1), end=c(1985,9))\npar(mfrow=c(2,1))\nacf(recr, 24)\npacf(recr, 24)\n\n\n\nacf2(recr)\n\n\n\n\n     [,1]  [,2]  [,3]  [,4] [,5]  [,6]  [,7] [,8] [,9] [,10] [,11] [,12] [,13]\nACF  0.92  0.79  0.64  0.49 0.37  0.27  0.19 0.13 0.09  0.06  0.04  0.00 -0.07\nPACF 0.92 -0.45 -0.04 -0.02 0.08 -0.05 -0.05 0.04 0.05 -0.03 -0.06 -0.15 -0.15\n     [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]\nACF  -0.14 -0.21 -0.26 -0.29 -0.28 -0.25 -0.20 -0.12 -0.04  0.02  0.05  0.04\nPACF -0.02  0.02 -0.01  0.03  0.04  0.09  0.09  0.03 -0.02 -0.04 -0.05 -0.13\n     [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37]\nACF   0.01 -0.02 -0.06 -0.09 -0.11 -0.12 -0.10 -0.06  0.01  0.07  0.09  0.08\nPACF -0.03  0.06 -0.09 -0.05 -0.02  0.06  0.03  0.13  0.08 -0.02 -0.10 -0.07\n     [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48]\nACF   0.04  0.00 -0.02 -0.03 -0.03 -0.02  0.00  0.04  0.09  0.14  0.17\nPACF  0.03  0.02  0.07 -0.04 -0.02 -0.04  0.05  0.01  0.04  0.10 -0.04"
  },
  {
    "objectID": "semanas/Aula06.html#que-tal-um-ar2",
    "href": "semanas/Aula06.html#que-tal-um-ar2",
    "title": "Avaliando Series Temporais",
    "section": "Que tal um AR(2)",
    "text": "Que tal um AR(2)\nAqui usando comandos básicos do R.\n\np <- 2\nd <- 0\nq <- 0\nmod1 <- arima(recr,order=c(p,d,q),method=\"ML\")\ntsdiag(mod1)"
  },
  {
    "objectID": "semanas/Aula06.html#previsões-a-partir-do-modelo-ajustado",
    "href": "semanas/Aula06.html#previsões-a-partir-do-modelo-ajustado",
    "title": "Avaliando Series Temporais",
    "section": "Previsões a partir do modelo ajustado",
    "text": "Previsões a partir do modelo ajustado\n\nrec.pr <- predict(mod1, n.ahead=24)\ninf <- rec.pr$pred + rec.pr$se\nsup <- rec.pr$pred - rec.pr$se\ntsplot(recr, type=\"o\", ylab=\"recrutamento\", xlim=c(1980,1988))\nlines(rec.pr$pred, col=\"red\", type=\"o\")\nlines(inf, col=\"blue\", lty=\"dashed\")\nlines(sup, col=\"blue\", lty=\"dashed\")\nlines(rec)\nabline(h=coef(mod1)[names(coef(mod1))=='intercept'])"
  },
  {
    "objectID": "semanas/Aula06.html#usando-a-biblioteca-astsa",
    "href": "semanas/Aula06.html#usando-a-biblioteca-astsa",
    "title": "Avaliando Series Temporais",
    "section": "Usando a biblioteca ASTSA",
    "text": "Usando a biblioteca ASTSA\n\np <- 2\nd <- 0\nq <- 0\nsarima(recr,p=p,d=d,q=q, gg=TRUE, col=4)\n\ninitial  value 3.335343 \niter   2 value 3.264072\niter   3 value 2.562334\niter   4 value 2.425870\niter   5 value 2.258615\niter   6 value 2.254532\niter   7 value 2.253817\niter   8 value 2.253804\niter   9 value 2.253802\niter  10 value 2.253799\niter  11 value 2.253799\niter  12 value 2.253799\niter  13 value 2.253798\niter  14 value 2.253797\niter  15 value 2.253797\niter  15 value 2.253797\nfinal  value 2.253797 \nconverged\ninitial  value 2.254327 \niter   2 value 2.254322\niter   3 value 2.254320\niter   4 value 2.254319\niter   5 value 2.254319\niter   6 value 2.254319\niter   7 value 2.254319\niter   8 value 2.254318\niter   9 value 2.254318\niter   9 value 2.254318\niter   9 value 2.254318\nfinal  value 2.254318 \nconverged\n\n\n\n\n\n$fit\n\nCall:\narima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), \n    xreg = xmean, include.mean = FALSE, transform.pars = trans, fixed = fixed, \n    optim.control = list(trace = trc, REPORT = 1, reltol = tol))\n\nCoefficients:\n         ar1      ar2    xmean\n      1.3418  -0.4516  61.9062\ns.e.  0.0429   0.0429   4.1418\n\nsigma^2 estimated as 90.29:  log likelihood = -1575.83,  aic = 3159.65\n\n$degrees_of_freedom\n[1] 426\n\n$ttable\n      Estimate     SE  t.value p.value\nar1     1.3418 0.0429  31.2549       0\nar2    -0.4516 0.0429 -10.5159       0\nxmean  61.9062 4.1418  14.9468       0\n\n$AIC\n[1] 7.365161\n\n$AICc\n[1] 7.365293\n\n$BIC\n[1] 7.40303\n\nsarima.for(recr, n.ahead=24, p=2, d=0, q=0, plot=TRUE)\n\n$pred\n          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug\n1985                                                                        \n1986 75.20659 72.25139 69.78139 67.80161 66.26051 65.08665 64.20747 63.55787\n1987 62.19281 62.10513 62.04370 62.00087 61.97114 61.95058 61.93643 61.92672\n          Sep      Oct      Nov      Dec\n1985          84.27178 81.81321 78.51797\n1986 63.08323 62.73971 62.49309 62.31731\n1987 61.92009                           \n\n$se\n           Jan       Feb       Mar       Apr       May       Jun       Jul\n1985                                                                      \n1986 23.410705 25.288870 26.425340 27.090863 27.469631 27.679844 27.793943\n1987 27.917314 27.918328 27.918821 27.919058 27.919172 27.919226 27.919251\n           Aug       Sep       Oct       Nov       Dec\n1985                      9.502359 15.901825 20.424515\n1986 27.854666 27.886424 27.902778 27.911083 27.915248\n1987 27.919263 27.919268                              \n\nlines(rec)"
  },
  {
    "objectID": "visao-do-curso.html",
    "href": "visao-do-curso.html",
    "title": "Análise Estatística II",
    "section": "",
    "text": "Ao final do período, o aluno deverá ser capaz de manusear com desembaraço a análise de dados que variem no tempo, separando-os em seus componentes de tendência e/ou sazonal/cíclica e aleatória."
  }
]